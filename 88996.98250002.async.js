(self.webpackChunknocobase_docs=self.webpackChunknocobase_docs||[]).push([[88996],{15765:function(Z,R){var u;(function(f){f(typeof DO_NOT_EXPORT_BESSEL=="undefined"?R:u={})})(function(f){f.version="1.0.2";var b=Math;function d(o,s){for(var v=0,l=0;v<o.length;++v)l=s*l+o[v];return l}function w(o,s,v,l,a){if(s===0)return v;if(s===1)return l;for(var m=2/o,t=l,c=1;c<s;++c)t=l*c*m+a*v,v=l,l=t;return t}function p(o,s,v,l,a){return function(t,c){if(l){if(t===0)return l==1?-1/0:1/0;if(t<0)return NaN}if(c===0)return o(t);if(c===1)return s(t);if(c<0)return NaN;c|=0;var g=o(t),y=s(t);return w(t,c,g,y,a)}}var i=function(){var o=.636619772,s=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),v=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),l=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),a=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function m(q){var h=0,k=0,E=0,I=q*q;if(q<8)k=d(s,I),E=d(v,I),h=k/E;else{var z=q-.785398164;I=64/I,k=d(l,I),E=d(a,I),h=b.sqrt(o/q)*(b.cos(z)*k-b.sin(z)*E*8/q)}return h}var t=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),c=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),g=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),y=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function _(q){var h=0,k=0,E=0,I=q*q,z=b.abs(q)-2.356194491;return Math.abs(q)<8?(k=q*d(t,I),E=d(c,I),h=k/E):(I=64/I,k=d(g,I),E=d(y,I),h=b.sqrt(o/b.abs(q))*(b.cos(z)*k-b.sin(z)*E*8/b.abs(q)),q<0&&(h=-h)),h}return function q(h,k){if(k=Math.round(k),!isFinite(h))return isNaN(h)?h:0;if(k<0)return(k%2?-1:1)*q(h,-k);if(h<0)return(k%2?-1:1)*q(-h,k);if(k===0)return m(h);if(k===1)return _(h);if(h===0)return 0;var E=0;if(h>k)E=w(h,k,m(h),_(h),-1);else{for(var I=2*b.floor((k+b.floor(b.sqrt(40*k)))/2),z=!1,P=0,T=0,A=1,N=0,Q=2/h,O=I;O>0;O--)N=O*Q*A-P,P=A,A=N,b.abs(A)>1e10&&(A*=1e-10,P*=1e-10,E*=1e-10,T*=1e-10),z&&(T+=A),z=!z,O==k&&(E=P);T=2*T-A,E/=T}return E}}(),r=function(){var o=.636619772,s=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),v=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),l=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),a=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function m(q){var h=0,k=0,E=0,I=q*q,z=q-.785398164;return q<8?(k=d(s,I),E=d(v,I),h=k/E+o*i(q,0)*b.log(q)):(I=64/I,k=d(l,I),E=d(a,I),h=b.sqrt(o/q)*(b.sin(z)*k+b.cos(z)*E*8/q)),h}var t=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),c=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),g=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),y=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function _(q){var h=0,k=0,E=0,I=q*q,z=q-2.356194491;return q<8?(k=q*d(t,I),E=d(c,I),h=k/E+o*(i(q,1)*b.log(q)-1/q)):(I=64/I,k=d(g,I),E=d(y,I),h=b.sqrt(o/q)*(b.sin(z)*k+b.cos(z)*E*8/q)),h}return p(m,_,"BESSELY",1,-1)}(),n=function(){var o=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),s=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function v(t){return t<=3.75?d(o,t*t/(3.75*3.75)):b.exp(b.abs(t))/b.sqrt(b.abs(t))*d(s,3.75/b.abs(t))}var l=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),a=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function m(t){return t<3.75?t*d(l,t*t/(3.75*3.75)):(t<0?-1:1)*b.exp(b.abs(t))/b.sqrt(b.abs(t))*d(a,3.75/b.abs(t))}return function t(c,g){if(g=Math.round(g),g===0)return v(c);if(g===1)return m(c);if(g<0)return NaN;if(b.abs(c)===0)return 0;if(c==1/0)return 1/0;var y=0,_,q=2/b.abs(c),h=0,k=1,E=0,I=2*b.round((g+b.round(b.sqrt(40*g)))/2);for(_=I;_>0;_--)E=_*q*k+h,h=k,k=E,b.abs(k)>1e10&&(k*=1e-10,h*=1e-10,y*=1e-10),_==g&&(y=h);return y*=t(c,0)/k,c<0&&g%2?-y:y}}(),e=function(){var o=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),s=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function v(t){return t<=2?-b.log(t/2)*n(t,0)+d(o,t*t/4):b.exp(-t)/b.sqrt(t)*d(s,2/t)}var l=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),a=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function m(t){return t<=2?b.log(t/2)*n(t,1)+1/t*d(l,t*t/4):b.exp(-t)/b.sqrt(t)*d(a,2/t)}return p(v,m,"BESSELK",2,1)}();f.besselj=i,f.bessely=r,f.besseli=n,f.besselk=e})},2162:function(Z){(function(R,u){Z.exports=u()})(this,function(){var R=function(u,f){var b=Array.prototype.concat,d=Array.prototype.slice,w=Object.prototype.toString;function p(m,t){var c=m>t?m:t;return u.pow(10,17-~~(u.log(c>0?c:-c)*u.LOG10E))}var i=Array.isArray||function(t){return w.call(t)==="[object Array]"};function r(m){return w.call(m)==="[object Function]"}function n(m){return typeof m=="number"?m-m===0:!1}function e(m){return b.apply([],m)}function o(){return new o._init(arguments)}o.fn=o.prototype,o._init=function(t){if(i(t[0]))if(i(t[0][0])){r(t[1])&&(t[0]=o.map(t[0],t[1]));for(var c=0;c<t[0].length;c++)this[c]=t[0][c];this.length=t[0].length}else this[0]=r(t[1])?o.map(t[0],t[1]):t[0],this.length=1;else if(n(t[0]))this[0]=o.seq.apply(null,t),this.length=1;else{if(t[0]instanceof o)return o(t[0].toArray());this[0]=[],this.length=1}return this},o._init.prototype=o.prototype,o._init.constructor=o,o.utils={calcRdx:p,isArray:i,isFunction:r,isNumber:n,toVector:e},o._random_fn=u.random,o.setRandom=function(t){if(typeof t!="function")throw new TypeError("fn is not a function");o._random_fn=t},o.extend=function(t){var c,g;if(arguments.length===1){for(g in t)o[g]=t[g];return this}for(c=1;c<arguments.length;c++)for(g in arguments[c])t[g]=arguments[c][g];return t},o.rows=function(t){return t.length||1},o.cols=function(t){return t[0].length||1},o.dimensions=function(t){return{rows:o.rows(t),cols:o.cols(t)}},o.row=function(t,c){return i(c)?c.map(function(g){return o.row(t,g)}):t[c]},o.rowa=function(t,c){return o.row(t,c)},o.col=function(t,c){if(i(c)){var g=o.arange(t.length).map(function(){return new Array(c.length)});return c.forEach(function(q,h){o.arange(t.length).forEach(function(k){g[k][h]=t[k][q]})}),g}for(var y=new Array(t.length),_=0;_<t.length;_++)y[_]=[t[_][c]];return y},o.cola=function(t,c){return o.col(t,c).map(function(g){return g[0]})},o.diag=function(t){for(var c=o.rows(t),g=new Array(c),y=0;y<c;y++)g[y]=[t[y][y]];return g},o.antidiag=function(t){for(var c=o.rows(t)-1,g=new Array(c),y=0;c>=0;c--,y++)g[y]=[t[y][c]];return g},o.transpose=function(t){var c=[],g,y,_,q,h;for(i(t[0])||(t=[t]),y=t.length,_=t[0].length,h=0;h<_;h++){for(g=new Array(y),q=0;q<y;q++)g[q]=t[q][h];c.push(g)}return c.length===1?c[0]:c},o.map=function(t,c,g){var y,_,q,h,k;for(i(t[0])||(t=[t]),_=t.length,q=t[0].length,h=g?t:new Array(_),y=0;y<_;y++)for(h[y]||(h[y]=new Array(q)),k=0;k<q;k++)h[y][k]=c(t[y][k],y,k);return h.length===1?h[0]:h},o.cumreduce=function(t,c,g){var y,_,q,h,k;for(i(t[0])||(t=[t]),_=t.length,q=t[0].length,h=g?t:new Array(_),y=0;y<_;y++)for(h[y]||(h[y]=new Array(q)),q>0&&(h[y][0]=t[y][0]),k=1;k<q;k++)h[y][k]=c(h[y][k-1],t[y][k]);return h.length===1?h[0]:h},o.alter=function(t,c){return o.map(t,c,!0)},o.create=function(t,c,g){var y=new Array(t),_,q;for(r(c)&&(g=c,c=t),_=0;_<t;_++)for(y[_]=new Array(c),q=0;q<c;q++)y[_][q]=g(_,q);return y};function s(){return 0}o.zeros=function(t,c){return n(c)||(c=t),o.create(t,c,s)};function v(){return 1}o.ones=function(t,c){return n(c)||(c=t),o.create(t,c,v)},o.rand=function(t,c){return n(c)||(c=t),o.create(t,c,o._random_fn)};function l(m,t){return m===t?1:0}o.identity=function(t,c){return n(c)||(c=t),o.create(t,c,l)},o.symmetric=function(t){var c=t.length,g,y;if(t.length!==t[0].length)return!1;for(g=0;g<c;g++)for(y=0;y<c;y++)if(t[y][g]!==t[g][y])return!1;return!0},o.clear=function(t){return o.alter(t,s)},o.seq=function(t,c,g,y){r(y)||(y=!1);var _=[],q=p(t,c),h=(c*q-t*q)/((g-1)*q),k=t,E;for(E=0;k<=c&&E<g;E++,k=(t*q+h*q*E)/q)_.push(y?y(k,E):k);return _},o.arange=function(t,c,g){var y=[],_;if(g=g||1,c===f&&(c=t,t=0),t===c||g===0)return[];if(t<c&&g<0)return[];if(t>c&&g>0)return[];if(g>0)for(_=t;_<c;_+=g)y.push(_);else for(_=t;_>c;_+=g)y.push(_);return y},o.slice=function(){function m(c,g,y,_){var q,h=[],k=c.length;if(g===f&&y===f&&_===f)return o.copy(c);if(g=g||0,y=y||c.length,g=g>=0?g:k+g,y=y>=0?y:k+y,_=_||1,g===y||_===0)return[];if(g<y&&_<0)return[];if(g>y&&_>0)return[];if(_>0)for(q=g;q<y;q+=_)h.push(c[q]);else for(q=g;q>y;q+=_)h.push(c[q]);return h}function t(c,g){var y,_;if(g=g||{},n(g.row)){if(n(g.col))return c[g.row][g.col];var q=o.rowa(c,g.row);return y=g.col||{},m(q,y.start,y.end,y.step)}if(n(g.col)){var h=o.cola(c,g.col);return _=g.row||{},m(h,_.start,_.end,_.step)}_=g.row||{},y=g.col||{};var k=m(c,_.start,_.end,_.step);return k.map(function(E){return m(E,y.start,y.end,y.step)})}return t}(),o.sliceAssign=function(t,c,g){var y,_;if(n(c.row)){if(n(c.col))return t[c.row][c.col]=g;c.col=c.col||{},c.col.start=c.col.start||0,c.col.end=c.col.end||t[0].length,c.col.step=c.col.step||1,y=o.arange(c.col.start,u.min(t.length,c.col.end),c.col.step);var q=c.row;return y.forEach(function(k,E){t[q][k]=g[E]}),t}if(n(c.col)){c.row=c.row||{},c.row.start=c.row.start||0,c.row.end=c.row.end||t.length,c.row.step=c.row.step||1,_=o.arange(c.row.start,u.min(t[0].length,c.row.end),c.row.step);var h=c.col;return _.forEach(function(k,E){t[k][h]=g[E]}),t}return g[0].length===f&&(g=[g]),c.row.start=c.row.start||0,c.row.end=c.row.end||t.length,c.row.step=c.row.step||1,c.col.start=c.col.start||0,c.col.end=c.col.end||t[0].length,c.col.step=c.col.step||1,_=o.arange(c.row.start,u.min(t.length,c.row.end),c.row.step),y=o.arange(c.col.start,u.min(t[0].length,c.col.end),c.col.step),_.forEach(function(k,E){y.forEach(function(I,z){t[k][I]=g[E][z]})}),t},o.diagonal=function(t){var c=o.zeros(t.length,t.length);return t.forEach(function(g,y){c[y][y]=g}),c},o.copy=function(t){return t.map(function(c){return n(c)?c:c.map(function(g){return g})})};var a=o.prototype;return a.length=0,a.push=Array.prototype.push,a.sort=Array.prototype.sort,a.splice=Array.prototype.splice,a.slice=Array.prototype.slice,a.toArray=function(){return this.length>1?d.call(this):d.call(this)[0]},a.map=function(t,c){return o(o.map(this,t,c))},a.cumreduce=function(t,c){return o(o.cumreduce(this,t,c))},a.alter=function(t){return o.alter(this,t),this},function(m){for(var t=0;t<m.length;t++)(function(c){a[c]=function(g){var y=this,_;return g?(setTimeout(function(){g.call(y,a[c].call(y))}),this):(_=o[c](this),i(_)?o(_):_)}})(m[t])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(m){for(var t=0;t<m.length;t++)(function(c){a[c]=function(g,y){var _=this;return y?(setTimeout(function(){y.call(_,a[c].call(_,g))}),this):o(o[c](this,g))}})(m[t])}("row col".split(" ")),function(m){for(var t=0;t<m.length;t++)(function(c){a[c]=function(){return o(o[c].apply(null,arguments))}})(m[t])}("create zeros ones rand identity".split(" ")),o}(Math);return function(u,f){var b=u.utils.isFunction;function d(i,r){return i-r}function w(i,r,n){return f.max(r,f.min(i,n))}u.sum=function(r){for(var n=0,e=r.length;--e>=0;)n+=r[e];return n},u.sumsqrd=function(r){for(var n=0,e=r.length;--e>=0;)n+=r[e]*r[e];return n},u.sumsqerr=function(r){for(var n=u.mean(r),e=0,o=r.length,s;--o>=0;)s=r[o]-n,e+=s*s;return e},u.sumrow=function(r){for(var n=0,e=r.length;--e>=0;)n+=r[e];return n},u.product=function(r){for(var n=1,e=r.length;--e>=0;)n*=r[e];return n},u.min=function(r){for(var n=r[0],e=0;++e<r.length;)r[e]<n&&(n=r[e]);return n},u.max=function(r){for(var n=r[0],e=0;++e<r.length;)r[e]>n&&(n=r[e]);return n},u.unique=function(r){for(var n={},e=[],o=0;o<r.length;o++)n[r[o]]||(n[r[o]]=!0,e.push(r[o]));return e},u.mean=function(r){return u.sum(r)/r.length},u.meansqerr=function(r){return u.sumsqerr(r)/r.length},u.geomean=function(r){var n=r.map(f.log),e=u.mean(n);return f.exp(e)},u.median=function(r){var n=r.length,e=r.slice().sort(d);return n&1?e[n/2|0]:(e[n/2-1]+e[n/2])/2},u.cumsum=function(r){return u.cumreduce(r,function(n,e){return n+e})},u.cumprod=function(r){return u.cumreduce(r,function(n,e){return n*e})},u.diff=function(r){var n=[],e=r.length,o;for(o=1;o<e;o++)n.push(r[o]-r[o-1]);return n},u.rank=function(i){var r,n=[],e={};for(r=0;r<i.length;r++){var o=i[r];e[o]?e[o]++:(e[o]=1,n.push(o))}var s=n.sort(d),v={},l=1;for(r=0;r<s.length;r++){var o=s[r],a=e[o],m=l,t=l+a-1,c=(m+t)/2;v[o]=c,l+=a}return i.map(function(g){return v[g]})},u.mode=function(r){var n=r.length,e=r.slice().sort(d),o=1,s=0,v=0,l=[],a;for(a=0;a<n;a++)e[a]===e[a+1]?o++:(o>s?(l=[e[a]],s=o,v=0):o===s&&(l.push(e[a]),v++),o=1);return v===0?l[0]:l},u.range=function(r){return u.max(r)-u.min(r)},u.variance=function(r,n){return u.sumsqerr(r)/(r.length-(n?1:0))},u.pooledvariance=function(r){var n=r.reduce(function(o,s){return o+u.sumsqerr(s)},0),e=r.reduce(function(o,s){return o+s.length},0);return n/(e-r.length)},u.deviation=function(i){for(var r=u.mean(i),n=i.length,e=new Array(n),o=0;o<n;o++)e[o]=i[o]-r;return e},u.stdev=function(r,n){return f.sqrt(u.variance(r,n))},u.pooledstdev=function(r){return f.sqrt(u.pooledvariance(r))},u.meandev=function(r){for(var n=u.mean(r),e=[],o=r.length-1;o>=0;o--)e.push(f.abs(r[o]-n));return u.mean(e)},u.meddev=function(r){for(var n=u.median(r),e=[],o=r.length-1;o>=0;o--)e.push(f.abs(r[o]-n));return u.median(e)},u.coeffvar=function(r){return u.stdev(r)/u.mean(r)},u.quartiles=function(r){var n=r.length,e=r.slice().sort(d);return[e[f.round(n/4)-1],e[f.round(n/2)-1],e[f.round(n*3/4)-1]]},u.quantiles=function(r,n,e,o){var s=r.slice().sort(d),v=[n.length],l=r.length,a,m,t,c,g,y;for(typeof e=="undefined"&&(e=3/8),typeof o=="undefined"&&(o=3/8),a=0;a<n.length;a++)m=n[a],t=e+m*(1-e-o),c=l*m+t,g=f.floor(w(c,1,l-1)),y=w(c-g,0,1),v[a]=(1-y)*s[g-1]+y*s[g];return v},u.percentile=function(r,n,e){var o=r.slice().sort(d),s=n*(o.length+(e?1:-1))+(e?0:1),v=parseInt(s),l=s-v;return v+1<o.length?o[v-1]+l*(o[v]-o[v-1]):o[v-1]},u.percentileOfScore=function(r,n,e){var o=0,s=r.length,v=!1,l,a;for(e==="strict"&&(v=!0),a=0;a<s;a++)l=r[a],(v&&l<n||!v&&l<=n)&&o++;return o/s},u.histogram=function(r,n){n=n||4;var e=u.min(r),o=(u.max(r)-e)/n,s=r.length,v=[],l;for(l=0;l<n;l++)v[l]=0;for(l=0;l<s;l++)v[f.min(f.floor((r[l]-e)/o),n-1)]+=1;return v},u.covariance=function(r,n){var e=u.mean(r),o=u.mean(n),s=r.length,v=new Array(s),l;for(l=0;l<s;l++)v[l]=(r[l]-e)*(n[l]-o);return u.sum(v)/(s-1)},u.corrcoeff=function(r,n){return u.covariance(r,n)/u.stdev(r,1)/u.stdev(n,1)},u.spearmancoeff=function(i,r){return i=u.rank(i),r=u.rank(r),u.corrcoeff(i,r)},u.stanMoment=function(r,n){for(var e=u.mean(r),o=u.stdev(r),s=r.length,v=0,l=0;l<s;l++)v+=f.pow((r[l]-e)/o,n);return v/r.length},u.skewness=function(r){return u.stanMoment(r,3)},u.kurtosis=function(r){return u.stanMoment(r,4)-3};var p=u.prototype;(function(i){for(var r=0;r<i.length;r++)(function(n){p[n]=function(e,o){var s=[],v=0,l=this;if(b(e)&&(o=e,e=!1),o)return setTimeout(function(){o.call(l,p[n].call(l,e))}),this;if(this.length>1){for(l=e===!0?this:this.transpose();v<l.length;v++)s[v]=u[n](l[v]);return s}return u[n](this[0],e)}})(i[r])})("cumsum cumprod".split(" ")),function(i){for(var r=0;r<i.length;r++)(function(n){p[n]=function(e,o){var s=[],v=0,l=this;if(b(e)&&(o=e,e=!1),o)return setTimeout(function(){o.call(l,p[n].call(l,e))}),this;if(this.length>1){for(n!=="sumrow"&&(l=e===!0?this:this.transpose());v<l.length;v++)s[v]=u[n](l[v]);return e===!0?u[n](u.utils.toVector(s)):s}return u[n](this[0],e)}})(i[r])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(i){for(var r=0;r<i.length;r++)(function(n){p[n]=function(){var e=[],o=0,s=this,v=Array.prototype.slice.call(arguments),l;if(b(v[v.length-1])){l=v[v.length-1];var a=v.slice(0,v.length-1);return setTimeout(function(){l.call(s,p[n].apply(s,a))}),this}else{l=void 0;var m=function(c){return u[n].apply(s,[c].concat(v))}}if(this.length>1){for(s=s.transpose();o<s.length;o++)e[o]=m(s[o]);return e}return m(this[0])}})(i[r])}("quantiles percentileOfScore".split(" "))}(R,Math),function(u,f){u.gammaln=function(d){var w=0,p=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],i=1.000000000190015,r,n,e;for(e=(n=r=d)+5.5,e-=(r+.5)*f.log(e);w<6;w++)i+=p[w]/++n;return f.log(2.5066282746310007*i/r)-e},u.loggam=function(d){var w,p,i,r,n,e,o,s=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(w=d,o=0,d==1||d==2)return 0;for(d<=7&&(o=f.floor(7-d),w=d+o),p=1/(w*w),i=2*f.PI,n=s[9],e=8;e>=0;e--)n*=p,n+=s[e];if(r=n/w+.5*f.log(i)+(w-.5)*f.log(w)-w,d<=7)for(e=1;e<=o;e++)r-=f.log(w-1),w-=1;return r},u.gammafn=function(d){var w=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],p=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],i=!1,r=0,n=0,e=0,o=d,s,v,l,a;if(d>171.6243769536076)return 1/0;if(o<=0)if(a=o%1+36e-17,a)i=(o&1?-1:1)*f.PI/f.sin(f.PI*a),o=1-o;else return 1/0;for(l=o,o<1?v=o++:v=(o-=r=(o|0)-1)-1,s=0;s<8;++s)e=(e+w[s])*v,n=n*v+p[s];if(a=e/n+1,l<o)a/=l;else if(l>o)for(s=0;s<r;++s)a*=o,o++;return i&&(a=i/a),a},u.gammap=function(d,w){return u.lowRegGamma(d,w)*u.gammafn(d)},u.lowRegGamma=function(d,w){var p=u.gammaln(d),i=d,r=1/d,n=r,e=w+1-d,o=1/1e-30,s=1/e,v=s,l=1,a=-~(f.log(d>=1?d:1/d)*8.5+d*.4+17),m;if(w<0||d<=0)return NaN;if(w<d+1){for(;l<=a;l++)r+=n*=w/++i;return r*f.exp(-w+d*f.log(w)-p)}for(;l<=a;l++)m=-l*(l-d),e+=2,s=m*s+e,o=e+m/o,s=1/s,v*=s*o;return 1-v*f.exp(-w+d*f.log(w)-p)},u.factorialln=function(d){return d<0?NaN:u.gammaln(d+1)},u.factorial=function(d){return d<0?NaN:u.gammafn(d+1)},u.combination=function(d,w){return d>170||w>170?f.exp(u.combinationln(d,w)):u.factorial(d)/u.factorial(w)/u.factorial(d-w)},u.combinationln=function(d,w){return u.factorialln(d)-u.factorialln(w)-u.factorialln(d-w)},u.permutation=function(d,w){return u.factorial(d)/u.factorial(d-w)},u.betafn=function(d,w){if(!(d<=0||w<=0))return d+w>170?f.exp(u.betaln(d,w)):u.gammafn(d)*u.gammafn(w)/u.gammafn(d+w)},u.betaln=function(d,w){return u.gammaln(d)+u.gammaln(w)-u.gammaln(d+w)},u.betacf=function(d,w,p){var i=1e-30,r=1,n=w+p,e=w+1,o=w-1,s=1,v=1-n*d/e,l,a,m,t;for(f.abs(v)<i&&(v=i),v=1/v,t=v;r<=100&&(l=2*r,a=r*(p-r)*d/((o+l)*(w+l)),v=1+a*v,f.abs(v)<i&&(v=i),s=1+a/s,f.abs(s)<i&&(s=i),v=1/v,t*=v*s,a=-(w+r)*(n+r)*d/((w+l)*(e+l)),v=1+a*v,f.abs(v)<i&&(v=i),s=1+a/s,f.abs(s)<i&&(s=i),v=1/v,m=v*s,t*=m,!(f.abs(m-1)<3e-7));r++);return t},u.gammapinv=function(d,w){var p=0,i=w-1,r=1e-8,n=u.gammaln(w),e,o,s,v,l,a,m;if(d>=1)return f.max(100,w+100*f.sqrt(w));if(d<=0)return 0;for(w>1?(a=f.log(i),m=f.exp(i*(a-1)-n),l=d<.5?d:1-d,s=f.sqrt(-2*f.log(l)),e=(2.30753+s*.27061)/(1+s*(.99229+s*.04481))-s,d<.5&&(e=-e),e=f.max(.001,w*f.pow(1-1/(9*w)-e/(3*f.sqrt(w)),3))):(s=1-w*(.253+w*.12),d<s?e=f.pow(d/s,1/w):e=1-f.log(1-(d-s)/(1-s)));p<12;p++){if(e<=0)return 0;if(o=u.lowRegGamma(w,e)-d,w>1?s=m*f.exp(-(e-i)+i*(f.log(e)-a)):s=f.exp(-e+i*f.log(e)-n),v=o/s,e-=s=v/(1-.5*f.min(1,v*((w-1)/e-1))),e<=0&&(e=.5*(e+s)),f.abs(s)<r*e)break}return e},u.erf=function(d){var w=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],p=w.length-1,i=!1,r=0,n=0,e,o,s,v;for(d<0&&(d=-d,i=!0),e=2/(2+d),o=4*e-2;p>0;p--)s=r,r=o*r-n+w[p],n=s;return v=e*f.exp(-d*d+.5*(w[0]+o*r)-n),i?v-1:1-v},u.erfc=function(d){return 1-u.erf(d)},u.erfcinv=function(d){var w=0,p,i,r,n;if(d>=2)return-100;if(d<=0)return 100;for(n=d<1?d:2-d,r=f.sqrt(-2*f.log(n/2)),p=-.70711*((2.30753+r*.27061)/(1+r*(.99229+r*.04481))-r);w<2;w++)i=u.erfc(p)-n,p+=i/(1.1283791670955126*f.exp(-p*p)-p*i);return d<1?p:-p},u.ibetainv=function(d,w,p){var i=1e-8,r=w-1,n=p-1,e=0,o,s,v,l,a,m,t,c,g,y,_;if(d<=0)return 0;if(d>=1)return 1;for(w>=1&&p>=1?(v=d<.5?d:1-d,l=f.sqrt(-2*f.log(v)),t=(2.30753+l*.27061)/(1+l*(.99229+l*.04481))-l,d<.5&&(t=-t),c=(t*t-3)/6,g=2/(1/(2*w-1)+1/(2*p-1)),y=t*f.sqrt(c+g)/g-(1/(2*p-1)-1/(2*w-1))*(c+5/6-2/(3*g)),t=w/(w+p*f.exp(2*y))):(o=f.log(w/(w+p)),s=f.log(p/(w+p)),l=f.exp(w*o)/w,a=f.exp(p*s)/p,y=l+a,d<l/y?t=f.pow(w*y*d,1/w):t=1-f.pow(p*y*(1-d),1/p)),_=-u.gammaln(w)-u.gammaln(p)+u.gammaln(w+p);e<10;e++){if(t===0||t===1)return t;if(m=u.ibeta(t,w,p)-d,l=f.exp(r*f.log(t)+n*f.log(1-t)+_),a=m/l,t-=l=a/(1-.5*f.min(1,a*(r/t-n/(1-t)))),t<=0&&(t=.5*(t+l)),t>=1&&(t=.5*(t+l+1)),f.abs(l)<i*t&&e>0)break}return t},u.ibeta=function(d,w,p){var i=d===0||d===1?0:f.exp(u.gammaln(w+p)-u.gammaln(w)-u.gammaln(p)+w*f.log(d)+p*f.log(1-d));return d<0||d>1?!1:d<(w+1)/(w+p+2)?i*u.betacf(d,w,p)/w:1-i*u.betacf(1-d,p,w)/p},u.randn=function(d,w){var p,i,r,n,e;if(w||(w=d),d)return u.create(d,w,function(){return u.randn()});do p=u._random_fn(),i=1.7156*(u._random_fn()-.5),r=p-.449871,n=f.abs(i)+.386595,e=r*r+n*(.196*n-.25472*r);while(e>.27597&&(e>.27846||i*i>-4*f.log(p)*p*p));return i/p},u.randg=function(d,w,p){var i=d,r,n,e,o,s,v;if(p||(p=w),d||(d=1),w)return v=u.zeros(w,p),v.alter(function(){return u.randg(d)}),v;d<1&&(d+=1),r=d-1/3,n=1/f.sqrt(9*r);do{do s=u.randn(),o=1+n*s;while(o<=0);o=o*o*o,e=u._random_fn()}while(e>1-.331*f.pow(s,4)&&f.log(e)>.5*s*s+r*(1-o+f.log(o)));if(d==i)return r*o;do e=u._random_fn();while(e===0);return f.pow(e,1/i)*r*o},function(b){for(var d=0;d<b.length;d++)(function(w){u.fn[w]=function(){return u(u.map(this,function(p){return u[w](p)}))}})(b[d])}("gammaln gammafn factorial factorialln".split(" ")),function(b){for(var d=0;d<b.length;d++)(function(w){u.fn[w]=function(){return u(u[w].apply(null,arguments))}})(b[d])}("randn".split(" "))}(R,Math),function(u,f){(function(i){for(var r=0;r<i.length;r++)(function(n){u[n]=function e(o,s,v){return this instanceof e?(this._a=o,this._b=s,this._c=v,this):new e(o,s,v)},u.fn[n]=function(e,o,s){var v=u[n](e,o,s);return v.data=this,v},u[n].prototype.sample=function(e){var o=this._a,s=this._b,v=this._c;return e?u.alter(e,function(){return u[n].sample(o,s,v)}):u[n].sample(o,s,v)},function(e){for(var o=0;o<e.length;o++)(function(s){u[n].prototype[s]=function(v){var l=this._a,a=this._b,m=this._c;return!v&&v!==0&&(v=this.data),typeof v!="number"?u.fn.map.call(v,function(t){return u[n][s](t,l,a,m)}):u[n][s](v,l,a,m)}})(e[o])}("pdf cdf inv".split(" ")),function(e){for(var o=0;o<e.length;o++)(function(s){u[n].prototype[s]=function(){return u[n][s](this._a,this._b,this._c)}})(e[o])}("mean median mode variance".split(" "))})(i[r])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),u.extend(u.beta,{pdf:function(r,n,e){return r>1||r<0?0:n==1&&e==1?1:n<512&&e<512?f.pow(r,n-1)*f.pow(1-r,e-1)/u.betafn(n,e):f.exp((n-1)*f.log(r)+(e-1)*f.log(1-r)-u.betaln(n,e))},cdf:function(r,n,e){return r>1||r<0?(r>1)*1:u.ibeta(r,n,e)},inv:function(r,n,e){return u.ibetainv(r,n,e)},mean:function(r,n){return r/(r+n)},median:function(r,n){return u.ibetainv(.5,r,n)},mode:function(r,n){return(r-1)/(r+n-2)},sample:function(r,n){var e=u.randg(r);return e/(e+u.randg(n))},variance:function(r,n){return r*n/(f.pow(r+n,2)*(r+n+1))}}),u.extend(u.centralF,{pdf:function(r,n,e){var o,s,v;return r<0?0:n<=2?r===0&&n<2?1/0:r===0&&n===2?1:1/u.betafn(n/2,e/2)*f.pow(n/e,n/2)*f.pow(r,n/2-1)*f.pow(1+n/e*r,-(n+e)/2):(o=n*r/(e+r*n),s=e/(e+r*n),v=n*s/2,v*u.binomial.pdf((n-2)/2,(n+e-2)/2,o))},cdf:function(r,n,e){return r<0?0:u.ibeta(n*r/(n*r+e),n/2,e/2)},inv:function(r,n,e){return e/(n*(1/u.ibetainv(r,n/2,e/2)-1))},mean:function(r,n){return n>2?n/(n-2):void 0},mode:function(r,n){return r>2?n*(r-2)/(r*(n+2)):void 0},sample:function(r,n){var e=u.randg(r/2)*2,o=u.randg(n/2)*2;return e/r/(o/n)},variance:function(r,n){if(!(n<=4))return 2*n*n*(r+n-2)/(r*(n-2)*(n-2)*(n-4))}}),u.extend(u.cauchy,{pdf:function(r,n,e){return e<0?0:e/(f.pow(r-n,2)+f.pow(e,2))/f.PI},cdf:function(r,n,e){return f.atan((r-n)/e)/f.PI+.5},inv:function(i,r,n){return r+n*f.tan(f.PI*(i-.5))},median:function(r){return r},mode:function(r){return r},sample:function(r,n){return u.randn()*f.sqrt(1/(2*u.randg(.5)))*n+r}}),u.extend(u.chisquare,{pdf:function(r,n){return r<0?0:r===0&&n===2?.5:f.exp((n/2-1)*f.log(r)-r/2-n/2*f.log(2)-u.gammaln(n/2))},cdf:function(r,n){return r<0?0:u.lowRegGamma(n/2,r/2)},inv:function(i,r){return 2*u.gammapinv(i,.5*r)},mean:function(i){return i},median:function(r){return r*f.pow(1-2/(9*r),3)},mode:function(r){return r-2>0?r-2:0},sample:function(r){return u.randg(r/2)*2},variance:function(r){return 2*r}}),u.extend(u.exponential,{pdf:function(r,n){return r<0?0:n*f.exp(-n*r)},cdf:function(r,n){return r<0?0:1-f.exp(-n*r)},inv:function(i,r){return-f.log(1-i)/r},mean:function(i){return 1/i},median:function(i){return 1/i*f.log(2)},mode:function(){return 0},sample:function(r){return-1/r*f.log(u._random_fn())},variance:function(i){return f.pow(i,-2)}}),u.extend(u.gamma,{pdf:function(r,n,e){return r<0?0:r===0&&n===1?1/e:f.exp((n-1)*f.log(r)-r/e-u.gammaln(n)-n*f.log(e))},cdf:function(r,n,e){return r<0?0:u.lowRegGamma(n,r/e)},inv:function(i,r,n){return u.gammapinv(i,r)*n},mean:function(i,r){return i*r},mode:function(r,n){if(r>1)return(r-1)*n},sample:function(r,n){return u.randg(r)*n},variance:function(r,n){return r*n*n}}),u.extend(u.invgamma,{pdf:function(r,n,e){return r<=0?0:f.exp(-(n+1)*f.log(r)-e/r-u.gammaln(n)+n*f.log(e))},cdf:function(r,n,e){return r<=0?0:1-u.lowRegGamma(n,e/r)},inv:function(i,r,n){return n/u.gammapinv(1-i,r)},mean:function(i,r){return i>1?r/(i-1):void 0},mode:function(r,n){return n/(r+1)},sample:function(r,n){return n/u.randg(r)},variance:function(r,n){if(!(r<=2))return n*n/((r-1)*(r-1)*(r-2))}}),u.extend(u.kumaraswamy,{pdf:function(r,n,e){return r===0&&n===1?e:r===1&&e===1?n:f.exp(f.log(n)+f.log(e)+(n-1)*f.log(r)+(e-1)*f.log(1-f.pow(r,n)))},cdf:function(r,n,e){return r<0?0:r>1?1:1-f.pow(1-f.pow(r,n),e)},inv:function(r,n,e){return f.pow(1-f.pow(1-r,1/e),1/n)},mean:function(i,r){return r*u.gammafn(1+1/i)*u.gammafn(r)/u.gammafn(1+1/i+r)},median:function(r,n){return f.pow(1-f.pow(2,-1/n),1/r)},mode:function(r,n){if(r>=1&&n>=1&&r!==1&&n!==1)return f.pow((r-1)/(r*n-1),1/r)},variance:function(){throw new Error("variance not yet implemented")}}),u.extend(u.lognormal,{pdf:function(r,n,e){return r<=0?0:f.exp(-f.log(r)-.5*f.log(2*f.PI)-f.log(e)-f.pow(f.log(r)-n,2)/(2*e*e))},cdf:function(r,n,e){return r<0?0:.5+.5*u.erf((f.log(r)-n)/f.sqrt(2*e*e))},inv:function(i,r,n){return f.exp(-1.4142135623730951*n*u.erfcinv(2*i)+r)},mean:function(r,n){return f.exp(r+n*n/2)},median:function(r){return f.exp(r)},mode:function(r,n){return f.exp(r-n*n)},sample:function(r,n){return f.exp(u.randn()*n+r)},variance:function(r,n){return(f.exp(n*n)-1)*f.exp(2*r+n*n)}}),u.extend(u.noncentralt,{pdf:function(r,n,e){var o=1e-14;return f.abs(e)<o?u.studentt.pdf(r,n):f.abs(r)<o?f.exp(u.gammaln((n+1)/2)-e*e/2-.5*f.log(f.PI*n)-u.gammaln(n/2)):n/r*(u.noncentralt.cdf(r*f.sqrt(1+2/n),n+2,e)-u.noncentralt.cdf(r,n,e))},cdf:function(r,n,e){var o=1e-14,s=200;if(f.abs(e)<o)return u.studentt.cdf(r,n);var v=!1;r<0&&(v=!0,e=-e);for(var l=u.normal.cdf(-e,0,1),a=o+1,m=a,t=r*r/(r*r+n),c=0,g=f.exp(-e*e/2),y=f.exp(-e*e/2-.5*f.log(2)-u.gammaln(3/2))*e;c<s||m>o||a>o;)m=a,c>0&&(g*=e*e/(2*c),y*=e*e/(2*(c+1/2))),a=g*u.beta.cdf(t,c+.5,n/2)+y*u.beta.cdf(t,c+1,n/2),l+=.5*a,c++;return v?1-l:l}}),u.extend(u.normal,{pdf:function(r,n,e){return f.exp(-.5*f.log(2*f.PI)-f.log(e)-f.pow(r-n,2)/(2*e*e))},cdf:function(r,n,e){return .5*(1+u.erf((r-n)/f.sqrt(2*e*e)))},inv:function(i,r,n){return-1.4142135623730951*n*u.erfcinv(2*i)+r},mean:function(i){return i},median:function(r){return r},mode:function(i){return i},sample:function(r,n){return u.randn()*n+r},variance:function(i,r){return r*r}}),u.extend(u.pareto,{pdf:function(r,n,e){return r<n?0:e*f.pow(n,e)/f.pow(r,e+1)},cdf:function(r,n,e){return r<n?0:1-f.pow(n/r,e)},inv:function(r,n,e){return n/f.pow(1-r,1/e)},mean:function(r,n){if(!(n<=1))return n*f.pow(r,n)/(n-1)},median:function(r,n){return r*(n*f.SQRT2)},mode:function(r){return r},variance:function(i,r){if(!(r<=2))return i*i*r/(f.pow(r-1,2)*(r-2))}}),u.extend(u.studentt,{pdf:function(r,n){return n=n>1e100?1e100:n,1/(f.sqrt(n)*u.betafn(.5,n/2))*f.pow(1+r*r/n,-((n+1)/2))},cdf:function(r,n){var e=n/2;return u.ibeta((r+f.sqrt(r*r+n))/(2*f.sqrt(r*r+n)),e,e)},inv:function(i,r){var n=u.ibetainv(2*f.min(i,1-i),.5*r,.5);return n=f.sqrt(r*(1-n)/n),i>.5?n:-n},mean:function(r){return r>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(r){return u.randn()*f.sqrt(r/(2*u.randg(r/2)))},variance:function(r){return r>2?r/(r-2):r>1?1/0:void 0}}),u.extend(u.weibull,{pdf:function(r,n,e){return r<0||n<0||e<0?0:e/n*f.pow(r/n,e-1)*f.exp(-f.pow(r/n,e))},cdf:function(r,n,e){return r<0?0:1-f.exp(-f.pow(r/n,e))},inv:function(i,r,n){return r*f.pow(-f.log(1-i),1/n)},mean:function(i,r){return i*u.gammafn(1+1/r)},median:function(r,n){return r*f.pow(f.log(2),1/n)},mode:function(r,n){return n<=1?0:r*f.pow((n-1)/n,1/n)},sample:function(r,n){return r*f.pow(-f.log(u._random_fn()),1/n)},variance:function(r,n){return r*r*u.gammafn(1+2/n)-f.pow(u.weibull.mean(r,n),2)}}),u.extend(u.uniform,{pdf:function(r,n,e){return r<n||r>e?0:1/(e-n)},cdf:function(r,n,e){return r<n?0:r<e?(r-n)/(e-n):1},inv:function(i,r,n){return r+i*(n-r)},mean:function(r,n){return .5*(r+n)},median:function(r,n){return u.mean(r,n)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(r,n){return r/2+n/2+(n/2-r/2)*(2*u._random_fn()-1)},variance:function(r,n){return f.pow(n-r,2)/12}});function b(i,r,n,e){for(var o=0,s=1,v=1,l=1,a=0,m=0,t;f.abs((v-m)/v)>e;)m=v,t=-(r+a)*(r+n+a)*i/(r+2*a)/(r+2*a+1),o=v+t*o,s=l+t*s,a=a+1,t=a*(n-a)*i/(r+2*a-1)/(r+2*a),v=o+t*v,l=s+t*l,o=o/l,s=s/l,v=v/l,l=1;return v/r}u.extend(u.binomial,{pdf:function(r,n,e){return e===0||e===1?n*e===r?1:0:u.combination(n,r)*f.pow(e,r)*f.pow(1-e,n-r)},cdf:function(r,n,e){var o,s=1e-10;if(r<0)return 0;if(r>=n)return 1;if(e<0||e>1||n<=0)return NaN;r=f.floor(r);var v=e,l=r+1,a=n-r,m=l+a,t=f.exp(u.gammaln(m)-u.gammaln(a)-u.gammaln(l)+l*f.log(v)+a*f.log(1-v));return v<(l+1)/(m+2)?o=t*b(v,l,a,s):o=1-t*b(1-v,a,l,s),f.round((1-o)*(1/s))/(1/s)}}),u.extend(u.negbin,{pdf:function(r,n,e){return r!==r>>>0?!1:r<0?0:u.combination(r+n-1,n-1)*f.pow(1-e,r)*f.pow(e,n)},cdf:function(r,n,e){var o=0,s=0;if(r<0)return 0;for(;s<=r;s++)o+=u.negbin.pdf(s,n,e);return o}}),u.extend(u.hypgeom,{pdf:function(r,n,e,o){if(r!==r|0)return!1;if(r<0||r<e-(n-o))return 0;if(r>o||r>e)return 0;if(e*2>n)return o*2>n?u.hypgeom.pdf(n-e-o+r,n,n-e,n-o):u.hypgeom.pdf(o-r,n,n-e,o);if(o*2>n)return u.hypgeom.pdf(e-r,n,e,n-o);if(e<o)return u.hypgeom.pdf(r,n,o,e);for(var s=1,v=0,l=0;l<r;l++){for(;s>1&&v<o;)s*=1-e/(n-v),v++;s*=(o-l)*(e-l)/((l+1)*(n-e-o+l+1))}for(;v<o;v++)s*=1-e/(n-v);return f.min(1,f.max(0,s))},cdf:function(r,n,e,o){if(r<0||r<e-(n-o))return 0;if(r>=o||r>=e)return 1;if(e*2>n)return o*2>n?u.hypgeom.cdf(n-e-o+r,n,n-e,n-o):1-u.hypgeom.cdf(o-r-1,n,n-e,o);if(o*2>n)return 1-u.hypgeom.cdf(e-r-1,n,e,n-o);if(e<o)return u.hypgeom.cdf(r,n,o,e);for(var s=1,v=1,l=0,a=0;a<r;a++){for(;s>1&&l<o;){var m=1-e/(n-l);v*=m,s*=m,l++}v*=(o-a)*(e-a)/((a+1)*(n-e-o+a+1)),s+=v}for(;l<o;l++)s*=1-e/(n-l);return f.min(1,f.max(0,s))}}),u.extend(u.poisson,{pdf:function(r,n){return n<0||r%1!==0||r<0?0:f.pow(n,r)*f.exp(-n)/u.factorial(r)},cdf:function(r,n){var e=[],o=0;if(r<0)return 0;for(;o<=r;o++)e.push(u.poisson.pdf(o,n));return u.sum(e)},mean:function(i){return i},variance:function(i){return i},sampleSmall:function(r){var n=1,e=0,o=f.exp(-r);do e++,n*=u._random_fn();while(n>o);return e-1},sampleLarge:function(r){var n=r,e,o,s,v,l,a,m,t,c,g;for(v=f.sqrt(n),l=f.log(n),m=.931+2.53*v,a=-.059+.02483*m,t=1.1239+1.1328/(m-3.4),c=.9277-3.6224/(m-2);;){if(o=f.random()-.5,s=f.random(),g=.5-f.abs(o),e=f.floor((2*a/g+m)*o+n+.43),g>=.07&&s<=c)return e;if(!(e<0||g<.013&&s>g)&&f.log(s)+f.log(t)-f.log(a/(g*g)+m)<=-n+e*l-u.loggam(e+1))return e}},sample:function(r){return r<10?this.sampleSmall(r):this.sampleLarge(r)}}),u.extend(u.triangular,{pdf:function(r,n,e,o){return e<=n||o<n||o>e?NaN:r<n||r>e?0:r<o?2*(r-n)/((e-n)*(o-n)):r===o?2/(e-n):2*(e-r)/((e-n)*(e-o))},cdf:function(r,n,e,o){return e<=n||o<n||o>e?NaN:r<=n?0:r>=e?1:r<=o?f.pow(r-n,2)/((e-n)*(o-n)):1-f.pow(e-r,2)/((e-n)*(e-o))},inv:function(r,n,e,o){return e<=n||o<n||o>e?NaN:r<=(o-n)/(e-n)?n+(e-n)*f.sqrt(r*((o-n)/(e-n))):n+(e-n)*(1-f.sqrt((1-r)*(1-(o-n)/(e-n))))},mean:function(r,n,e){return(r+n+e)/3},median:function(r,n,e){if(e<=(r+n)/2)return n-f.sqrt((n-r)*(n-e))/f.sqrt(2);if(e>(r+n)/2)return r+f.sqrt((n-r)*(e-r))/f.sqrt(2)},mode:function(r,n,e){return e},sample:function(r,n,e){var o=u._random_fn();return o<(e-r)/(n-r)?r+f.sqrt(o*(n-r)*(e-r)):n-f.sqrt((1-o)*(n-r)*(n-e))},variance:function(r,n,e){return(r*r+n*n+e*e-r*n-r*e-n*e)/18}}),u.extend(u.arcsine,{pdf:function(r,n,e){return e<=n?NaN:r<=n||r>=e?0:2/f.PI*f.pow(f.pow(e-n,2)-f.pow(2*r-n-e,2),-.5)},cdf:function(r,n,e){return r<n?0:r<e?2/f.PI*f.asin(f.sqrt((r-n)/(e-n))):1},inv:function(i,r,n){return r+(.5-.5*f.cos(f.PI*i))*(n-r)},mean:function(r,n){return n<=r?NaN:(r+n)/2},median:function(r,n){return n<=r?NaN:(r+n)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(r,n){return(r+n)/2+(n-r)/2*f.sin(2*f.PI*u.uniform.sample(0,1))},variance:function(r,n){return n<=r?NaN:f.pow(n-r,2)/8}});function d(i){return i/f.abs(i)}u.extend(u.laplace,{pdf:function(r,n,e){return e<=0?0:f.exp(-f.abs(r-n)/e)/(2*e)},cdf:function(r,n,e){return e<=0?0:r<n?.5*f.exp((r-n)/e):1-.5*f.exp(-(r-n)/e)},mean:function(i){return i},median:function(i){return i},mode:function(i){return i},variance:function(i,r){return 2*r*r},sample:function(r,n){var e=u._random_fn()-.5;return r-n*d(e)*f.log(1-2*f.abs(e))}});function w(i,r,n){var e=12,o=6,s=-30,v=-50,l=60,a=8,m=3,t=2,c=3,g=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],y=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],_=i*.5;if(_>=a)return 1;var q=2*u.normal.cdf(_,0,1,1,0)-1;q>=f.exp(v/n)?q=f.pow(q,n):q=0;var h;i>m?h=t:h=c;for(var k=_,E=(a-_)/h,I=k+E,z=0,P=n-1,T=1;T<=h;T++){for(var A=0,N=.5*(I+k),Q=.5*(I-k),O=1;O<=e;O++){var V,G;o<O?(V=e-O+1,G=g[V-1]):(V=O,G=-g[V-1]);var U=Q*G,L=N+U,W=L*L;if(W>l)break;var H=2*u.normal.cdf(L,0,1,1,0),K=2*u.normal.cdf(L,i,1,1,0),C=H*.5-K*.5;C>=f.exp(s/P)&&(C=y[V-1]*f.exp(-(.5*W))*f.pow(C,P),A+=C)}A*=2*Q*n/f.sqrt(2*f.PI),z+=A,k=I,I+=E}return q+=z,q<=f.exp(s/r)?0:(q=f.pow(q,r),q>=1?1:q)}function p(i,r,n){var e=.322232421088,o=.099348462606,s=-1,v=.588581570495,l=-.342242088547,a=.531103462366,m=-.204231210125,t=.10353775285,c=-453642210148e-16,g=.0038560700634,y=.8832,_=.2368,q=1.214,h=1.208,k=1.4142,E=120,I=.5-.5*i,z=f.sqrt(f.log(1/(I*I))),P=z+((((z*c+m)*z+l)*z+s)*z+e)/((((z*g+t)*z+a)*z+v)*z+o);n<E&&(P+=(P*P*P+P)/n/4);var T=y-_*P;return n<E&&(T+=-q/n+h*P/n),P*(T*f.log(r-1)+k)}u.extend(u.tukey,{cdf:function(r,n,e){var o=1,s=n,v=16,l=8,a=-30,m=1e-14,t=100,c=800,g=5e3,y=25e3,_=1,q=.5,h=.25,k=.125,E=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],I=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(r<=0)return 0;if(e<2||o<1||s<2)return NaN;if(!Number.isFinite(r))return 1;if(e>y)return w(r,o,s);var z=e*.5,P=z*f.log(e)-e*f.log(2)-u.gammaln(z),T=z-1,A=e*.25,N;e<=t?N=_:e<=c?N=q:e<=g?N=h:N=k,P+=f.log(N);for(var Q=0,O=1;O<=50;O++){for(var V=0,G=(2*O-1)*N,U=1;U<=v;U++){var L,W;l<U?(L=U-l-1,W=P+T*f.log(G+E[L]*N)-(E[L]*N+G)*A):(L=U-1,W=P+T*f.log(G-E[L]*N)+(E[L]*N-G)*A);var H;if(W>=a){l<U?H=r*f.sqrt((E[L]*N+G)*.5):H=r*f.sqrt((-(E[L]*N)+G)*.5);var K=w(H,o,s),C=K*I[L]*f.exp(W);V+=C}}if(O*N>=1&&V<=m)break;Q+=V}if(V>m)throw new Error("tukey.cdf failed to converge");return Q>1&&(Q=1),Q},inv:function(i,r,n){var e=1,o=r,s=1e-4,v=50;if(n<2||e<1||o<2)return NaN;if(i<0||i>1)return NaN;if(i===0)return 0;if(i===1)return 1/0;var l=p(i,o,n),a=u.tukey.cdf(l,r,n)-i,m;a>0?m=f.max(0,l-1):m=l+1;for(var t=u.tukey.cdf(m,r,n)-i,c,g=1;g<v;g++){c=m-t*(m-l)/(t-a),a=t,l=m,c<0&&(c=0,t=-i),t=u.tukey.cdf(c,r,n)-i,m=c;var y=f.abs(m-l);if(y<s)return c}throw new Error("tukey.inv failed to converge")}})}(R,Math),function(u,f){var b=Array.prototype.push,d=u.utils.isArray;function w(p){return d(p)||p instanceof u}u.extend({add:function(i,r){return w(r)?(w(r[0])||(r=[r]),u.map(i,function(n,e,o){return n+r[e][o]})):u.map(i,function(n){return n+r})},subtract:function(i,r){return w(r)?(w(r[0])||(r=[r]),u.map(i,function(n,e,o){return n-r[e][o]||0})):u.map(i,function(n){return n-r})},divide:function(i,r){return w(r)?(w(r[0])||(r=[r]),u.multiply(i,u.inv(r))):u.map(i,function(n){return n/r})},multiply:function(i,r){var n,e,o,s,v,l,a,m;if(i.length===void 0&&r.length===void 0)return i*r;if(v=i.length,l=i[0].length,a=u.zeros(v,o=w(r)?r[0].length:l),m=0,w(r)){for(;m<o;m++)for(n=0;n<v;n++){for(s=0,e=0;e<l;e++)s+=i[n][e]*r[e][m];a[n][m]=s}return v===1&&m===1?a[0][0]:a}return u.map(i,function(t){return t*r})},outer:function(i,r){return u.multiply(i.map(function(n){return[n]}),[r])},dot:function(i,r){w(i[0])||(i=[i]),w(r[0])||(r=[r]);for(var n=i[0].length===1&&i.length!==1?u.transpose(i):i,e=r[0].length===1&&r.length!==1?u.transpose(r):r,o=[],s=0,v=n.length,l=n[0].length,a,m;s<v;s++){for(o[s]=[],a=0,m=0;m<l;m++)a+=n[s][m]*e[s][m];o[s]=a}return o.length===1?o[0]:o},pow:function(i,r){return u.map(i,function(n){return f.pow(n,r)})},exp:function(i){return u.map(i,function(r){return f.exp(r)})},log:function(i){return u.map(i,function(r){return f.log(r)})},abs:function(i){return u.map(i,function(r){return f.abs(r)})},norm:function(i,r){var n=0,e=0;for(isNaN(r)&&(r=2),w(i[0])&&(i=i[0]);e<i.length;e++)n+=f.pow(f.abs(i[e]),r);return f.pow(n,1/r)},angle:function(i,r){return f.acos(u.dot(i,r)/(u.norm(i)*u.norm(r)))},aug:function(i,r){var n=[],e;for(e=0;e<i.length;e++)n.push(i[e].slice());for(e=0;e<n.length;e++)b.apply(n[e],r[e]);return n},inv:function(i){for(var r=i.length,n=i[0].length,e=u.identity(r,n),o=u.gauss_jordan(i,e),s=[],v=0,l;v<r;v++)for(s[v]=[],l=n;l<o[0].length;l++)s[v][l-n]=o[v][l];return s},det:function p(i){if(i.length===2)return i[0][0]*i[1][1]-i[0][1]*i[1][0];for(var r=0,n=0;n<i.length;n++){for(var e=[],o=1;o<i.length;o++){e[o-1]=[];for(var s=0;s<i.length;s++)s<n?e[o-1][s]=i[o][s]:s>n&&(e[o-1][s-1]=i[o][s])}var v=n%2?-1:1;r+=p(e)*i[0][n]*v}return r},gauss_elimination:function(i,r){var n=0,e=0,o=i.length,s=i[0].length,v=1,l=0,a=[],m,t,c,g;for(i=u.aug(i,r),m=i[0].length,n=0;n<o;n++){for(t=i[n][n],e=n,g=n+1;g<s;g++)t<f.abs(i[g][n])&&(t=i[g][n],e=g);if(e!=n)for(g=0;g<m;g++)c=i[n][g],i[n][g]=i[e][g],i[e][g]=c;for(e=n+1;e<o;e++)for(v=i[e][n]/i[n][n],g=n;g<m;g++)i[e][g]=i[e][g]-v*i[n][g]}for(n=o-1;n>=0;n--){for(l=0,e=n+1;e<=o-1;e++)l=l+a[e]*i[n][e];a[n]=(i[n][m-1]-l)/i[n][n]}return a},gauss_jordan:function(i,r){var n=u.aug(i,r),e=n.length,o=n[0].length,s=0,v,l,a;for(l=0;l<e;l++){var m=l;for(a=l+1;a<e;a++)f.abs(n[a][l])>f.abs(n[m][l])&&(m=a);var t=n[l];for(n[l]=n[m],n[m]=t,a=l+1;a<e;a++)for(s=n[a][l]/n[l][l],v=l;v<o;v++)n[a][v]-=n[l][v]*s}for(l=e-1;l>=0;l--){for(s=n[l][l],a=0;a<l;a++)for(v=o-1;v>l-1;v--)n[a][v]-=n[l][v]*n[a][l]/s;for(n[l][l]/=s,v=e;v<o;v++)n[l][v]/=s}return n},triaUpSolve:function(i,r){var n=i[0].length,e=u.zeros(1,n)[0],o,s=!1;return r[0].length!=null&&(r=r.map(function(v){return v[0]}),s=!0),u.arange(n-1,-1,-1).forEach(function(v){o=u.arange(v+1,n).map(function(l){return e[l]*i[v][l]}),e[v]=(r[v]-u.sum(o))/i[v][v]}),s?e.map(function(v){return[v]}):e},triaLowSolve:function(i,r){var n=i[0].length,e=u.zeros(1,n)[0],o,s=!1;return r[0].length!=null&&(r=r.map(function(v){return v[0]}),s=!0),u.arange(n).forEach(function(v){o=u.arange(v).map(function(l){return i[v][l]*e[l]}),e[v]=(r[v]-u.sum(o))/i[v][v]}),s?e.map(function(v){return[v]}):e},lu:function(i){var r=i.length,n=u.identity(r),e=u.zeros(i.length,i[0].length),o;return u.arange(r).forEach(function(s){e[0][s]=i[0][s]}),u.arange(1,r).forEach(function(s){u.arange(s).forEach(function(v){o=u.arange(v).map(function(l){return n[s][l]*e[l][v]}),n[s][v]=(i[s][v]-u.sum(o))/e[v][v]}),u.arange(s,r).forEach(function(v){o=u.arange(s).map(function(l){return n[s][l]*e[l][v]}),e[s][v]=i[o.length][v]-u.sum(o)})}),[n,e]},cholesky:function(i){var r=i.length,n=u.zeros(i.length,i[0].length),e;return u.arange(r).forEach(function(o){e=u.arange(o).map(function(s){return f.pow(n[o][s],2)}),n[o][o]=f.sqrt(i[o][o]-u.sum(e)),u.arange(o+1,r).forEach(function(s){e=u.arange(o).map(function(v){return n[o][v]*n[s][v]}),n[s][o]=(i[o][s]-u.sum(e))/n[o][o]})}),n},gauss_jacobi:function(i,r,n,e){for(var o=0,s=0,v=i.length,l=[],a=[],m=[],t,c,g,y;o<v;o++)for(l[o]=[],a[o]=[],m[o]=[],s=0;s<v;s++)o>s?(l[o][s]=i[o][s],a[o][s]=m[o][s]=0):o<s?(a[o][s]=i[o][s],l[o][s]=m[o][s]=0):(m[o][s]=i[o][s],l[o][s]=a[o][s]=0);for(g=u.multiply(u.multiply(u.inv(m),u.add(l,a)),-1),c=u.multiply(u.inv(m),r),t=n,y=u.add(u.multiply(g,n),c),o=2;f.abs(u.norm(u.subtract(y,t)))>e;)t=y,y=u.add(u.multiply(g,t),c),o++;return y},gauss_seidel:function(i,r,n,e){for(var o=0,s=i.length,v=[],l=[],a=[],m,t,c,g,y;o<s;o++)for(v[o]=[],l[o]=[],a[o]=[],m=0;m<s;m++)o>m?(v[o][m]=i[o][m],l[o][m]=a[o][m]=0):o<m?(l[o][m]=i[o][m],v[o][m]=a[o][m]=0):(a[o][m]=i[o][m],v[o][m]=l[o][m]=0);for(g=u.multiply(u.multiply(u.inv(u.add(a,v)),l),-1),c=u.multiply(u.inv(u.add(a,v)),r),t=n,y=u.add(u.multiply(g,n),c),o=2;f.abs(u.norm(u.subtract(y,t)))>e;)t=y,y=u.add(u.multiply(g,t),c),o=o+1;return y},SOR:function(i,r,n,e,o){for(var s=0,v=i.length,l=[],a=[],m=[],t,c,g,y,_;s<v;s++)for(l[s]=[],a[s]=[],m[s]=[],t=0;t<v;t++)s>t?(l[s][t]=i[s][t],a[s][t]=m[s][t]=0):s<t?(a[s][t]=i[s][t],l[s][t]=m[s][t]=0):(m[s][t]=i[s][t],l[s][t]=a[s][t]=0);for(y=u.multiply(u.inv(u.add(m,u.multiply(l,o))),u.subtract(u.multiply(m,1-o),u.multiply(a,o))),g=u.multiply(u.multiply(u.inv(u.add(m,u.multiply(l,o))),r),o),c=n,_=u.add(u.multiply(y,n),g),s=2;f.abs(u.norm(u.subtract(_,c)))>e;)c=_,_=u.add(u.multiply(y,c),g),s++;return _},householder:function(i){for(var r=i.length,n=i[0].length,e=0,o=[],s=[],v,l,a,m,t;e<r-1;e++){for(v=0,m=e+1;m<n;m++)v+=i[m][e]*i[m][e];for(t=i[e+1][e]>0?-1:1,v=t*f.sqrt(v),l=f.sqrt((v*v-i[e+1][e]*v)/2),o=u.zeros(r,1),o[e+1][0]=(i[e+1][e]-v)/(2*l),a=e+2;a<r;a++)o[a][0]=i[a][e]/(2*l);s=u.subtract(u.identity(r,n),u.multiply(u.multiply(o,u.transpose(o)),2)),i=u.multiply(s,u.multiply(i,s))}return i},QR:function(){var p=u.sum,i=u.arange;function r(n){var e=n.length,o=n[0].length,s=u.zeros(o,o);n=u.copy(n);var v,l,a;for(l=0;l<o;l++){for(s[l][l]=f.sqrt(p(i(e).map(function(m){return n[m][l]*n[m][l]}))),v=0;v<e;v++)n[v][l]=n[v][l]/s[l][l];for(a=l+1;a<o;a++)for(s[l][a]=p(i(e).map(function(m){return n[m][l]*n[m][a]})),v=0;v<e;v++)n[v][a]=n[v][a]-n[v][l]*s[l][a]}return[n,s]}return r}(),lstsq:function(){function p(r){r=u.copy(r);var n=r.length,e=u.identity(n);return u.arange(n-1,-1,-1).forEach(function(o){u.sliceAssign(e,{row:o},u.divide(u.slice(e,{row:o}),r[o][o])),u.sliceAssign(r,{row:o},u.divide(u.slice(r,{row:o}),r[o][o])),u.arange(o).forEach(function(s){var v=u.multiply(r[s][o],-1),l=u.slice(r,{row:s}),a=u.multiply(u.slice(r,{row:o}),v);u.sliceAssign(r,{row:s},u.add(l,a));var m=u.slice(e,{row:s}),t=u.multiply(u.slice(e,{row:o}),v);u.sliceAssign(e,{row:s},u.add(m,t))})}),e}function i(r,n){var e=!1;n[0].length===void 0&&(n=n.map(function(y){return[y]}),e=!0);var o=u.QR(r),s=o[0],v=o[1],l=r[0].length,a=u.slice(s,{col:{end:l}}),m=u.slice(v,{row:{end:l}}),t=p(m),c=u.transpose(a);c[0].length===void 0&&(c=[c]);var g=u.multiply(u.multiply(t,c),n);return g.length===void 0&&(g=[[g]]),e?g.map(function(y){return y[0]}):g}return i}(),jacobi:function(i){for(var r=1,n=i.length,e=u.identity(n,n),o=[],s,v,l,a,m,t,c,g;r===1;){for(t=i[0][1],a=0,m=1,v=0;v<n;v++)for(l=0;l<n;l++)v!=l&&t<f.abs(i[v][l])&&(t=f.abs(i[v][l]),a=v,m=l);for(i[a][a]===i[m][m]?c=i[a][m]>0?f.PI/4:-f.PI/4:c=f.atan(2*i[a][m]/(i[a][a]-i[m][m]))/2,g=u.identity(n,n),g[a][a]=f.cos(c),g[a][m]=-f.sin(c),g[m][a]=f.sin(c),g[m][m]=f.cos(c),e=u.multiply(e,g),s=u.multiply(u.multiply(u.inv(g),i),g),i=s,r=0,v=1;v<n;v++)for(l=1;l<n;l++)v!=l&&f.abs(i[v][l])>.001&&(r=1)}for(v=0;v<n;v++)o.push(i[v][v]);return[e,o]},rungekutta:function(i,r,n,e,o,s){var v,l,a,m,t;if(s===2)for(;e<=n;)v=r*i(e,o),l=r*i(e+r,o+v),a=o+(v+l)/2,o=a,e=e+r;if(s===4)for(;e<=n;)v=r*i(e,o),l=r*i(e+r/2,o+v/2),m=r*i(e+r/2,o+l/2),t=r*i(e+r,o+m),a=o+(v+2*l+2*m+t)/6,o=a,e=e+r;return o},romberg:function(i,r,n,e){for(var o=0,s=(n-r)/2,v=[],l=[],a=[],m,t,c,g,y;o<e/2;){for(y=i(r),c=r,g=0;c<=n;c=c+s,g++)v[g]=c;for(m=v.length,c=1;c<m-1;c++)y+=(c%2!==0?4:2)*i(v[c]);y=s/3*(y+i(n)),a[o]=y,s/=2,o++}for(t=a.length,m=1;t!==1;){for(c=0;c<t-1;c++)l[c]=(f.pow(4,m)*a[c+1]-a[c])/(f.pow(4,m)-1);t=l.length,a=l,l=[],m++}return a},richardson:function(i,r,n,e){function o(_,q){for(var h=0,k=_.length,E;h<k;h++)_[h]===q&&(E=h);return E}for(var s=f.abs(n-i[o(i,n)+1]),v=0,l=[],a=[],m,t,c,g,y;e>=s;)m=o(i,n+e),t=o(i,n),l[v]=(r[m]-2*r[t]+r[2*t-m])/(e*e),e/=2,v++;for(g=l.length,c=1;g!=1;){for(y=0;y<g-1;y++)a[y]=(f.pow(4,c)*l[y+1]-l[y])/(f.pow(4,c)-1);g=a.length,l=a,a=[],c++}return l},simpson:function(i,r,n,e){for(var o=(n-r)/e,s=i(r),v=[],l=r,a=0,m=1,t;l<=n;l=l+o,a++)v[a]=l;for(t=v.length;m<t-1;m++)s+=(m%2!==0?4:2)*i(v[m]);return o/3*(s+i(n))},hermite:function(i,r,n,e){for(var o=i.length,s=0,v=0,l=[],a=[],m=[],t=[],c;v<o;v++){for(l[v]=1,c=0;c<o;c++)v!=c&&(l[v]*=(e-i[c])/(i[v]-i[c]));for(a[v]=0,c=0;c<o;c++)v!=c&&(a[v]+=1/(i[v]-i[c]));m[v]=(1-2*(e-i[v])*a[v])*(l[v]*l[v]),t[v]=(e-i[v])*(l[v]*l[v]),s+=m[v]*r[v]+t[v]*n[v]}return s},lagrange:function(i,r,n){for(var e=0,o=0,s,v,l=i.length;o<l;o++){for(v=r[o],s=0;s<l;s++)o!=s&&(v*=(n-i[s])/(i[o]-i[s]));e+=v}return e},cubic_spline:function(i,r,n){for(var e=i.length,o=0,s,v=[],l=[],a=[],m=[],t=[],c=[],g=[];o<e-1;o++)t[o]=i[o+1]-i[o];for(a[0]=0,o=1;o<e-1;o++)a[o]=3/t[o]*(r[o+1]-r[o])-3/t[o-1]*(r[o]-r[o-1]);for(o=1;o<e-1;o++)v[o]=[],l[o]=[],v[o][o-1]=t[o-1],v[o][o]=2*(t[o-1]+t[o]),v[o][o+1]=t[o],l[o][0]=a[o];for(m=u.multiply(u.inv(v),l),s=0;s<e-1;s++)c[s]=(r[s+1]-r[s])/t[s]-t[s]*(m[s+1][0]+2*m[s][0])/3,g[s]=(m[s+1][0]-m[s][0])/(3*t[s]);for(s=0;s<e&&!(i[s]>n);s++);return s-=1,r[s]+(n-i[s])*c[s]+u.sq(n-i[s])*m[s]+(n-i[s])*u.sq(n-i[s])*g[s]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(i){var r=i.length,n=i[0].length,e=0,o,s,v=[],l=[],a=[],m=[],t=[],c=[],g=[],y=[],_=[],q=[];for(e=0;e<r;e++)v[e]=u.sum(i[e])/n;for(e=0;e<n;e++)for(g[e]=[],o=0;o<r;o++)g[e][o]=i[o][e]-v[o];for(g=u.transpose(g),e=0;e<r;e++)for(y[e]=[],o=0;o<r;o++)y[e][o]=u.dot([g[e]],[g[o]])/(n-1);for(a=u.jacobi(y),_=a[0],l=a[1],q=u.transpose(_),e=0;e<l.length;e++)for(o=e;o<l.length;o++)l[e]<l[o]&&(s=l[e],l[e]=l[o],l[o]=s,m=q[e],q[e]=q[o],q[o]=m);for(c=u.transpose(g),e=0;e<r;e++)for(t[e]=[],o=0;o<c.length;o++)t[e][o]=u.dot([q[e]],[c[o]]);return[i,l,q,t]}}),function(p){for(var i=0;i<p.length;i++)(function(r){u.fn[r]=function(n,e){var o=this;return e?(setTimeout(function(){e.call(o,u.fn[r].call(o,n))},15),this):typeof u[r](this,n)=="number"?u[r](this,n):u(u[r](this,n))}})(p[i])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(R,Math),function(u,f){var b=[].slice,d=u.utils.isNumber,w=u.utils.isArray;u.extend({zscore:function(){var r=b.call(arguments);return d(r[1])?(r[0]-r[1])/r[2]:(r[0]-u.mean(r[1]))/u.stdev(r[1],r[2])},ztest:function(){var r=b.call(arguments),n;return w(r[1])?(n=u.zscore(r[0],r[1],r[3]),r[2]===1?u.normal.cdf(-f.abs(n),0,1):u.normal.cdf(-f.abs(n),0,1)*2):r.length>2?(n=u.zscore(r[0],r[1],r[2]),r[3]===1?u.normal.cdf(-f.abs(n),0,1):u.normal.cdf(-f.abs(n),0,1)*2):(n=r[0],r[1]===1?u.normal.cdf(-f.abs(n),0,1):u.normal.cdf(-f.abs(n),0,1)*2)}}),u.extend(u.fn,{zscore:function(r,n){return(r-this.mean())/this.stdev(n)},ztest:function(r,n,e){var o=f.abs(this.zscore(r,e));return n===1?u.normal.cdf(-o,0,1):u.normal.cdf(-o,0,1)*2}}),u.extend({tscore:function(){var r=b.call(arguments);return r.length===4?(r[0]-r[1])/(r[2]/f.sqrt(r[3])):(r[0]-u.mean(r[1]))/(u.stdev(r[1],!0)/f.sqrt(r[1].length))},ttest:function(){var r=b.call(arguments),n;return r.length===5?(n=f.abs(u.tscore(r[0],r[1],r[2],r[3])),r[4]===1?u.studentt.cdf(-n,r[3]-1):u.studentt.cdf(-n,r[3]-1)*2):d(r[1])?(n=f.abs(r[0]),r[2]==1?u.studentt.cdf(-n,r[1]-1):u.studentt.cdf(-n,r[1]-1)*2):(n=f.abs(u.tscore(r[0],r[1])),r[2]==1?u.studentt.cdf(-n,r[1].length-1):u.studentt.cdf(-n,r[1].length-1)*2)}}),u.extend(u.fn,{tscore:function(r){return(r-this.mean())/(this.stdev(!0)/f.sqrt(this.cols()))},ttest:function(r,n){return n===1?1-u.studentt.cdf(f.abs(this.tscore(r)),this.cols()-1):u.studentt.cdf(-f.abs(this.tscore(r)),this.cols()-1)*2}}),u.extend({anovafscore:function(){var r=b.call(arguments),n,e,o,s,v,l,a,m;if(r.length===1){for(v=new Array(r[0].length),a=0;a<r[0].length;a++)v[a]=r[0][a];r=v}for(e=new Array,a=0;a<r.length;a++)e=e.concat(r[a]);for(o=u.mean(e),n=0,a=0;a<r.length;a++)n=n+r[a].length*f.pow(u.mean(r[a])-o,2);for(n/=r.length-1,l=0,a=0;a<r.length;a++)for(s=u.mean(r[a]),m=0;m<r[a].length;m++)l+=f.pow(r[a][m]-s,2);return l/=e.length-r.length,n/l},anovaftest:function(){var r=b.call(arguments),n,e,o,s;if(d(r[0]))return 1-u.centralF.cdf(r[0],r[1],r[2]);var v=u.anovafscore(r);for(n=r.length-1,o=0,s=0;s<r.length;s++)o=o+r[s].length;return e=o-n-1,1-u.centralF.cdf(v,n,e)},ftest:function(r,n,e){return 1-u.centralF.cdf(r,n,e)}}),u.extend(u.fn,{anovafscore:function(){return u.anovafscore(this.toArray())},anovaftes:function(){var r=0,n;for(n=0;n<this.length;n++)r=r+this[n].length;return u.ftest(this.anovafscore(),this.length-1,r-this.length)}}),u.extend({qscore:function(){var r=b.call(arguments),n,e,o,s,v;return d(r[0])?(n=r[0],e=r[1],o=r[2],s=r[3],v=r[4]):(n=u.mean(r[0]),e=u.mean(r[1]),o=r[0].length,s=r[1].length,v=r[2]),f.abs(n-e)/(v*f.sqrt((1/o+1/s)/2))},qtest:function(){var r=b.call(arguments),n;r.length===3?(n=r[0],r=r.slice(1)):r.length===7?(n=u.qscore(r[0],r[1],r[2],r[3],r[4]),r=r.slice(5)):(n=u.qscore(r[0],r[1],r[2]),r=r.slice(3));var e=r[0],o=r[1];return 1-u.tukey.cdf(n,o,e-o)},tukeyhsd:function(r){for(var n=u.pooledstdev(r),e=r.map(function(m){return u.mean(m)}),o=r.reduce(function(m,t){return m+t.length},0),s=[],v=0;v<r.length;++v)for(var l=v+1;l<r.length;++l){var a=u.qtest(e[v],e[l],r[v].length,r[l].length,n,o,r.length);s.push([[v,l],a])}return s}}),u.extend({normalci:function(){var r=b.call(arguments),n=new Array(2),e;return r.length===4?e=f.abs(u.normal.inv(r[1]/2,0,1)*r[2]/f.sqrt(r[3])):e=f.abs(u.normal.inv(r[1]/2,0,1)*u.stdev(r[2])/f.sqrt(r[2].length)),n[0]=r[0]-e,n[1]=r[0]+e,n},tci:function(){var r=b.call(arguments),n=new Array(2),e;return r.length===4?e=f.abs(u.studentt.inv(r[1]/2,r[3]-1)*r[2]/f.sqrt(r[3])):e=f.abs(u.studentt.inv(r[1]/2,r[2].length-1)*u.stdev(r[2],!0)/f.sqrt(r[2].length)),n[0]=r[0]-e,n[1]=r[0]+e,n},significant:function(r,n){return r<n}}),u.extend(u.fn,{normalci:function(r,n){return u.normalci(r,n,this.toArray())},tci:function(r,n){return u.tci(r,n,this.toArray())}});function p(i,r,n,e){if(i>1||n>1||i<=0||n<=0)throw new Error("Proportions should be greater than 0 and less than 1");var o=(i*r+n*e)/(r+e),s=f.sqrt(o*(1-o)*(1/r+1/e));return(i-n)/s}u.extend(u.fn,{oneSidedDifferenceOfProportions:function(r,n,e,o){var s=p(r,n,e,o);return u.ztest(s,1)},twoSidedDifferenceOfProportions:function(r,n,e,o){var s=p(r,n,e,o);return u.ztest(s,2)}})}(R,Math),R.models=function(){function u(p){var i=p[0].length,r=R.arange(i).map(function(n){var e=R.arange(i).filter(function(o){return o!==n});return f(R.col(p,n).map(function(o){return o[0]}),R.col(p,e))});return r}function f(p,i){var r=p.length,n=i[0].length-1,e=r-n-1,o=R.lstsq(i,p),s=R.multiply(i,o.map(function(g){return[g]})).map(function(g){return g[0]}),v=R.subtract(p,s),l=R.mean(p),a=R.sum(s.map(function(g){return Math.pow(g-l,2)})),m=R.sum(p.map(function(g,y){return Math.pow(g-s[y],2)})),t=a+m,c=a/t;return{exog:i,endog:p,nobs:r,df_model:n,df_resid:e,coef:o,predict:s,resid:v,ybar:l,SST:t,SSE:a,SSR:m,R2:c}}function b(p){var i=u(p.exog),r=Math.sqrt(p.SSR/p.df_resid),n=i.map(function(l){var a=l.SST,m=l.R2;return r/Math.sqrt(a*(1-m))}),e=p.coef.map(function(l,a){return(l-0)/n[a]}),o=e.map(function(l){var a=R.studentt.cdf(l,p.df_resid);return(a>.5?1-a:a)*2}),s=R.studentt.inv(.975,p.df_resid),v=p.coef.map(function(l,a){var m=s*n[a];return[l-m,l+m]});return{se:n,t:e,p:o,sigmaHat:r,interval95:v}}function d(p){var i=p.R2/p.df_model/((1-p.R2)/p.df_resid),r=function(e,o,s){return R.beta.cdf(e/(s/o+e),o/2,s/2)},n=1-r(i,p.df_model,p.df_resid);return{F_statistic:i,pvalue:n}}function w(p,i){var r=f(p,i),n=b(r),e=d(r),o=1-(1-r.R2)*((r.nobs-1)/r.df_resid);return r.t=n,r.f=e,r.adjust_R2=o,r}return{ols:w}}(),R.extend({buildxmatrix:function(){for(var f=new Array(arguments.length),b=0;b<arguments.length;b++){var d=[1];f[b]=d.concat(arguments[b])}return R(f)},builddxmatrix:function(){for(var f=new Array(arguments[0].length),b=0;b<arguments[0].length;b++){var d=[1];f[b]=d.concat(arguments[0][b])}return R(f)},buildjxmatrix:function(f){for(var b=new Array(f.length),d=0;d<f.length;d++)b[d]=f[d];return R.builddxmatrix(b)},buildymatrix:function(f){return R(f).transpose()},buildjymatrix:function(f){return f.transpose()},matrixmult:function(f,b){var d,w,p,i,r;if(f.cols()==b.rows()){if(b.rows()>1){for(i=[],d=0;d<f.rows();d++)for(i[d]=[],w=0;w<b.cols();w++){for(r=0,p=0;p<f.cols();p++)r+=f.toArray()[d][p]*b.toArray()[p][w];i[d][w]=r}return R(i)}for(i=[],d=0;d<f.rows();d++)for(i[d]=[],w=0;w<b.cols();w++){for(r=0,p=0;p<f.cols();p++)r+=f.toArray()[d][p]*b.toArray()[w];i[d][w]=r}return R(i)}},regress:function(f,b){var d=R.xtranspxinv(f),w=f.transpose(),p=R.matrixmult(R(d),w);return R.matrixmult(p,b)},regresst:function(f,b,d){var w=R.regress(f,b),p={};p.anova={};var i=R.jMatYBar(f,w);p.yBar=i;var r=b.mean();p.anova.residuals=R.residuals(b,i),p.anova.ssr=R.ssr(i,r),p.anova.msr=p.anova.ssr/(f[0].length-1),p.anova.sse=R.sse(b,i),p.anova.mse=p.anova.sse/(b.length-(f[0].length-1)-1),p.anova.sst=R.sst(b,r),p.anova.mst=p.anova.sst/(b.length-1),p.anova.r2=1-p.anova.sse/p.anova.sst,p.anova.r2<0&&(p.anova.r2=0),p.anova.fratio=p.anova.msr/p.anova.mse,p.anova.pvalue=R.anovaftest(p.anova.fratio,f[0].length-1,b.length-(f[0].length-1)-1),p.anova.rmse=Math.sqrt(p.anova.mse),p.anova.r2adj=1-p.anova.mse/p.anova.mst,p.anova.r2adj<0&&(p.anova.r2adj=0),p.stats=new Array(f[0].length);for(var n=R.xtranspxinv(f),e,o,s,v=0;v<w.length;v++)e=Math.sqrt(p.anova.mse*Math.abs(n[v][v])),o=Math.abs(w[v]/e),s=R.ttest(o,b.length-f[0].length-1,d),p.stats[v]=[w[v],e,o,s];return p.regress=w,p},xtranspx:function(f){return R.matrixmult(f.transpose(),f)},xtranspxinv:function(f){var b=R.matrixmult(f.transpose(),f),d=R.inv(b);return d},jMatYBar:function(f,b){var d=R.matrixmult(f,b);return new R(d)},residuals:function(f,b){return R.matrixsubtract(f,b)},ssr:function(f,b){for(var d=0,w=0;w<f.length;w++)d+=Math.pow(f[w]-b,2);return d},sse:function(f,b){for(var d=0,w=0;w<f.length;w++)d+=Math.pow(f[w]-b[w],2);return d},sst:function(f,b){for(var d=0,w=0;w<f.length;w++)d+=Math.pow(f[w]-b,2);return d},matrixsubtract:function(f,b){for(var d=new Array(f.length),w=0;w<f.length;w++){d[w]=new Array(f[w].length);for(var p=0;p<f[w].length;p++)d[w][p]=f[w][p]-b[w][p]}return R(d)}}),R.jStat=R,R})}}]);
