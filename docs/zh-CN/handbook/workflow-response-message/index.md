# 响应消息

<PluginInfo name="workflow-response-message" link="/handbook/workflow-response-message" commercial="true"></PluginInfo>

响应消息节点用于在特定类型的流程中向提交操作的客户端反馈流程中自定义的消息。

:::info{title=提示}
目前支持在同步模式的“操作前事件”和“自定义操作事件”类型的工作流中使用。
:::

## 使用手册

### 创建节点

在支持的工作流类型中，可以在流程中的任意位置中添加“响应消息”节点，点击流程中的加号（“+”）按钮，添加“响应消息”节点：

![添加节点](https://static-docs.nocobase.com/eac2b3565e95e4ce59f340624062ed3d.png)

响应消息会在整个请求过程中以数组的形式存在，在流程中执行到任意响应消息节点时均会将新的消息内容追加至数组中，在服务端发送响应内容时，会将所有消息一并发送至客户端。

### 节点配置

消息内容整体是一个模板字符串，其中可以插入变量，在节点配置中可以任意组织该模板内容：

![节点配置](https://static-docs.nocobase.com/d5fa5f4002d50baf3ba16048818fddfc.png)

在流程执行到该节点时，会对模板进行解析，并生成出消息内容的结果，上面的配置中，变量“局域变量 / 循环所有产品 / 循环对象 / 产品 / 标题”会在实际流程中被替换为特定的值，例如：

```
产品 “iPhone 14 pro” 的库存不足
```

![消息内容](https://static-docs.nocobase.com/06bd4a6b6ec499c853f0c39987f63a6a.png)

### 流程配置

响应消息的状态提示根据该流程执行的成功或失败状态而定，任意节点的执行失败都会导致整个流程的失败，此时消息内容会以失败状态返回到客户端并提示。

如需要在流程中主动定义失败状态，可以在流程中使用“结束节点”，并配置为失败状态，则执行到该节点时会以失败状态退出流程，并将消息以失败状态返回到客户端。

如果整个流程未产生失败状态，并成功执行至结束，消息内容会以成功状态返回到客户端。

:::info{title=提示}
如在流程中定义了多个响应消息节点，执行过的节点会将消息内容追加至数组中，最终返回给客户端时会将所有消息内容会一并返回并提示。
:::

### 使用场景

#### “操作前事件”流程

“操作前事件”流程中使用响应消息可以在流程结束后向客户端发送对应的消息反馈，具体参考[操作前事件](../workflow/triggers/pre-action.md)。

#### “自定义操作事件”流程

在同步模式的“自定义操作事件”中使用响应消息可以在流程结束后向客户端发送对应的消息反馈，具体参考[自定义操作事件](../workflow/triggers/custom-action.md)。
