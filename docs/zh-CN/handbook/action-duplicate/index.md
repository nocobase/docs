# 复制

<PluginInfo name="action-duplicate"></PluginInfo>

## 介绍

复制操作允许用户基于已存在的数据创建新的数据记录。支持两种复制方式：直接复制和复制到表单并继续填写。

## 安装

内置插件，无需单独安装

## 复制模式

### 直接复制

![](https://static-docs.nocobase.com/2c0ac5d1a539de4b72b49b7d966d8c09.png)

- 默认以直接复制的方式复制数据；
- 目标数据表：是指复制添加的目标数据表（在继承的场景下，可以复制给子表，直接复制只能复制添加到本表）；
- 模版字段：用于指定要复制的字段，可全选，必填；

完成配置后点击按钮即复制数据。

### 复制到表单并继续填写

配置的模板字段将作为将默认值填充到表单中，可修改后提交完成复制操作。

可以设置本表或子表为复制添加的目标表（继承场景）。

![](https://static-docs.nocobase.com/a072aa572fd0a0fe643eadf95471da2a.png)

配置模板字段：模板字段将作为默认值填充到表单中，只会带出有勾选的字段值。

![](https://static-docs.nocobase.com/8032fa2025180ade275da55b97774b4d.png)

「运单」（o2m）是复制的关系，调整其字段组件为子表单，并配置子表单中的字段。

![](https://static-docs.nocobase.com/b13c9287bae8601646727a2e78b81be7.png)

#### 同步表单字段

- 将当前表单区块中已配置的字段自动解析作为模板字段；
- 在后续修改了表单区块字段（如关系字段组件调整），可再次打开模板配置并点击同步表单按钮，确保表单与模板的一致性；

![](https://static-docs.nocobase.com/156b6d8d741521e63d12e49092414d58.png)

模板数据将作为表单默认值填充，可修改数据并提交完成数据复制。

![](https://static-docs.nocobase.com/1c0a0ae0c59971f48b2282a68831d44b.png)

如下图完整示例为订单列表配置复制操作。

![](https://static-docs.nocobase.com/fa8a89abf0ba136df04b6d0d838eae4e.gif)

### 补充说明

#### 复制、引用、预加载的说明

对于不同字段（不同关系类型）有不同的处理逻辑（复制、引用、预加载），其中调整关系字段的字段组件中也会影响处理逻辑（Select 和 Record pikcer 用于处理引用关系，Sub-form 和 Sub-table 用于处理复制关系）。

- 复制

  - 普通字段是复制；
  - hasOne 和 hasMany 的关系字段只能是复制（即该类型的关系字段不能用 Select、Record picker 作为字段组件，应使用 Sub-form、Sub-table 等）；
    - hasOne 和 hasMany 字段组件的变更不会改变处理逻辑（复制）；
    - 复制的关系字段，所有的子字段都可以被选择；

- 引用

  - belongsTo 和 belongsToMany 是引用；
  - **引用是可能变成复制的，比如字段组件从 select 调整为 sub-form 后，关系就从引用变成了复制（变成复制之后，所有的子字段都是可选的）**；

- 预加载：引用字段里的关系字段。

  - 引用的关系字段下的关系字段为预加载；
  - 预加载的关系字段在字段组件变更后可能变成引用或者复制；

#### 全选

- 所有的复制字段和引用字段都勾选上。

#### 被选为数据模板的记录会过滤掉以下字段的数据：
- 如果是复制的关系数据主键会过滤掉，引用和预加载不过滤主键字段
- 外键
- 不允许重复的字段
- 排序字段
- 自动编码字段
- 密码
- 创建人
- 创建日期
- 最后更新人
- 最后更新日期

#### 同步表单字段

- 将当前表单区块中已配置的字段自动解析作为模板字段；
- 在后续修改了表单区块字段（如关系字段组件调整），需再次打开模板配置并点击同步表单按钮，确保表单与模板的一致性；