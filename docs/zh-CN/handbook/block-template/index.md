# 区块模板

<PluginInfo name="block-template"></PluginInfo>
<style>
.markdown h5 {
    font-size: 15px;
}
</style>

## 介绍

区块模板用于为区块提供模板能力, 可用于模板的集中管理及通过模板创建区块。

## 安装

内置插件, 无需安装。

## 使用说明

![主界面](https://static-docs.nocobase.com/main-screen-block-template.png)

### 选择模板类型

NocoBase 提供了两种类型的模板:继承模板和引用模板。其区别及应用场景如下:
- **引用模板**：类似于 UI Schema 的片段。使用时可以选择引用或复制两种方式。
  - **引用**：区块与模板保持完全一致，修改区块实例会同步修改原模板。适用于需要严格保持多处内容/结构完全一致的场景。
  - **复制**：将模板的当前配置完整复制一份到目标位置，之后与原模板脱离关系，不再同步更新。适用于快速创建区块，或基于模板起点进行完全独立修改的场景。
- **继承模板**：创建的区块与模板保持继承关系。区块可以基于模板进行个性化配置，同时未修改的部分能够继续同步模板的更新。适用于需要统一基础配置，但允许局部差异化的场景。

### 引用模板

引用模板是一种通用的模板形式，类似于 UI Schema 的片段。它可以将数据区块（包括弹窗中的区块和第三方已适配的区块）保存为模板，并在需要的地方通过“引用”或“复制”的方式使用。

#### 创建引用模板

选中需要保存为引用模板的数据区块，点击“保存为引用模板”按钮，即可创建引用模板。

![保存为引用模板](https://static-docs.nocobase.com/save-as-block-template.png)

#### 使用引用模板

引用模板提供两种使用方式，您可以根据实际场景选择最适合的方法：

1. **引用模板方式**

在页面中创建区块时，选择对应的引用模板，即可使用引用模板创建区块。

![创建区块](https://static-docs.nocobase.com/create-block.png)

2. **复制模板方式**

在页面中创建区块时，选择对应的引用模板，即可使用引用模板创建区块。

![创建区块](https://static-docs.nocobase.com/create-block.png)

### 继承模板

继承模板主要用于数据区块，创建的区块实例会继承模板的配置，并能在此基础上进行扩展或覆盖。未被实例覆盖的配置会随模板更新而同步。

#### 创建继承模板

继承模板提供两种创建方式，您可以根据实际场景选择最适合的方法：

1. **在区块模板管理界面创建**

**适用场景**：
- 需要从零开始规划新模板

**操作步骤**：
1. 进入区块模板管理界面
2. 点击"新增"按钮
3. 输入模板基本信息
4. 点击"提交"完成创建
5. 配置模板内容

![创建模板](https://static-docs.nocobase.com/create-template.png)

2. **从现有区块创建**

**适用场景**：
- 已在页面中配置好了理想的区块
- 需要将现有区块的配置复用到其他地方
- 希望快速创建继承模板而无需重新配置

**操作步骤**：
1. 在页面中找到需要保存为继承模板的数据区块
2. 选择"保存为继承模板"选项
3. 输入模板名称并保存

![保存为继承模板](https://static-docs.nocobase.com/save-as-block-template.png)

:::info{title=注意}
- 仅支持页面中的数据区块保存为继承模板
- 不支持将弹窗中区块直接保存为继承模板
- 图表区块暂不支持配置为继承模板
:::

#### 配置继承模板

选择继承模板, 点击 "配置" 按钮, 即可进入继承模板配置界面, 配置继承模板数据区块。

![配置继承模板](https://static-docs.nocobase.com/configure-template.png)

:::info{title=注意}
- 目前继承模板仅支持添加一个数据区块, 未配置数据区块时, 将无法使用该继承模板创建区块。
- 图表区块暂不支持配置为继承模板。
:::

#### 编辑继承模板

选择继承模板, 点击 "编辑" 按钮, 即可进入继承模板编辑界面修改继承模板标题、描述。

![编辑继承模板](https://static-docs.nocobase.com/edit-template.png)

#### 复制继承模板

选择继承模板, 点击 "复制" 按钮, 输入新继承模板标题, 点击 "提交" 按钮, 即可复制继承模板。
继承模板复制后可以进行编辑以适应新的需求场景。

![复制继承模板](https://static-docs.nocobase.com/copy-template.png)

#### 删除继承模板

选择继承模板, 点击 "删除" 按钮, 点击 "提交" 按钮, 即可删除继承模板。

![删除继承模板](https://static-docs.nocobase.com/delete-template.png)

删除继承模板可以选择是否"保留已创建的区块":
- 若选择保留, 则继承模板被删除后, 已创建的区块会被转换成普通的页面区块。
- 若选择不保留, 则继承模板被删除后, 已创建的区块也会被删除。

#### 使用继承模板

在页面中创建区块时, 选择对应继承模板的模板, 即可使用继承模板创建区块。

![创建区块](https://static-docs.nocobase.com/create-block.png)

从继承模板创建的区块与普通区块有以下几点不同:
1. 该区块与继承模板是继承关系, 可以在继承模板基础上增加自己的配置, 未修改的配置会与继承模板保持同步。
2. 继承自继承模板的 UI 组件无法从页面中删除。
![无法删除](https://static-docs.nocobase.com/disable-delete.png)

3. 区块新增的字段、操作会以不同的背景色展示, 以便区分。
![区块样式](https://static-docs.nocobase.com/template-bg.png)

4. 区块及继承自继承模板的 UI 组件均会多一个 "恢复到模板" 的配置项, 用于恢复到继承模板完全一致的状态。
![恢复到模板](https://static-docs.nocobase.com/revert-to-template.gif)

:::info{title=注意}
区块内部的 UI 组件的位置以页面为准, 创建后不能自动同步继承模板中的位置, 若需要同步继承模板中的位置, 只能将整个区块恢复到继承模板。
:::

## 常见问题

**Q: 如何创建编辑表单继承模板？**

A: 编辑表单继承模板与新增表单继承模板的配置是相同的，可以通过配置新增表单区块来创建表单继承模板，表单继承模板创建后会自动出现在编辑表单的继承模板选项中。

**Q: 继承模板中的字段位置为什么没有同步到使用该继承模板的区块？**

A: 区块内部的 UI 组件位置以页面为准，不会自动同步继承模板中的位置变化。如需同步，需要使用"恢复到模板"功能，注意恢复到模板后，会丢失当前区块的自定义配置。

**Q: 如何处理不再需要的继承模板？**

A: 建议删除，删除继承模板时，可选择是否保留已创建的区块。如果选择保留，已创建的区块会转换为普通区块，此时并不会影响已有业务。如果选择不保留，通过该继承模板创建的区块也会被删除。

**Q: 继承模板为何不能配置图表区块？**

A: 后续版本会支持图表区块的继承模板配置。

**Q: 弹窗中的区块为何没有保存为继承模板菜单？**

A: 当前继承模板是基于页面中的区块创建的，页面中的区块上下文相对独立。弹窗中的区块上下文会依赖非当前弹窗的区块，暂时不支持保存弹窗中的区块为继承模板。
