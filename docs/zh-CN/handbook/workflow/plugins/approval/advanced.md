# 深入理解

## 提交审批的数据快照

审批中的数据遵循事务数据不变性的原则，每次提交都将生成一份快照，在审批过程中流转。具体如下流程：

![审批数据快照流程示意](https://static-docs.nocobase.com/62a545a85d9e72c6b47e4b52707c4380.png)

在流程中产生“撤回”和“退回”行为后，在同一个申请单据中已进行过的流程中，都将保存当次的数据快照：

![审批数据快照_流程示例](https://static-docs.nocobase.com/62800d88772c88f1eaa11f6f493aea55.png)

如上图所属，每次撤回并重新申请提交的数据都会保存在当次的流程中。

## 审批处理的状态

对于发起人，提交的审批申请在单据数据中会有一个状态字段，用于标识当前审批的状态，通常有以下几种状态：

| 状态 | 说明 |
| --- | --- |
| 草稿 | 申请人仅将申请表单中的数据暂时保存，还未正式提交启动流程。 |
| 已提交 | 申请已提交，等待审批人处理。此时还未经任何审批人提交处理结果，如果配置了可撤回，则发起人可以进行撤回操作。 |
| 处理中 | 经过任意一个审批节点，且至少有一个审批人提交了该节点审批处理的结果。此时发起人将不再能撤回。 |
| 已退回 | 申请被任意一个审批人处理为退回，发起人可以再次修改后重新提交。 |
| 已通过 | 流程经过的所有审批节点都被审批人处理为通过，流程结束。 |
| 已拒绝 | 流程经过的任意审批节点中被审批人处理为拒绝，流程结束。 |

对于每个审批节点，会对节点配置的审批人生成对应的处理记录，每个审批人的处理记录中也包含一个状态字段，用于标识当前审批人的处理状态，通常有以下几种状态：

| 状态 | 说明 |
| --- | --- |
| 已分配 | 对应审批人的处理记录已创建，但由于处理规则配置为串行处理，当前记录的审批人需要等待前一个审批人处理完成后再处理。 |
| 待处理 | 等待当前审批人处理。 |
| 已退回 | 当前审批人处理为退回。 |
| 已通过 | 当前审批人处理为通过。 |
| 已拒绝 | 当前审批人处理为拒绝。 |
| 未处理 | 根据节点配置的处理规则，由其他审批人处理后已达到节点处理的终态，或者该工作流已失效，无需当前审批人再处理。 |
