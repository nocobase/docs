# 概要

## 内蔵エンジン

現在、NocoBaseが内蔵しているエンジンの種類は以下の通りです：

- [ローカルストレージ](./local.md)
- [Alibaba Cloud OSS](./aliyun-oss.md)
- [Amazon S3](./amazon-s3.md)
- [Tencent Cloud COS](./tencent-cos.md)

ローカルストレージエンジンは、システムのインストール時に自動的に追加され、直接使用することができます。また、新しいエンジンを追加したり、既存のエンジンパラメータを編集することも可能です。

## エンジン共通パラメータ

異なるエンジンタイプの特有パラメータに加えて、以下は共通パラメータ（ローカルストレージを例とします）です：

![ファイルストレージエンジン設定例](https://static-docs.nocobase.com/20240529115151.png)

### タイトル

ストレージエンジンの名称で、人間が識別するために使用します。

### システム名

ストレージエンジンのシステム名で、システムが識別するために使用します。システム全体で唯一でなければならず、未入力の場合はシステムが自動的にランダム生成します。

### アクセスURL基礎

外部からアクセス可能なURLアドレスの前部分で、CDNのアクセスURL基礎として使用できます。例：“`https://cdn.nocobase.com/app`”（末尾の“`/`”は不要です）。

### パス

ファイルを保存する際に使用する相対パスで、アクセス時にはこの部分が最終的なURLに自動的に追加されます。例：“`user/avatar`”（先頭と末尾の“`/`”は不要です）。

### ファイルサイズ制限

このストレージエンジンに対するアップロードファイルのサイズ制限です。設定サイズを超えるファイルはアップロードできません。システムのデフォルト制限は20MBで、最大1GBに調整可能です。

### ファイルタイプ

アップロードするファイルのタイプを制限できます。 [MIME](https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types) 形式で記述します。例：`image/*`は画像ファイルを表します。複数のタイプはカンマで区切ります。例：`image/*, application/pdf`は画像タイプとPDFタイプのファイルを許可します。

### デフォルトストレージエンジン

チェックすると、システムのデフォルトストレージエンジンに設定されます。添付フィールドやファイルコレクションでストレージエンジンが指定されていない場合、アップロードされたファイルはすべてデフォルトストレージエンジンに保存されます。デフォルトストレージエンジンは削除できません。

### 削除記録時ファイルを保持

このオプションを選択すると、添付テーブルまたはファイルテーブルのデータレコードを削除しても、ストレージエンジンにアップロードされたファイルは引き続き保持されます。このオプションはデフォルトではオフになっており、レコードを削除すると、ストレージエンジン内のファイルも同時に削除されます。

:::info{title=ヒント}
ファイルがアップロードされた後、最終的なアクセスパスは以下の部分から構成されます：

```
<アクセスURLのベース>/<パス>/<ファイル名><拡張子>
```

例：`https://cdn.nocobase.com/app/user/avatar/20240529115151.png`。
:::

