# データのクエリ

特定のデータテーブルに対して条件を満たすデータをクエリし、データレコードを取得します。

単一のデータまたは複数のデータをクエリするように設定でき、クエリ結果は後続のノードで変数として使用可能です。複数のデータをクエリする場合、結果は配列となります。クエリ結果が空の場合は、後続のノードを実行するかどうかを選択できます。

## ノードの作成

ワークフロー設定画面で、プロセス内のプラス（「+」）ボタンをクリックして「データのクエリ」ノードを追加します：

![データのクエリ_追加](https://static-docs.nocobase.com/c1ef2b851b437806faf7a39c6ab9d33a.png)

## ノードの設定

![クエリノード_ノード設定](https://static-docs.nocobase.com/20240520131324.png)

### データテーブル

クエリ対象のデータテーブルを選択します。

### 結果タイプ

結果タイプは「単一データ」と「複数データ」の2種類に分かれます：

- **単一データ**：結果はオブジェクトで、最初の一致したレコードのみ、またはnullです。
- **複数データ**：結果は配列で、条件に一致するレコードを含み、一致するレコードがない場合は空の配列となります。この配列はループノードを使用して個別に処理できます。

### フィルタ条件

通常のデータテーブルのクエリ時のフィルタ条件に似ており、プロセスのコンテキスト変数を使用できます。

### ソート

単一または複数のデータをクエリする際には、ソートルールを使用して必要な結果を制御できます。例えば、最新の1件のデータをクエリする場合、「作成時間」フィールドを降順にソートします。

### ページング

結果セットが非常に大きくなる可能性がある場合、ページングを使用してクエリ結果の数を制御できます。例えば、最新の10件のデータをクエリする場合、「作成時間」フィールドを降順にソートし、ページングを1ページあたり10件に設定します。

### 結果が空の場合の処理

単一結果モードでは、条件に合うデータがない場合、クエリ結果は`null`になります。複数結果モードでは空の配列（`[]`）となります。「クエリ結果が空の場合は、プロセスを終了する」を選択するかどうかを必要に応じて選択できます。選択した場合、クエリ結果が空であれば後続のノードは実行されず、失敗の状態で早期に終了します。

