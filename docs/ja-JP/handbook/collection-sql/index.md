# SQL テーブル

<PluginInfo name="collection-sql"></PluginInfo>

## 概要

SQLコレクションは、SQL文を使用してデータを取得する方法を提供します。SQL文を通じてデータフィールドを取得し、フィールドのメタデータを設定した後、ユーザーは通常のテーブルのように、テーブル、グラフ、ワークフローなどで使用できます。関連クエリや統計分析などのシナリオに適しています。

## 使用マニュアル

### 新規作成

<img src="https://static-docs.nocobase.com/202405191452918.png"/>

1. SQL入力ボックスにSQL文を入力し、実行 (Execute) をクリックすると、システムは使用されたテーブルとフィールドを解析し、ソーステーブルからフィールドのメタデータを自動的に取得します。

<img src="https://static-docs.nocobase.com/202405191453556.png"/>

2. システムが自動的に分析したソーステーブルとフィールドが正しくない場合は、手動で適切なテーブルとフィールドを選択し、正しいフィールドメタデータを使用します。まずソーステーブルを選択し、その後、下のフィールドソースからそのテーブルのフィールドを選択する必要があります。

<img src="https://static-docs.nocobase.com/202405191453579.png"/>

3. フィールドに対応するソースフィールドがない場合、システムはデータ型に基づいてフィールドタイプを推測します。推測結果が正しくない場合は、手動で適切なフィールドタイプを選択できます。

<img src="https://static-docs.nocobase.com/202405191454703.png"/>

4. フィールドを設定する際に、プレビューエリアで対応する表示効果を確認することができます。

<img src="https://static-docs.nocobase.com/202405191455439.png"/>

5. 設定が完了し、問題がないことを確認したら、SQL入力ボックスの下にある確認 (Confirm) ボタンをクリックして、最終的な提出を行います。

<img src="https://static-docs.nocobase.com/202405191455302.png"/>

### 編集

1. SQL文に変更がある場合は、修正 (Edit) ボタンをクリックして直接SQL文を修正し、フィールドを再設定します。

2. フィールドのメタデータを変更する必要がある場合は、フィールドを構成 (Configure fields) し、通常のテーブルのようにフィールド関連の設定を変更できます。

### 同期

SQL文に変更がない場合でも、データベースのテーブル構造に変更があった場合は、「構成フィールド (Configure fields)」をクリックし、「データベースから同期 (Sync from database)」を選択することでフィールドを同期および構成できます。

<img src="https://static-docs.nocobase.com/202405191456216.png"/>

### SQL テーブルと接続データベースビューの比較

| テンプレートタイプ       | 適用シーン                                                                                     | 実現原理     | 増減改サポート |
|-------------------------|-----------------------------------------------------------------------------------------------|--------------|----------------|
| SQL                     | モデルが比較的単純で軽量なシーン<br />データベースとの操作が難しい<br />ビューのメンテナンスを避けたい<br />完全にUIで操作したい | SQLサブクエリ | サポートなし   |
| 接続データベースビュー | モデルが比較的複雑<br />データベースとの相互作用が必要<br />データの変更が必要<br />より良く安定したデータベースサポートが必要 | データベースビュー | 部分的にサポート |

:::warning
SQLテーブルを使用する際は、NocoBaseで管理できるデータテーブルを選択してください。同じデータベース内でNocoBaseに接続されていない他のテーブルを使用すると、SQL文の解析が不正確になる可能性があります。こうした要件がある場合は、ビューを作成して接続することを検討してください。
:::

