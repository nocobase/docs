# トリガー設定

## ワークフローの作成

ワークフローを作成する際には、タイプとして「操作後イベント」を選択します：

![ワークフロー作成_操作後イベントトリガー](https://static-docs.nocobase.com/13c87035ec1bb7332514676d3e896007.png)

## 実行モード

操作後イベントの場合、作成時に実行モードとして「同期」または「非同期」を選択できます：

![ワークフロー作成_同期または非同期の選択](https://static-docs.nocobase.com/bc83525c7e539d578f9e2e20baf9ab69.png)

ユーザーの操作後に即時実行し、結果を返す必要があるプロセスには同期モードを使用します。それ以外のシナリオでは、デフォルトで非同期モードが適しています。非同期モードでは、トリガーされた操作が即座に完了し、ワークフローはアプリケーションのバックグラウンドでキュー方式により順次実行されます。

## データテーブルの設定

ワークフローカンバスに入ったら、トリガーをクリックして設定ウィンドウを開き、まずはバインドするデータテーブルを選択します：

![ワークフロー設定_データテーブルの選択](https://static-docs.nocobase.com/35c49a91eba731127edcf76719c97634.png)

## トリガーモードの選択

次にトリガーモードを選択します。局所モードと全体モードの二種類があります：

![ワークフロー設定_トリガーモードの選択](https://static-docs.nocobase.com/317809c48b2f2a2d38aedc7d08abdadc.png)

- **局所モード**: このモードでは、バインドされた操作ボタンでのみワークフローがトリガーされます。バインドされていないボタンをクリックしてもトリガーは発動しません。このモードは特定のフォームやアクションにワークフローを調整したい場合に最適です。
- **全体モード**: このモードでは、データテーブル内に設定された全ての操作ボタンでワークフローがトリガーされ、どのフォームから来たかにかかわらず、特定のワークフローをバインドする必要はありません。

局所モードでは、現在バインド可能な操作ボタンは以下の通りです：

* 新規フォームの「提出」と「保存」ボタン。
* 更新フォームの「提出」と「保存」ボタン。
* データ行（テーブル、リスト、ボードなど）内の「データ更新」ボタン。

## 操作タイプの選択

全体モードを選択した場合、さらに操作タイプを選択する必要があります。現在サポートされているのは「データ作成操作」と「データ更新操作」です。いずれの操作も、成功した後にワークフローがトリガーされます。

## 関連データのプリロード選択

トリガーデータの関連データを後続のプロセスで使用する必要がある場合は、プリロードする必要がある関係フィールドを選択できます：

![ワークフロー設定_事前読み込み関係](https://static-docs.nocobase.com/5cded063509c7ba1d34f49bec8d68227.png)

トリガーが発動すると、プロセス内でこれらの関連データを直接利用できます。

