# 承認トリガー

## フローの作成

ワークフローを作成する際に「承認」タイプを選択することで、承認フローを作成できます：

![承認トリガー_承認フローの作成](https://static-docs.nocobase.com/f52dda854f46a669e0c1c7fb487a17ea.png)

その後、ワークフロー設定画面でトリガーをクリックし、ポップアップを開いてさらに設定を行います。

## データテーブルのバインディング

NocoBaseの承認プラグインは柔軟性のある設計に基づいており、任意のカスタムデータテーブルと連携して使用できます。つまり、承認設定はデータモデルを繰り返し設定する必要がなく、既に作成されたデータテーブルを直接再利用できます。したがって、トリガー設定に入ったら、まずデータテーブルを選択し、どのデータテーブルのデータが作成または更新されたときにこのフローがトリガーされるかを決定します：

![承認トリガー_トリガー設定_データテーブルの選択](https://static-docs.nocobase.com/8732a4419b1e28d2752b8f601132c82d.png)

次に、該当するデータテーブルのデータ作成（または編集）フォームで、そのワークフローを送信ボタンにバインドします：

![承認を開始_ワークフローのバインド](https://static-docs.nocobase.com/2872ff108c61d7bf6d0bfb19886774c6.png)

その後、ユーザーがこのフォームを送信すると、対応する承認ワークフローがトリガーされます。送信されたデータは対応するデータテーブルに保存されるだけでなく、承認フローにもスナップショットとして保存され、後の承認者が参照して使用できます。

## 承認の開始位置

ユーザーインターフェースには、承認を開始できる2つの場所があります。1つは、バインドされたデータテーブルのデータ作成（または更新）フォームを通じて開始されるもので、通常は単一の承認フローに対して使用されます。もう1つは、承認センターブロックから集中して開始できるもので、通常は集中管理のグローバルフローに関連します。

![承認トリガー_トリガー設定_承認開始位置の選択](https://static-docs.nocobase.com/1a193ec0acfa6cde221c6e5d49a50b3e.png)

「データブロックと承認センターの両方で承認を開始および承認できる」にチェックを入れると、このフローは承認センターブロックの「開始」ボタンのドロップダウンメニューに表示され、ユーザーはこの位置から異なる承認を集中して開始できます。

## 取り消し

承認フローが発起人による取り消しを許可する場合は、「取り消しを許可」のオプションにチェックを入れます：

![承認トリガー_トリガー設定_取り消しを許可](https://static-docs.nocobase.com/09185712fc55bc536892136ce0ade4a8.png)

チェックを入れると、このプロセスで発起された承認は、いかなる承認者が処理する前に発起者によって撤回可能ですが、その後の承認ノードで設定された承認者が処理した後は撤回できなくなります。

## 承認を発起するためのフォームインターフェースの設定

最後に、発起者のフォームインターフェースを設定する必要があります。このインターフェースは、承認センターのブロックから発起する際や、ユーザーが撤回した後に再度発起する際の提出操作に使用されます。設定ボタンをクリックしてポップアップを開きます：

![承認トリガー_トリガー設定_発起者フォーム](https://static-docs.nocobase.com/ca8b7e362d912138cf7d73bb60b37ac1.png)

発起者のインターフェースには、バインドされたデータテーブルに基づく入力フォームや、注意喚起やガイドとなる説明文（Markdown）を追加できます。フォームは必須であり、追加しないと発起者はこのインターフェースに入った際に操作できなくなります。

フォームブロックを追加した後は、通常のフォーム設定インターフェースと同様に、対応するデータテーブルのフィールドコンポーネントを追加でき、任意に配置してフォームに記入する必要がある内容を整理できます：

![承認トリガー_トリガー設定_発起者フォーム_フィールド設定](https://static-docs.nocobase.com/5a1e7f9c9d8de092c7b55585dad7d633.png)

直接提出するボタンとは異なり、「下書きを保存」する操作ボタンも追加でき、処理プロセスの一時保存をサポートします：

![承認トリガー_トリガー設定_発起者フォーム_操作設定](https://static-docs.nocobase.com/2f4850d2078e94538995a9df70d3d2d1.png)

