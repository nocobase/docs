# 使用マニュアル

## 管理センター

### 役割の管理

![](https://static-docs.nocobase.com/da7083c67d794e23dc6eb0f85b1de86c.png)

初期インストールされたアプリには、「Admin」と「Member」の2つの役割が組み込まれており、それぞれ異なるデフォルト権限設定を持っています。

### 役割の追加・削除・編集

役割識別子（システム唯一の識別子）は、デフォルト役割のカスタマイズを可能にしますが、システムのデフォルト役割を削除することはできません。

![](https://static-docs.nocobase.com/35f323b346db4f9f12f9bee4dea63302.png)

### デフォルト役割の設定

ここでのデフォルト役割とは、新しく作成されたユーザーに役割が割り当てられていない場合に、デフォルトでどの役割が使用されるかを指します。

![](https://static-docs.nocobase.com/f41bba7ff55ca28715c486dc45bc1708.png)

### 権限の設定

#### 一般権限設定

![](https://static-docs.nocobase.com/119a9650259f9be71210121d0d3a435d.png)

##### 権限の設定

1. インターフェースの設定を許可：この権限は、ユーザーがインターフェースを設定できるかどうかを制御します。この権限を有効にすると、UI設定ボタンが表示されます。「admin」役割はデフォルトでこの権限を有効にしています。
2. プラグインのインストール、アクティブ化、無効化を許可：この権限は、ユーザーがプラグインを有効または無効にできるかどうかを制御します。この権限を有効にすると、ユーザーはプラグイン管理画面にアクセスできます。「admin」役割はデフォルトでこの権限を有効にしています。
3. プラグインの設定を許可：この権限は、ユーザーがプラグインのパラメータを設定したり、プラグインのバックエンドデータを管理したりできるかどうかを制御します。「admin」役割はデフォルトでこの権限を有効にしています。
4. キャッシュのクリア、アプリの再起動を許可：この権限は、ユーザーのシステム運用権限を制御します。キャッシュのクリアとアプリの再起動が含まれます。これを有効にすると、関連操作ボタンが個人センターに表示されます。デフォルトでは無効になっています。
5. 新しいメニュー項目へのアクセスをデフォルトで許可：デフォルトで新しく作成されたメニューはアクセスを許可し、デフォルトで有効になっています。

##### グローバル操作権限

グローバル操作権限は全体に適用され（すべてのデータテーブル）、操作タイプに応じて分類されます。すべてのデータと自分のデータの範囲に基づいて設定をサポートします。前者は全データテーブルに対して操作を実行することを許可し、後者は自分に関連するデータのみを処理できるように制限します。

#### データテーブル操作権限

![](https://static-docs.nocobase.com/6a6e0281391cecdea5b5218e6173c5d7.png)

![](https://static-docs.nocobase.com/9814140434ff9e1bf028a6c282a5a165.png)

データテーブル操作権限は、グローバル操作権限をさらに細分化し、各データテーブルのリソースアクセスに対して個別の権限設定を行うことができます。これらの権限は二つの側面に分かれています：

1. 操作権限：操作権限には、追加、表示、編集、削除、エクスポート、インポートの操作が含まれます。これらの権限はデータ範囲に基づいて設定されます：

   - すべてのデータ：ユーザーがデータテーブル内のすべてのレコードに対して操作を実行できることを許可します。
   - 自分のデータ：ユーザーが自分が作成したデータレコードにのみ操作を実行できるように制限します。

2. フィールド権限：フィールド権限は、異なる操作において各フィールドの権限を設定することを可能にします。たとえば、特定のフィールドを表示のみ許可し、編集を許可しないように設定できます。

#### メニューアクセス権限

メニューアクセス権限は、メニューを基準としてアクセス権限を制御します。

![](https://static-docs.nocobase.com/28eddfc843d27641162d9129e3b6e33f.png)

#### プラグイン設定権限

プラグイン設定権限は、特定のプラグインパラメータの設定権限を制御するために使用されます。プラグイン設定権限がチェックされると、管理センターに対応するプラグイン管理インターフェースが表示されます。

![](https://static-docs.nocobase.com/5a742ae20a9de93dc2722468b9fd7475.png)

## 個人センター

### 役割切替

ユーザーに複数の役割を割り当てることができ、ユーザーが複数の役割を持っている場合、個人センターで役割を切り替えることができます。

![](https://static-docs.nocobase.com/e331d11ec1ca3b8b7e0472105b167819.png)

ユーザーがシステムに入る際のデフォルトの役割優先順位は：前回切り替えた役割（役割を切り替えるたびにデフォルト役割値が更新されます）> 最初の役割（システムのデフォルト役割）

## UIでの適用

### データブロックの権限

データテーブルのデータブロックが表示可能かどうかは、表示操作権限によって制御されます（個別設定の優先度はグローバルより高い）。

以下の図のように：グローバル権限の下で、adminはすべての権限を持っており、注文テーブルには個別の権限設定がされています（表示不可）。

グローバル権限設定は次の通りです：

![](https://static-docs.nocobase.com/3d026311739c7cf5fdcd03f710d09bc4.png)

注文テーブルの個別権限設定は次の通りです：

![](https://static-docs.nocobase.com/a88caba1cad47001c1610bf402a4a2c1.png)

UI上では、注文テーブルのすべてのブロックが表示されません。

完全な設定フローは以下の通りです：

![](https://static-docs.nocobase.com/b283c004ffe0b746fddbffcf4f27b1df.gif)

### フィールド権限

表示：フィールドレベルの可視性を制御します。たとえば、特定の役割が注文テーブルの特定のフィールドを表示できるかどうかを制御します。

![](https://static-docs.nocobase.com/30dea84d984d95039e6f7b180955a6cf.png)

UI上では、注文テーブルのブロック内に設定権限のあるフィールドのみが表示されます。システムフィールド（Id、CreatedAt、Last updated at）は、設定されていなくても表示権限があります。

![](https://static-docs.nocobase.com/40cc49b517efe701147fd2e799e79dcc.png)

- 編集：フィールドの編集及び保存（更新）が可能かどうかを制御します。

図のように、注文テーブルフィールドの編集権限を設定します（数量と関連商品には編集権限があります）：

![](https://static-docs.nocobase.com/6531ca4122f0887547b5719e2146ba93.png)

UI上では、注文テーブルブロックの編集操作フォームブロックに、編集権限のあるフィールドのみが表示されます。

![](https://static-docs.nocobase.com/12982450c311ec1bf87eb9dc5fb04650.png)

完全な設定フローは以下の通りです：

![](https://static-docs.nocobase.com/1dbe559a9579c2e052e194e50edc74a7.gif)

- 追加：フィールドの追加（作成）が可能かどうかを制御します。

図のように、注文テーブルフィールドの追加権限を設定します（注文番号、数量、商品、配送には追加権限があります）：

![](https://static-docs.nocobase.com/3ab1bbe41e61915e920fd257f2e0da7e.png)

UI上では、注文テーブルブロックの追加操作フォームブロックに、追加権限のあるフィールドのみが表示されます。

![](https://static-docs.nocobase.com/8d0c07893b63771c428974f9e126bf35.png)

- エクスポート：フィールドのエクスポートが可能かどうかを制御します。
- インポート：フィールドがインポートをサポートするかどうかを制御します。

### 操作権限

個別に設定された権限が最優先され、個別設定がある場合は個別設定の権限に従い、ない場合はグローバル設定の権限が適用されます。

- 追加：ブロック内に追加操作ボタンを表示するかどうかを制御します。

図のように、注文テーブルで個別に操作権限を設定し、追加を許可します：

![](https://static-docs.nocobase.com/2e3123b5dbc72ae78942481360626629.png)

UI上では、注文テーブルブロックの操作エリアに追加ボタンが表示されます。

![](https://static-docs.nocobase.com/f0458980d450544d94c73160d75ba96c.png)

- 表示

データブロックが表示されるかどうかを制御します。

図のように、グローバル権限設定は以下の通りです（表示権限なし）：

![](https://static-docs.nocobase.com/6e4a1e6ea92f50bf84959dedbf1d5683.png)

注文テーブルの個別権限設定は以下の通りです：

![](https://static-docs.nocobase.com/f2dd142a40fe19fb657071fd901b2291.png)

UI上では、他のすべてのデータテーブルのブロックは表示されず、注文テーブルのブロックのみが表示されます。

完全なサンプル設定フローは以下の通りです：

![](https://static-docs.nocobase.com/b92f0edc51a27b52e85cdeb76271b936.gif)

- 編集

ブロック内の編集操作ボタンが表示されるかどうかを制御します。

![](https://static-docs.nocobase.com/fb1c0290e2a833f1c2b415c761e54c45.gif)

データ範囲を設定することで、操作権限をさらに制御できます。

図のように、注文データテーブルでユーザーが自分のデータのみを編集できるように設定します：

![](https://static-docs.nocobase.com/b082308f62a3a9084cab78a370c14a9f.gif)

- 削除

ブロック内の削除操作ボタンの表示を制御します。

![](https://static-docs.nocobase.com/021c9e79bcc1ad221b606a9555ff5644.gif)

- エクスポート

ブロック内のエクスポート操作ボタンの表示を制御します。

- インポート

ブロック内のインポート操作ボタンの表示を制御します。

### リレーション権限

#### フィールドとしての場合

- リレーションフィールドの権限は、ソーステーブルのフィールド権限によって制御され、リレーションフィールドコンポーネント全体の表示を管理します。

図の注文テーブルにおけるリレーションフィールド「顧客」には、表示権限とインポート・エクスポート権限のみが設定されています：

![](https://static-docs.nocobase.com/d0dc797aae73feeabc436af285dd4f59.png)

UI上では、注文テーブルブロック内の追加および編集操作ブロックに「顧客」リレーションフィールドは表示されません。

完全なサンプル設定プロセスは以下の通りです：

![](https://static-docs.nocobase.com/372f8a4f414feea097c23b2ba326c0ef.gif)

- リレーションフィールドコンポーネント内（サブテーブル/サブフォームなど）のフィールド権限は、ターゲットデータテーブルの権限によって決まります。

リレーションフィールドコンポーネントがサブフォームの場合：

以下の図の注文テーブルにおけるリレーションフィールド「顧客」、注文内のリレーションフィールド「顧客」にはすべての権限があり、顧客テーブルは個別権限が読み取り専用に設定されています。

注文テーブルの個別権限設定は以下の通りで、「顧客」リレーションフィールドにはすべてのフィールド権限があります：

![](https://static-docs.nocobase.com/3a3ab9722f14a7b3a35361219d67fa40.png)

顧客テーブルの個別権限設定は以下の通りで、顧客テーブルのフィールドには表示権限のみがあります：

![](https://static-docs.nocobase.com/46704d179b931006a9a22852e6c5089e.png)

UI上では、注文テーブルブロック内の「顧客」リレーションフィールドは可視であり、サブフォームに切り替えると（サブフォーム内のフィールドは詳細に表示され、新規作成および編集操作では表示されません）。

完全なサンプル設定プロセスは以下の通りです：

![](https://static-docs.nocobase.com/932dbf6ac46e36ee357ff3e8b9ea1423.gif)

サブフォーム内のフィールド権限をさらに制御：個別フィールドが権限を持つ

図の顧客テーブルの個別フィールド権限設定（顧客名は表示不可・編集不可）：

![](https://static-docs.nocobase.com/e7b875521cbc4e28640f027f36d0413c.png)

完全なサンプル設定プロセスは以下の通りです：

![](https://static-docs.nocobase.com/7a07e68c2fe2a13f0c2cef19be489264.gif)

リレーションフィールドコンポーネントがサブテーブルの場合、状況はサブフォームと同様です：

図の注文テーブルのリレーションフィールド「配送」では、注文内のリレーションフィールド「配送」がすべての権限を持ち、配送テーブルは個別権限が読み取り専用に設定されています。

UIでは、このリレーションフィールドが表示され、サブテーブルに切り替えると（サブテーブル内のフィールドは表示操作時に可視、新規作成および編集操作時には不可視です）。

![](https://static-docs.nocobase.com/fd4b7d81cdd765db789d9c85cf9dc324.gif)

サブテーブル内のフィールド権限をさらに制御：個別フィールドが権限を持つ

![](https://static-docs.nocobase.com/51d70a624cb2b0366e421bcdc8abb7fd.gif)

#### ブロックとしての場合

- リレーションブロックは、対応するリレーションフィールドのターゲットテーブルの権限によって制御され、リレーションフィールドの権限とは無関係です。

図の「顧客」リレーションブロックが表示されるかどうかは、顧客テーブルの権限によって制御されます：

![](https://static-docs.nocobase.com/633ebb301767430b740ecfce11df47b3.gif)

- リレーションブロック内のフィールドは、ターゲットテーブルのフィールド権限によって制御されます。

図は、顧客テーブルが個別フィールドに表示権限を設定していることを示しています：

![](https://static-docs.nocobase.com/35af9426c20911323b17f67f81bac8fc.gif)

## ロール共用

ロール共用は権限管理モードです。システム設定に基づき、システム開発者は独立ロール、ロール共用を許可、またはロール共用のみを選択して、異なる権限要件を満たすことができます。

![20250312184651](https://static-docs.nocobase.com/20250312184651.png)

### 独立ロール

システムデフォルトは独立ロールです：ロール共用を使用せず、ユーザーは保有するロールを個別に切り替える必要があります。

![20250312184729](https://static-docs.nocobase.com/20250312184729.png)
![20250312184826](https://static-docs.nocobase.com/20250312184826.png)

### ロール共用を許可

システム開発者がロール共用を使用することを許可し、ユーザーが保有するすべてのロールの権限を同時に使用できるようにすると同時に、ユーザーが個別にロールを切り替えることも許可します。

![20250312185006](https://static-docs.nocobase.com/20250312185006.png)

### ロール共用のみ

ユーザーはロール共用のみを使用することが強制され、個別にロールを切り替えることはできません。

![20250312185105](https://static-docs.nocobase.com/20250312185105.png)

### ロール共用のルール

共用はすべてのロールの最大権限を持たせます。以下では、ロールが同じ項目に対して異なる設定をしている場合、どのように権限を判定するかを説明します。

#### 操作権限の統合

例：ロール1（role1）はインターフェースの設定を許可、ロール2（role2）はプラグインのインストール、有効化、無効化を許可に設定

![20250312190133](https://static-docs.nocobase.com/20250312190133.png)

![20250312190352](https://static-docs.nocobase.com/20250312190352.png)

**すべての権限**ロールでログインすると、両方の権限を同時に持つことになります。

![20250312190621](https://static-docs.nocobase.com/20250312190621.png)

#### データ範囲の統合

##### データ行

シナリオ1：複数のロールが同じフィールドに条件を設定

ロールA、条件設定：Age < 30

| UserID | Name | Age |
| ------ | ---- | --- |
| 1      | Jack | 23  |
| 2      | Lily | 29  |

ロールB、条件設定：Age > 25

| UserID | Name | Age |
| ------ | ---- | --- |
| 2      | Lily | 29  |
| 3      | Sam  | 32  |

統合後：

| UserID | Name | Age |
| ------ | ---- | --- |
| 1      | Jack | 23  |
| 2      | Lily | 29  |
| 3      | Sam  | 32  |

シナリオ2：異なるロールが異なるフィールドを条件として設定

ロールA、条件設定：Age < 30

| UserID | Name | Age |
| ------ | ---- | --- |
| 1      | Jack | 23  |
| 2      | Lily | 29  |

ロールB、条件設定：Nameに"Ja"を含む

| UserID | Name   | Age |
| ------ | ------ | --- |
| 1      | Jack   | 23  |
| 3      | Jasmin | 27  |

統合後：

| UserID | Name   | Age |
| ------ | ------ | --- |
| 1      | Jack   | 23  |
| 2      | Lily   | 29  |
| 3      | Jasmin | 27  |

##### データ列

ロールA、表示可能フィールド設定：Name、Age

| UserID | Name | Age |
| ------ | ---- | --- |
| 1      | Jack | 23  |
| 2      | Lily | 29  |

ロールB、表示可能フィールド設定：Name、Sex

| UserID | Name | Sex   |
| ------ | ---- | ----- |
| 1      | Jack | Man   |
| 2      | Lily | Woman |

統合後：

| UserID | Name | Age | Sex   |
| ------ | ---- | --- | ----- |
| 1      | Jack | 23  | Man   |
| 2      | Lily | 29  | Woman |

##### 行列混合

ロールA、条件がAge < 30、表示可能フィールドがName、Age

| UserID | Name | Age |
| ------ | ---- | --- |
| 1      | Jack | 23  |
| 2      | Lily | 29  |

ロールB、条件がNameに"Ja"を含む、表示可能フィールドがName、Sex

| UserID | Name  | Sex   |
| ------ | ----- | ----- |
| 3      | Jade  | Woman |
| 4      | James | Man   |

統合後：

| UserID | Name  | Age                                      | Sex                                        |
| ------ | ----- | ---------------------------------------- | ------------------------------------------ |
| 1      | Jack  | 23                                       | <span style="background-color:#FFDDDD">Man</span>   |
| 2      | Lily  | 29                                       | <span style="background-color:#FFDDDD">Woman</span> |
| 3      | Jade  | <span style="background-color:#FFDDDD">27</span> | Woman                             |
| 4      | James | <span style="background-color:#FFDDDD">31</span> | Man                               |

**説明：マークされた部分のデータは、異なるロールでは表示されませんが、統合ロールでは表示されます**

##### まとめ

ロール統合のデータ範囲ルール：
1. 行と行の間では、条件のいずれかを満たせば権限があります
2. 列と列の間では、フィールドが加算されます
3. 行列が同時に設定されている場合、行と行、列と列をそれぞれ統合し、（行+列）と（行+列）の組み合わせ統合ではありません