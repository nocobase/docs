# 概要

## 日付時間フィールドタイプ

日付時間フィールドタイプには以下の種類があります：

- **日付時間（タイムゾーンあり）** - 日付時間は統一してUTC（協定世界時）に変換され、必要に応じてタイムゾーン変換が行われます。
- **日付時間（タイムゾーンなし）** - タイムゾーン情報を含まない日付と時間を保存します。
- **日付（時間なし）** - 日付のみを保存し、時間部分は含みません。
- **時間** - 時間のみを保存し、日付部分は含みません。
- **Unix タイムスタンプ** - Unix タイムスタンプとして保存され、通常は1970年1月1日からの経過秒数です。

各日付関連フィールドタイプの例：

| **フィールドタイプ**         | **例値**                  | **説明**                                   |
|---------------------------|---------------------------|--------------------------------------------|
| 日付時間（タイムゾーンあり）    | 2024-08-24T07:30:00.000Z   | 日付時間は統一してUTCに変換されます。            |
| 日付時間（タイムゾーンなし）  | 2024-08-24 15:30:00        | タイムゾーンなしの日付時間、日付と時間のみを記録します。 |
| 日付（時間なし）            | 2024-08-24                 | 日付情報のみを保存し、時間を含みません。          |
| 時間                        | 15:30:00                   | 時間情報のみを保存し、日付を含みません。          |
| Unix タイムスタンプ         | 1724437800                 | UTC時間1970年1月1日00:00:00から経過した秒数です。      |

## 各データソースの対照

NocoBase、MySQL、およびPostgreSQLの対照表：

| **フィールドタイプ**       | **NocoBase**               | **MySQL**          | **PostgreSQL**                |
|------------------|-----------------------------|--------------------|-------------------------------|
| 日時（タイムゾーン含む）   | Datetime with timezone      | TIMESTAMP<br/> DATETIME | TIMESTAMP WITH TIME ZONE      |
| 日時（タイムゾーンなし）   | Datetime without timezone      | DATETIME           | TIMESTAMP WITHOUT TIME ZONE   |
| 日付（時間なし）          | Date                      | DATE                 | DATE                          |
| 時間                      | Time                     | TIME                 | TIME WITHOUT TIME ZONE        |
| Unix タイムスタンプ       | Unix timestamp       | INTEGER<br/>BIGINT   | INTEGER<br/>BIGINT              |
| 時間（タイムゾーン含む）   | -                         | -                  | TIME WITH TIME ZONE           |

備考：
- MySQLのTIMESTAMPデータ範囲はUTC時間 `1970-01-01 00:00:01` から `2038-01-19 03:14:07` までです。この範囲を超える場合は、DATETIMEまたはBIGINTでUnixタイムスタンプを保存することをお勧めします。

## 日時ストレージの処理フロー

### タイムゾーンを含む

`タイムゾーンなし日時` と `Unixタイムスタンプ` を含む

![20240824191933](https://static-docs.nocobase.com/20240824191933.png)

備考：
- より広範なデータ範囲をサポートするために、NocoBaseの日付時間（タイムゾーンを含む）フィールドはMySQLデータベースでDATETIMEを使用しており、保存される日付値はサーバー側のTZ環境変数に基づいて変換された値です。TZ環境変数が変更されると、日付時間の保存値が変化する可能性があります。
- UTC時間とローカル時間にはタイムゾーンの差があり、UTCの原始値を直接表示するとユーザーに誤解を与える可能性があります。

### タイムゾーンなし

![20240824185600](https://static-docs.nocobase.com/20240824185600.png)

## UTC

UTC（協定世界時、Coordinated Universal Time）は、世界の時間標準であり、世界中の時間を調整および統一するために使用されます。これは原子時計に基づく高精度の時間標準であり、地球の自転の時間と同期しています。

UTC時間とローカル時間にはタイムゾーンの差があり、UTCの原始値を直接表示するとユーザーに誤解を与える可能性があります。例えば：

| **タイムゾーン**       | **日時**                      |
|----------------|----------------------------------|
| UTC            | 2024-08-24T07:30:00.000Z          |
| 東八区 (UTC+8) | 2024-08-24 15:30:00               |
| 東五区 (UTC+5) | 2024-08-24 12:30:00               |
| 西五区 (UTC-5) | 2024-08-24 02:30:00               |
| 英国時間 (UTC+0) | 2024-08-24 07:30:00              |
| 中部時間 (UTC-6) | 2024-08-23 01:30:00              |

以上は同じ時間を示していますが、タイムゾーンが異なります。

