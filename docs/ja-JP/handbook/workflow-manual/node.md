# 人工ノード

## ノードの作成

ワークフロー設定画面で、プロセス内のプラス（“+”）ボタンをクリックして「人工処理」ノードを追加します：

![人工ノードの作成](https://static-docs.nocobase.com/4dd259f1aceeaf9b825abb4b257df909.png)

## ノードの設定

### 担当者

人工ノードには、待機タスクの実行者としてユーザーを指定する必要があります。待機タスクのリストは、ページにブロックを追加する際に設定できます。各ノードのタスクポップアップの内容は、ノード内でインターフェースを設定する必要があります。

ユーザーを選択するか、変数を使用してコンテキスト内のユーザーデータの主キーまたは外部キーを選択します。

![人工ノード_設定_担当者_変数の選択](https://static-docs.nocobase.com/22fbca3b8e21fda3a831019037001445.png)

:::info{title=ヒント}
現在、人工ノードの担当者オプションは複数人の処理には対応しておらず、今後のバージョンでのサポートを予定しています。
:::

### ユーザーインターフェースの設定

待機タスクのインターフェース設定は人工ノードの核心部分であり、「ユーザーインターフェースを設定」ボタンをクリックすることで独立した設定ポップアップが開き、通常のページと同様にWYSIWYGで設定できます：

![人工ノード_ノード設定_インターフェース設定](https://static-docs.nocobase.com/fd360168c879743cf22d57440cd2590f.png)

#### タブ

タブは異なる内容を区別するために使用でき、例えば一つのタブは承認されたフォームの提出、別のタブは拒否されたフォームの提出、または関連データの詳細を表示するために自由に設定できます。

#### ブロック

サポートされているブロックタイプは主にデータブロックとフォームブロックの2種類で、Markdownは主にヒント情報などの静的コンテンツに使用されます。

##### データブロック

データブロックはトリガーデータまたは任意のノード処理結果を選択でき、待機担当者に関連するコンテキスト情報を提供します。例えば、ワークフローがフォームイベントによってトリガーされる場合、トリガーデータの詳細ブロックを作成でき、通常のページの詳細設定と同様にトリガーデータ内の任意のフィールドを選んでデータを表示できます：

![人工ノード_ノード設定_インターフェース設定_データブロック_トリガー](https://static-docs.nocobase.com/675c3e58a1a4f45db310a72c2d0a404c.png)

ノードデータブロックも同様に、上流ノードのデータ結果を詳細表示として選択できます。例えば、上流の計算ノードの結果を担当者の待機タスクのコンテキスト参考情報として表示します。

![人工ノード_ノード設定_インターフェース設定_データブロック_ノードデータ](https://static-docs.nocobase.com/a583e26e508e954b47e5ddff80d998c4.png)

:::info{title=ヒント}
設定インターフェースでは、ワークフローが未実行の状態にあるため、データブロックには具体的な表示がありません。ワークフローがトリガーされて実行された後に、タスクポップアップインターフェースで具体的なプロセスの関連データを確認できます。
:::

##### フォームブロック

タスクインターフェースでは、ワークフローが続行されるかどうかの最終的な判断処理として、少なくとも1つのフォームブロックを設定する必要があります。フォームが設定されていない場合、プロセスが中断され、その後続行できなくなります。フォームブロックには3種類があり、それぞれ次の通りです：

- カスタムフォーム
- 新規データフォーム
- データ更新フォーム

![人工ノード_ノード設定_インターフェース設定_フォームタイプ](https://static-docs.nocobase.com/2d068f3012ab07e32a265405492104a8.png)

新規データフォームおよびデータ更新フォームでは、基づくデータテーブルを選択する必要があります。タスクユーザーが提出すると、フォーム内の値を使用して特定のデータテーブルのデータを新規追加または更新します。カスタムフォームはデータテーブルに依存しない一時的なフォームを自由に定義でき、タスクユーザーが提出した後のフィールド値は、後続のノードで使用可能です。

フォームの提出ボタンは3種類のタイプを設定できます。それぞれは次の通りです：

- 提出後にプロセスを続行
- 提出後にプロセスを終了
- フォーム値を一時保存のみ

![人工ノード_ノード設定_インターフェース設定_フォームボタン](https://static-docs.nocobase.com/6b45995b14152e85a821dff6f6e3189a.png)

これらの3つのボタンは、プロセス処理中の3つのノード状態を表します。提出後、そのノードの状態は「完了」、「拒否」、または「待機」に変更されます。1つのフォームには少なくとも前者の2つのいずれかを設定し、全体のプロセスの後続処理の流れを決定します。

「プロセスを続行」ボタンでは、フォームフィールドの値を設定することができます：

![人工ノード_ノード設定_インターフェース設定_フォームボタン_フォーム値設定](https://static-docs.nocobase.com/2cec2d4e2957f068877e616dec3b56dd.png)

![人工ノード_ノード設定_インターフェース設定_フォームボタン_フォーム値設定ポップアップ](https://static-docs.nocobase.com/5ff51b60c76cdb76e6f1cc95dc3d8640.png)

ポップアップウィンドウを開くと、フォームの任意のフィールドに値を設定できます。フォームを提出すると、その値がフィールドの最終値として使用されます。この機能は、データを審査する際に特に便利です。フォーム内には複数の異なる「プロセスを続行」ボタンがあり、各ボタンが同様の状態のフィールドに異なる列挙値を設定することができます。これにより、後続のプロセスを実行しながら異なるデータ値を使用する効果が得られます。

