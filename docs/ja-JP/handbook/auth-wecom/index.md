# 認証：企業微信

<PluginInfo commercial="true" name="auth-wecom"></PluginInfo>

## 概要

認証：企業微信プラグインは、ユーザーが企業微信アカウントを使用してNocoBaseにログインすることをサポートします。

## プラグインの有効化

![](https://static-docs.nocobase.com/202406272056962.png)

## 企業微信自作アプリの作成と設定

企業微信管理バックエンドにアクセスし、企業微信自作アプリを作成します。

![](https://static-docs.nocobase.com/202406272101321.png)

![](https://static-docs.nocobase.com/202406272102087.png)

アプリをクリックして詳細ページに入り、ページをスクロールして「企業微信認可ログイン」をクリックします。

![](https://static-docs.nocobase.com/202406272104655.png)

認可コールバックドメインをNocoBaseアプリのドメイン名に設定します。

![](https://static-docs.nocobase.com/202406272105662.png)

アプリの詳細ページに戻り、「ウェブページ認可およびJS-SDK」をクリックします。

![](https://static-docs.nocobase.com/202406272107063.png)

アプリのOAuth2.0ウェブ認可機能のコールバックドメインとして設定し、検証を行います。

![](https://static-docs.nocobase.com/202406272107899.png)

アプリの詳細ページで「企業信頼IP」をクリックします。

![](https://static-docs.nocobase.com/202406272108834.png)

NocoBaseアプリのIPを設定します。

![](https://static-docs.nocobase.com/202406272109805.png)

## 企業微信管理バックエンドからのキーの取得

企業微信管理バックエンドの「私の企業」から「企業ID」をコピーします。

![](https://static-docs.nocobase.com/202406272111637.png)

企業微信管理バックエンドの「アプリ管理」に移動し、前のステップで作成したアプリの詳細ページに進み、AgentIdとSecretをコピーします。

![](https://static-docs.nocobase.com/202406272122322.png)

## NocoBaseに企業微信認証を追加

ユーザー認証プラグイン管理ページに移動します。

![](https://static-docs.nocobase.com/202406272115044.png)

「追加 - 企業微信」を選択します。

![](https://static-docs.nocobase.com/202406272115805.png)

### 設定

![](https://static-docs.nocobase.com/202406272116978.png)

- 電話番号が既存のユーザーと一致しない場合、新しいユーザーを自動的に作成しますか？ - 既存のユーザーが電話番号で見つからない場合に新しいユーザーを自動的に作成するかどうかを設定します。
- 会社ID、AgentIdおよびSecret - 前のステップでコピーしたキー情報を入力します。
- ワークベンチアプリケーションのホームページリンク - ワークベンチアプリケーションのホームページリンクをコピーし、次のステップに進みます。

## 企業微信アプリのホームページ設定

企業微信管理者バックエンドにアクセスし、コピーしたワークベンチアプリケーションのホームページリンクを対応するアプリのホームページアドレス欄に記入します。

![](https://static-docs.nocobase.com/202406272123631.png)

![](https://static-docs.nocobase.com/202406272123048.png)

## ログイン

ログインページにアクセスし、ログインフォームの下にあるボタンをクリックして第三者ログインを開始します。

![](https://static-docs.nocobase.com/202406272124608.png)

:::warning
企業微信は電話番号などの敏感情報に対する権限制限があるため、企業微信クライアント内でのみ認証を完了できます。企業微信で初めてログインする場合は、以下の手順に従って企業微信クライアント内で初回ログイン認証を完了してください。
:::

## 初回ログイン

企業微信クライアントからワークベンチに入り、下にスクロールして最下部に到達したら、「アプリ」をクリックして、事前に記入したアプリのホームページにアクセスします。これにより、初回認証ログインが完了します。その後、NocoBaseアプリ内で企業微信にログインできるようになります。

<img src="https://static-docs.nocobase.com/202406272131113.png" width="400" />

