# BaseAuth

## Обзор

`BaseAuth` наследуется от абстрактного класса [Auth](./auth.md) и служит базовой реализацией типов аутентификации пользователей, используя JWT в качестве метода аутентификации. В большинстве случаев расширение типов аутентификации можно реализовать путём наследования от `BaseAuth`, а не прямого наследования от абстрактного класса `Auth`.

```ts
class BasicAuth extends BaseAuth {
  constructor(config: AuthConfig) {
    // Устанавливаем коллекцию пользователей
    const userCollection = config.ctx.db.getCollection('users');
    super({ ...config, userCollection });
  }

  // Логика аутентификации пользователя, вызывается через `auth.signIn`
  // Возвращает данные пользователя
  async validate() {
    const ctx = this.ctx;
    const { values } = ctx.action.params;
    // ...
    return user;
  }
}
```

## Методы класса

### `constructor()`

Конструктор, создающий экземпляр `BaseAuth`.

#### Сигнатура

- `constructor(config: AuthConfig & { userCollection: Collection })`

#### Подробности

| Параметр         | Тип         | Описание                                                                                                  |
|------------------|-------------|-----------------------------------------------------------------------------------------------------------|
| `config`         | `AuthConfig`| См. [Auth - AuthConfig](./auth.md#authconfig)                                                             |
| `userCollection` | `Collection`| Коллекция пользователей, например: `db.getCollection('users')`, см. [База данных - Коллекция](../database/collection) |

### `user()`

Геттер и сеттер для получения и установки информации о пользователе. По умолчанию использует объект `ctx.state.currentUser`.

#### Сигнатура

- `set user()`
- `get user()`

### `check()`

Выполняет аутентификацию по токену из запроса и возвращает данные пользователя.

### `signIn()`

Вход пользователя в систему, генерирует токен.

### `signUp()`

Регистрация нового пользователя.

### `signOut()`

Выход пользователя из системы, приводит к аннулированию токена.

### `validate()` \*

Основная логика аутентификации. Вызывается при вызове метода `signIn`, определяет, может ли пользователь успешно войти в систему.
