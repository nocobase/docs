# Интернационализация

## Файлы интернационализации

В плагине файлы многоязычной поддержки для фронтенда и бэкенда хранятся в папке `src/locale`. Вы можете просмотреть [все поддерживаемые языки](#) в NocoBase, перейдя по ссылке.

```bash
|- /plugin-sample-i18n
  |- /src
    |- /locale      # Файлы многоязычной поддержки
      |- en_US.ts   # Английский язык
      |- zh_CN.ts   # Китайский язык
```

Для добавления записей перевода обновите соответствующий многоязычный файл (`/src/locale/${lang}.ts`). При добавлении нового языкового файла впервые потребуется перезапустить приложение, чтобы изменения вступили в силу. Успешное добавление записей перевода можно проверить через интерфейс `app:getLang`.

http://localhost:13000/api/app:getLang?locale=zh-CN

## Как обеспечить поддержку интернационализации

### Экземпляр app.i18n

```ts
import { Plugin } from '@nocobase/client';

class PluginDemoClient extends Plugin {
  async load() {
    // Экземпляр i18n
    this.app.i18n;
    this.app.i18n.t('привет');
    await this.app.i18n.changeLanguage('zh-CN');
  }
}
```

Реализация i18n основана на i18next. Для более подробных инструкций обратитесь к [документации I18next API](https://www.i18next.com/overview/api).

### Метод React Hook

```ts
import { useApp } from '@nocobase/client';
import { useTranslation } from 'react-i18next';

const { i18n } = useApp();
const { t } = useTranslation('@nocobase/plugin-sample-i18n');
t('привет');
// Эквивалентно
i18n.t('привет', { ns: '@nocobase/plugin-sample-i18n' });
```

Для подробного использования `useTranslation()` обратитесь к [документации react-i18next](https://react.i18next.com/).

### Пространство имён

Локализация каждого плагина различается по пространству имён (ns), которое соответствует имени плагина, например:

```ts
app.i18n.t('Привет', { ns: '@nocobase/plugin-sample-i18n' });
```

### Метод tval

При использовании в схеме:

```ts
const schema = {
  type: 'string',
  title: '{{t("Я в порядке", { ns: "@nocobase/plugin-sample-i18n" })}}',
  'x-component': 'FormItem',
  'x-component': 'Input',
};
```

Написание `'{{t("Я в порядке", { ns: "@nocobase/plugin-sample-i18n" })}}'` напрямую может привести к ошибкам. Вместо этого можно использовать более удобную функцию tval:

```ts
import { tval } from '@nocobase/client';

const schema = {
  type: 'string',
  title: tval("Я в порядке", { ns: '@nocobase/plugin-sample-i18n', ...others }),
  'x-component': 'FormItem',
  'x-component': 'Input',
};
```

## Важные замечания

Избегайте использования экземпляра `i18n`, экспортированного из `@nocobase/client`, так как он будет устаревшим в будущем. Вместо этого используйте `app.i18n`.

```ts
// Неправильно
import { i18n } from '@nocobase/client';

i18n.t('привет');

// Правильно
import { Plugin } from '@nocobase/client';

class PluginDemoClient extends Plugin {
  async load() {
    this.app.i18n.t('привет');
  }
}
```

**Почему это устарело?**

Каждый экземпляр приложения работает независимо, включая i18n. Глобальный экземпляр i18n может вызывать помехи между несколькими экземплярами приложений, что нарушает принципы проектирования и является нежелательной практикой.

## Полный пример плагина

- [@nocobase/plugin-sample-i18n](#)
