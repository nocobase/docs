# HTTP-запросы

<PluginInfo name="workflow-request" link="/handbook/workflow-request"></PluginInfo>

Когда вам нужно взаимодействовать с другой веб-системой, узел HTTP-запроса — ваш инструмент. Этот узел позволяет отправлять HTTP-запрос на указанный адрес с данными в формате JSON или `application/x-www-form-urlencoded`, что обеспечивает бесперебойную связь с внешними системами.

Если вы уже знакомы с такими инструментами, как Postman, освоить узел HTTP-запроса будет просто. Однако, в отличие от традиционных инструментов, этот узел использует контекстные переменные из текущего "wowrkflow", что делает его мощным дополнением к интеграции вашего бизнес-процесса.

### Установка

Это встроенный плагин, поэтому установка не требуется.

### Руководство пользователя

#### Создание узла

В интерфейсе конфигурации "worklow" нажмите кнопку «плюс» («+») в вашем процессе, чтобы добавить узел «HTTP Request»:

![HTTP Request_Add](https://static-docs.nocobase.com/46f2a6fc3f6869c80f8fbd362a54e644.png)

#### Конфигурация узла

![HTTP Request Node_Configuration](https://static-docs.nocobase.com/2fcb29af66b892fa704add52e2974a52.png)

**Метод запроса**

Выберите из доступных методов HTTP-запроса: `GET`, `POST`, `PUT`, `PATCH` и `DELETE`.

**URL запроса**

Укажите URL службы HTTP, включая протокол (`http://` или `https://`). Для безопасности рекомендуется `https://`.

**Формат данных запроса**

Это определяет `Content-Type` в заголовке запроса с параметрами для `application/json` и `application/x-www-form-urlencoded`.

**Конфигурация заголовка запроса**

Установите пары ключ-значение для заголовков запроса со значениями, которые могут динамически ссылаться на переменные из контекста "workflow".

:::info{title=Note}
Заголовок `Content-Type` предопределен настройкой формата данных запроса. Ручной ввод здесь не переопределит эту конфигурацию.
:::

**Параметры запроса**

Определите пары ключ-значение для строки запроса. Значения могут динамически использовать переменные из контекста "workflow".

**Тело запроса**

В настоящее время тело запроса поддерживает только стандартный формат JSON. Используйте кнопку переменной в правом верхнем углу текстового редактора для вставки контекстных переменных.

:::info{title=Note}
Убедитесь, что переменные в JSON используются как строки, например: `"a": "{{$context.data.a}}"`.
:::

**Настройки тайм-аута**

Если запрос слишком долго не отвечает, настройка тайм-аута отменит его, что приведет к преждевременному завершению текущего "workflow" со статусом сбоя.

**Игнорировать сбой**

Узел запроса считает любой код состояния HTTP между `200` и `299` успешным. Коды за пределами этого диапазона считаются сбоями. Если вы выберете опцию «Игнорировать сбойные запросы и продолжить "worflow"», "workflow" продолжится с последующими узлами, даже если запрос не будет выполнен.

### Использование результатов ответа

Результаты ответа HTTP-запроса можно проанализировать с помощью узла [JSON Query](./plugins/json-query.md), что позволяет использовать их в последующих узлах "workflow".

Начиная с версии `v1.0.0-alpha.16`, ответ узла запроса включает три компонента, которые можно использовать в качестве переменных:

- Код состояния
- Заголовки ответа
- Данные

![HTTP Request Node_Response Result Usage](https://static-docs.nocobase.com/20240529110610.png)

Код состояния ответа — это стандартный числовой код состояния HTTP, например `200` или `403`, предоставляемый службой.

Заголовки ответа имеют формат JSON, а данные ответа — также в формате JSON — должны быть проанализированы с помощью узла JSON перед использованием.

### Пример

Например, вы можете настроить узел запроса для взаимодействия с облачной платформой для отправки уведомлений SMS. Вот как вы настроите API SMS Alibaba Cloud (с параметрами, адаптированными в соответствии с соответствующей документацией):

![HTTP Request Node_Configuration](https://static-docs.nocobase.com/20240515124004.png)

Когда "workflow" запускает этот узел, он вызывает API SMS Alibaba Cloud на основе конфигурации. В случае успеха текстовое сообщение будет отправлено через облачную службу SMS.
