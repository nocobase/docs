# Пример

Основываясь на базовых инструкциях, предоставленных ранее, давайте рассмотрим пример сценария «Отправка заказа». В этом сценарии нам необходимо проверить уровень запасов всех продуктов, выбранных пользователем во время отправки заказа. Если у какого-либо продукта недостаточно запасов, отправка заказа будет заблокирована, и будет отображено соответствующее уведомление. Система выполнит итерацию по каждому продукту, и если у всех продуктов достаточно запасов, данные заказа будут успешно сгенерированы.

Остальные шаги следуют той же процедуре, которая описана в инструкциях. Однако, поскольку заказ может включать несколько продуктов, в дополнение к установлению связи «многие ко многим» между «Заказ» <-- m:1 -- «Подробности» -- 1:m --> «Продукт» во время моделирования данных необходимо ввести узел «Цикл» в "workflow" «Событие перед действием». Этот цикл будет использоваться для проверки уровня запасов каждого продукта:

![Example_Loop Check Process](https://static-docs.nocobase.com/8307de47d5629595ab6cf00f8aa898e3.png)

Объект цикла должен быть установлен в массив "Details" в отправленных данных заказа:

![Example_Loop Object Configuration](https://static-docs.nocobase.com/ed662b54cc1f5425e2b472053f89baba.png)

В цикле используется узел проверки условия для определения достаточности запасов текущего продукта:

![Example_Condition Check in Loop](https://static-docs.nocobase.com/4af91112934b0a04a4ce55e657c0833b.png)

Другие конфигурации остаются в соответствии с теми, что указаны в основных инструкциях по использованию. При отправке заказа, если запас какого-либо продукта недостаточен, заказ будет заблокирован, и будет возвращено соответствующее уведомление. Во время тестирования вы можете попытаться отправить несколько продуктов в одном заказе, при этом у одного продукта будет недостаточно запасов, а у другого — достаточно. Полученное вами ответное сообщение будет выглядеть следующим образом:

![Пример_Ответного сообщения на отправку](https://static-docs.nocobase.com/dd9e81084aa237bda0241d399ac19270.png)

Как показано, ответное сообщение не указывает на недостаточный запас первого продукта, «iPhone 15 Pro», но указывает на недостаточный запас второго продукта, «iPhone 14 Pro». Это происходит, потому что запас первого продукта был достаточным, что позволило продолжить отправку, в то время как недостаточный запас второго продукта привел к блокировке заказа.
