# Расширенное понимание

**Условия перехвата**

В «событиях до действия» два конкретных условия могут привести к перехвату соответствующей операции:

1. Процесс достигает узла «Завершить процесс». Как объяснялось ранее, если данные запуска не соответствуют условиям, установленным в узле «Условие», процесс следует по ветки «Нет», выполняя узел «Завершить процесс». Это приводит к завершению процесса, а запрошенная операция перехватывается.
2. Любой узел в процессе не может быть выполнен — будь то из-за ошибки или других исключительных обстоятельств. В таких случаях процесс завершается с соответствующим статусом, и операция перехватывается. Например, если «Запрос HTTP» используется для получения внешних данных и запрос не выполняется, процесс завершается в состоянии сбоя, одновременно перехватывая соответствующий запрос операции.

После выполнения этих условий перехвата рассматриваемая операция полностью останавливается. Например, если перехвачена отправка заказа, соответствующие данные заказа не будут сгенерированы.

**Параметры для соответствующих операций**

В "workflow" «событий до действия» различные точки данных доступны как переменные внутри процесса в зависимости от операции:

| Тип операции \\ Переменная | «Пользователь действовал» | «Роль пользователя выполнена» | Параметр операции: «ID» | Параметр: «Отправленные значения» |
| -------------------------- | ---------- | -------------------------- | ------------------------- | -------------------------------------------- |
| Создать запись             | ✓          | ✓                          | -                         | ✓                                              |
| Обновить запись             | ✓          | ✓                          | ✓                         | ✓                                              |
| Удалить одну или несколько записей  | ✓          | ✓                          | ✓                         | -                                              |

:::info{title=Tip}
Переменные "Переменные триггера / Параметр / Отправленные значения" в событиях до действия — это не фактические данные, хранящиеся в базе данных, а параметры, отправленные с операцией. Чтобы получить фактические данные базы данных, необходимо использовать узел "Запрос записи" в процессе.

Кроме того, для операций удаления при работе с одной записью "ID" в параметрах операции — это простое значение. Однако для нескольких записей "ID" — это массив.
:::

**Ответные сообщения**

После настройки триггера можно определить соответствующую логику в "workflow". Обычно механизм ветвления узла «Условие» используется для принятия решения о «Завершении процесса» на основе определенных бизнес-условий, возвращая предопределенное «Ответное сообщение»:

![Конфигурация процесса перехвата](https://static-docs.nocobase.com/cfddda5d8012fd3d0ca09f04ea610539.png)

На этом этапе конфигурация "workflow" завершена. Вы можете проверить ее, отправив данные, которые не соответствуют настроенным условиям, что приведет к запуску логики перехвата. Это приведет к возврату ответного сообщения:

![Сообщение об ошибке](https://static-docs.nocobase.com/06bd4a6b6ec499c853f0c39987f63a6a.png)

**Состояние ответного сообщения**

Если узел «Завершить процесс» настроен на выход со статусом «Успешно» и процесс достигает этого узла, запрос операции все равно будет перехвачен. Однако возвращенное ответное сообщение будет отображать статус «Успешно» (вместо «Ошибка»):

![Сообщение об успешном статусе](https://static-docs.nocobase.com/9559bbf56067144759451294b18c790e.png)
