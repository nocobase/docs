# Подключение внешних таблиц данных (FDW)

<PluginInfo name="collection-fdw"></PluginInfo>

## Введение

Этот плагин позволяет подключаться к удалённым таблицам данных с использованием технологии внешней обёртки данных (Foreign Data Wrapper, FDW) базы данных. В настоящее время поддерживаются базы данных MySQL и PostgreSQL.

:::info{title="Подключение источников данных vs Подключение внешних таблиц данных"}
- **Подключение источников данных** означает установление соединения с конкретной базой данных или API-сервисом, что позволяет в полной мере использовать возможности базы данных или сервисов, предоставляемых API.
- **Подключение внешних таблиц данных** означает получение данных извне и их отображение для локального использования. В базах данных эта технология называется FDW (Foreign Data Wrapper). Она позволяет использовать удалённые таблицы как локальные, но подключение осуществляется по одной таблице за раз. Из-за удалённого доступа при использовании возникают различные ограничения и условия.
- 
Оба подхода можно комбинировать. Первый используется для установления соединения с источником данных, второй — для доступа между разными источниками. Например, подключается источник данных PostgreSQL, а одна из таблиц в этом источнике — это внешняя таблица, созданная на основе FDW.
:::

### MySQL

В MySQL используется движок `federated`, который необходимо активировать. Он поддерживает подключение к удалённым базам данных MySQL и совместимым с ним по протоколу базам, таким как MariaDB. Подробнее см. документацию [Federated Storage Engine](https://dev.mysql.com/doc/refman/8.0/en/federated-storage-engine.html).

### PostgreSQL

В PostgreSQL для поддержки различных типов удалённых данных можно использовать различные расширения `fdw`. В настоящее время поддерживаются следующие расширения:

- [postgres_fdw](https://www.postgresql.org/docs/current/postgres-fdw.html): подключение к удалённой базе данных PostgreSQL из PostgreSQL.
- [mysql_fdw (в разработке)](https://github.com/EnterpriseDB/mysql_fdw): подключение к удалённой базе данных MySQL из PostgreSQL.
- Другие типы расширений fdw можно найти в [PostgreSQL Foreign Data Wrappers](https://wiki.postgresql.org/wiki/Foreign_data_wrappers). Для их использования необходимо реализовать соответствующий интерфейс адаптации в коде.

## Установка

### Предварительные требования

- Если основная база данных NocoBase — MySQL, необходимо активировать движок `federated`. Подробнее см. [Как включить движок federated в MySQL](./enable-federated.md).

Затем установите и активируйте плагин через менеджер плагинов:

![Установка и активация плагина](https://static-docs.nocobase.com/f84276c5712851fb3ff33af3f1ff0f59.png)

## Руководство пользователя

В разделе «Менеджер коллекций > Создать коллекцию» выберите «Подключиться к внешней таблице данных»:

![Подключение внешних данных](https://static-docs.nocobase.com/029d946a6d067d1c35a39755219d623c.png)

В выпадающем списке «Сервер базы данных» выберите существующий сервер базы данных или нажмите «Создать сервер базы данных»:

![Сервер базы данных](https://static-docs.nocobase.com/766271708a911950a5599d60d6be4a4d.png)

Создание сервера базы данных:

![Создание сервера базы данных](https://static-docs.nocobase.com/1e357216e04cc4f200bd6212827281c8.png)

После выбора сервера базы данных в списке «Удалённая таблица» выберите таблицу, к которой нужно подключиться:

![Выбор таблицы для подключения](https://static-docs.nocobase.com/e91fd6152b52b4fc01b3808053cc8dc4.png)

Настройка информации о полях:

![Настройка информации о полях](https://static-docs.nocobase.com/e618fecc5fe327f6a495e61405e5f040.png)

Если в удалённой таблице произошли структурные изменения, вы можете обновить схему с помощью функции «Синхронизировать из удалённой таблицы»:

![Синхронизация из удалённой таблицы](https://static-docs.nocobase.com/3751a9a39f933889fb3fcc4d85a6f4ad.png)

Синхронизация удалённой таблицы:

![Синхронизация удалённой таблицы](https://static-docs.nocobase.com/13f18200e31ea223fdd8dadaff1e9d28.png)

Наконец, отобразите таблицу на интерфейсе:

![Отображение на интерфейсе](https://static-docs.nocobase.com/368fca27a99277d9360ca81350949357.png)
