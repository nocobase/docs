# Руководство пользователя

## Объединение ролей (Role Union)

**Объединение ролей** — это режим управления правами доступа. В зависимости от настроек системы, разработчики могут выбрать один из вариантов: `Независимые роли`, `Разрешить объединение ролей` или `Только объединение ролей`, чтобы соответствовать различным требованиям безопасности.

![20250312184651](https://static-docs.nocobase.com/20250312184651.png)

### Независимые роли

По умолчанию система использует **независимые роли**. Пользователи вручную переключаются между ролями, которые им назначены.

![20250312184729](https://static-docs.nocobase.com/20250312184729.png)  
![20250312184826](https://static-docs.nocobase.com/20250312184826.png)

### Разрешить объединение ролей

Разработчики могут включить параметр **Разрешить объединение ролей**, который позволяет пользователю одновременно иметь права всех назначенных ролей, при этом всё ещё можно вручную переключать роли.

![20250312185006](https://static-docs.nocobase.com/20250312185006.png)

### Только объединение ролей

Пользователи всегда работают с объединёнными правами и **не могут переключаться между ролями вручную**.

![20250312185105](https://static-docs.nocobase.com/20250312185105.png)

### Правила объединения ролей

Объединение ролей предоставляет **максимальные права** из всех назначенных ролей. Ниже описано, как разрешаются конфликты при разных настройках на одни и те же разрешения.

#### Объединение операций

Пример:  
Роль 1: `Можно настраивать интерфейс`  
Роль 2: `Можно устанавливать, активировать и отключать плагины`

![20250312190133](https://static-docs.nocobase.com/20250312190133.png)  
![20250312190352](https://static-docs.nocobase.com/20250312190352.png)

При входе с ролью **Полные права** пользователь получает **обе группы прав**.

![20250312190621](https://static-docs.nocobase.com/20250312190621.png)

#### Объединение области данных (Data Scope)

##### Строки данных

**Сценарий 1:** несколько ролей фильтруют по одному полю

Роль A: `Возраст < 30`

| ID | Имя  | Возраст |
|----|------|---------|
| 1  | Jack | 23      |
| 2  | Lily | 29      |

Роль B: `Возраст > 25`

| ID | Имя  | Возраст |
|----|------|---------|
| 2  | Lily | 29      |
| 3  | Sam  | 32      |

**После объединения:**

| ID | Имя  | Возраст |
|----|------|---------|
| 1  | Jack | 23      |
| 2  | Lily | 29      |
| 3  | Sam  | 32      |

**Сценарий 2:** разные поля в условиях фильтра

Роль A: `Возраст < 30`  
Роль B: `Имя содержит "Ja"`

| ID | Имя    | Возраст |
|----|--------|---------|
| 1  | Jack   | 23      |
| 2  | Lily   | 29      |
| 3  | Jasmin | 27      |

**После объединения:**

| ID | Имя    | Возраст |
|----|--------|---------|
| 1  | Jack   | 23      |
| 2  | Lily   | 29      |
| 3  | Jasmin | 27      |

##### Столбцы данных

Роль A: `Имя`, `Возраст`  
Роль B: `Имя`, `Пол`

**После объединения:**

| ID | Имя  | Возраст | Пол    |
|----|------|---------|--------|
| 1  | Jack | 23      | Man    |
| 2  | Lily | 29      | Woman  |

##### Смешанное объединение строк и столбцов

Роль A: `Возраст < 30`, колонки: `Имя`, `Возраст`  
Роль B: `Имя содержит "Ja"`, колонки: `Имя`, `Пол`

**После объединения:**

| ID | Имя   | Возраст                                 | Пол                                      |
|----|--------|------------------------------------------|-------------------------------------------|
| 1  | Jack  | 23                                       | <span style=\"background-color:#FFDDDD\">Man</span>   |
| 2  | Lily  | 29                                       | <span style=\"background-color:#FFDDDD\">Woman</span> |
| 3  | Jade  | <span style=\"background-color:#FFDDDD\">27</span> | Woman                                    |
| 4  | James | <span style=\"background-color:#FFDDDD\">31</span> | Man                                      |

**Примечание:** Ячейки с красным фоном — это данные, которые **не были видимы в отдельных ролях**, но стали доступны при объединении.

##### Итоги объединения области данных:

1. **Строки**: если условие выполнено хотя бы в одной роли — строка доступна
2. **Столбцы**: объединяются все доступные поля
3. При конфигурации строк и столбцов одновременно — объединение происходит **отдельно по строкам и по столбцам**, а не по их пересечению
