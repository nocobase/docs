# SQL-коллекция

<PluginInfo name="collection-sql"></PluginInfo>

## Введение

SQL-коллекция предоставляет мощный метод извлечения данных с помощью SQL-запросов. Извлекая поля данных через SQL-запросы и настраивая связанные метаданные полей, пользователи могут работать с этими полями, как с обычной таблицей. Эта функция особенно полезна для сложных JOIN-запросов, статистического анализа и других сценариев.

## Руководство пользователя

### Создание новой SQL-коллекции

<img src="https://static-docs.nocobase.com/202405191452918.png"/>

1. Введите SQL-запрос в поле ввода и нажмите "Выполнить". Система проанализирует запрос, определит задействованные таблицы и поля, автоматически извлекая соответствующие метаданные полей из исходных таблиц.

<img src="https://static-docs.nocobase.com/202405191453556.png"/>

2. Если анализ системы некорректен, вы можете вручную выбрать нужные таблицы и поля. Сначала выберите исходную таблицу, затем соответствующие поля в разделе источника полей.

<img src="https://static-docs.nocobase.com/202405191453579.png"/>

3. Для полей без прямого источника система определит тип поля на основе типа данных. Если определение неверно, выберите правильный тип вручную.

<img src="https://static-docs.nocobase.com/202405191454703.png"/>

4. Настраивая каждое поле, вы можете видеть результат в области предпросмотра.

<img src="https://static-docs.nocobase.com/202405191455439.png"/>

5. Завершив настройку, нажмите "Подтвердить" для сохранения.

<img src="https://static-docs.nocobase.com/202405191455302.png"/>

### Редактирование

1. Для изменения SQL-запроса нажмите "Редактировать" и измените запрос.
2. Для настройки метаданных полей используйте опцию "Настроить поля" (как для обычной таблицы).

### Синхронизация

Если структура таблиц в БД изменилась, синхронизируйте поля через "Настроить поля" → "Синхронизировать с БД".

<img src="https://static-docs.nocobase.com/202405191456216.png"/>

### Сравнение SQL-коллекций и представлений БД

| Тип                   | Лучше подходит для                                                                 | Метод реализации   | Поддержка CRUD     |
|-----------------------|-----------------------------------------------------------------------------------|--------------------|--------------------|
| SQL-коллекция         | Простые модели, легковесные сценарии<br />Минимальное взаимодействие с БД<br />Предпочитаете UI-операции | SQL подзапрос      | Не поддерживается  |
| Представления БД      | Сложные модели<br />Требуется взаимодействие с БД<br />Нужно изменять данные<br />Требуется стабильная БД | Представление БД   | Частично поддерживается |

:::warning
При использовании SQL-коллекции выбирайте только таблицы, управляемые через NocoBase. Использование внешних таблиц может привести к некорректному анализу запросов. В таких случаях лучше создавать представления.
:::
