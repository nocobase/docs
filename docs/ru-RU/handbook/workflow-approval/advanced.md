# Расширенное понимание

## Снимок данных, отправленных на согласование

В процессе согласования данные управляются на основе принципа **неменяемости транзакционных данных**. Каждая отправка данных создаёт снимок (snapshot), который затем отслеживается и передаётся в ходе процесса согласования. Поток этого процесса выглядит следующим образом:

![Диаграмма процесса снимка данных на согласовании](https://static-docs.nocobase.com/62a545a85d9e72c6b47e4b52707c4380.png)

Когда в процессе выполняются действия, такие как «отозвать» или «вернуть», система сохраняет снимок данных, которые существовали на тот момент, в рамках одного и того же документа заявки:

![Пример процесса снимка данных на согласовании](https://static-docs.nocobase.com/62800d88772c88f1eaa11f6f493aea55.png)

Как показано выше, каждый раз, когда данные отзываются и затем повторно отправляются, создаётся новый снимок для этого конкретного цикла подачи заявки.

## Статусы процесса согласования

Для инициатора заявки поле статуса документа указывает текущую стадию процесса согласования и обычно отражает следующие состояния:

| Статус         | Описание |
|----------------|--------|
| Черновик      | Заявитель временно сохранил данные формы, но ещё не отправил её официально для запуска процесса. |
| Отправлено    | Заявка отправлена и ожидает согласования. На этом этапе ни один из согласующих ещё не обработал заявку, и при наличии соответствующей настройки инициатор всё ещё может отозвать заявку. |
| В процессе    | Заявка прошла как минимум один этап согласования, и по крайней мере один из согласующих уже вынес своё решение. На этом этапе инициатор уже не может отозвать заявку. |
| Возвращено    | Заявка была возвращена одним из согласующих, что позволяет инициатору внести изменения и повторно отправить её. |
| Согласовано   | Все этапы согласования пройдены, и заявка была одобрена на каждом этапе — процесс завершён. |
| Отклонено     | Заявка была отклонена на одном из этапов согласования, в результате чего процесс завершён досрочно. |

Для каждого этапа согласования создаётся запись о действии, выполненного назначенным согласующим. В каждой записи согласующего имеется поле статуса, указывающее текущее состояние обработки, которое обычно включает следующие значения:

| Статус         | Описание |
|----------------|--------|
| Назначен       | Запись для соответствующего согласующего создана, но поскольку правило обработки требует последовательного согласования, согласующий должен дождаться завершения обработки предыдущим согласующим, прежде чем сможет действовать. |
| Ожидание       | Заявка ожидает действий от текущего согласующего. |
| Возвращено     | Текущий согласующий вернул заявку. |
| Согласовано    | Текущий согласующий одобрил заявку. |
| Отклонено      | Текущий согласующий отклонил заявку. |
| Не обработано  | Заявка достигла конечного состояния согласно правилам обработки узла после действий других согласующих, либо рабочий процесс стал недействительным, поэтому от текущего согласующего больше не требуется никаких действий. |
