# Сопоставление переменных JSON

> v1.6.0

Этот узел используется для преобразования сложных JSON-структур из результатов предыдущих узлов в переменные, которые можно использовать в последующих узлах. Например, после сопоставления результатов узлов SQL-запросов или HTTP-запросов вы сможете обращаться к их свойствам в последующих узлах.

:::info{title=Совет}
В отличие от узла «Вычисление JSON», узел «Сопоставление переменных JSON» не поддерживает пользовательские выражения и не зависит от сторонних движков. Он предназначен исключительно для сопоставления значений свойств из JSON-структуры, что делает его проще в использовании.
:::

## Руководство по использованию

### Создание узла

В интерфейсе настройки рабочего процесса нажмите кнопку «+» в цепочке, чтобы добавить узел **«Сопоставление переменных JSON»**:

![Создание узла](https://static-docs.nocobase.com/20250113173635.png)

### Настройка узла

#### Источник данных

Источником данных может быть результат предыдущего узла или объект данных из контекста рабочего процесса. Обычно это неструктурированный объект данных, например, результат узла SQL-запроса или HTTP-запроса.

![Источник данных](https://static-docs.nocobase.com/20250113173720.png)

#### Ввод образца данных

Вставьте фрагмент примера данных и нажмите кнопку «Разобрать», чтобы автоматически сгенерировать список переменных:

![Ввод образца данных](https://static-docs.nocobase.com/20250113182327.png)

Если в автоматически сгенерированном списке есть ненужные переменные, вы можете удалить их, нажав кнопку удаления.

:::info{title=Совет}
Образец данных — это не окончательный результат выполнения; он используется только для генерации списка переменных.
:::

#### Включить индексы массивов в пути

Если этот параметр не отмечен, содержимое массивов будет сопоставляться в соответствии с методом обработки переменных по умолчанию в NocoBase Workflow (см.: [Переменные](/handbook/workflow/advanced/variables#数据结构)). Например, для следующих данных:

```json
{
  "a": 1,
  "b": [
    {
      "c": 2
    },
    {
      "c": 3
    }
  ]
}
```

Сгенерированная переменная `b.c` будет представлять массив `[2, 3]`.

Если этот параметр отмечен, в пути переменных будут включены индексы массивов (например, `b.0.c` и `b.1.c`).

![20250113184056](https://static-docs.nocobase.com/20250113184056.png)

При включении индексов массивов убедитесь, что индексы во входных данных согласованы; в противном случае могут возникнуть ошибки парсинга.

### Использование в последующих узлах

В настройках последующих узлов вы можете использовать переменные, созданные узлом «Сопоставление переменных JSON»:

![Использование в последующих узлах](https://static-docs.nocobase.com/20250113203658.png)

Даже если JSON-структура сложная, после сопоставления вам нужно будет просто выбрать переменную, соответствующую нужному пути.

---
