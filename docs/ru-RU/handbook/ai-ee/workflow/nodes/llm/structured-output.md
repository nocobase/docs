# Структурированный вывод

<PluginInfo name="ai-ee" licenseBundled="true"></PluginInfo>

## Введение

В некоторых сценариях использования пользователи могут хотеть, чтобы модель языкового ИИ (LLM) возвращала структурированный контент в формате JSON. Этого можно добиться с помощью настройки «Структурированный вывод».

![](https://static-docs.nocobase.com/202503041306405.png)

## Инструкции по настройке

- **JSON Schema (Схема JSON)** — пользователи могут настроить [JSON Schema](https://json-schema.org/), чтобы указать ожидаемую структуру ответа модели.
- **Имя** — *необязательно*, помогает модели лучше понять объект, представленный схемой JSON.
- **Описание** — *необязательно*, помогает модели лучше понять назначение схемы JSON.
- **Strict (Строгий режим)** — требует, чтобы модель строго соблюдала структуру, определённую в JSON Schema. В настоящее время этот параметр поддерживают только некоторые новые модели от OpenAI. Перед использованием убедитесь в совместимости с выбранной моделью.

## Методы генерации структурированного контента

Метод генерации структурированного контента зависит от **модели** и её настройки **формата ответа (Response format)**:

1. **Модели, поддерживающие только `text` в формате ответа**

   - При вызове узел привязывает инструмент (Tool), который на основе JSON Schema генерирует JSON-контент. Это направляет модель на формирование структурированного ответа через вызов этого инструмента.

2. **Модели, поддерживающие режим JSON (`json_object`) в формате ответа**

   - При вызове выбирается режим JSON. Пользователь должен явно указать в запросе (Prompt), что модель должна вернуть ответ в формате JSON, и описать поля ответа.
   - В этом режиме JSON Schema используется только для преобразования строки JSON, возвращённой моделью, в целевой JSON-объект.

3. **Модели, поддерживающие JSON Schema (`json_schema`) в формате ответа**

   - Схема JSON напрямую используется для определения требуемой структуры ответа модели.
   - Дополнительно доступен параметр **Strict**, требующий строгого соответствия ответа схеме JSON.

4. **Локальные модели Ollama**

   - Если настроена JSON Schema, при вызове она передаётся модели в качестве параметра `format`.

## Использование результатов структурированного вывода

Структурированный контент ответа модели сохраняется в поле «Структурированный контент» узла и может использоваться последующими узлами.

![](https://static-docs.nocobase.com/202503041330291.png)

![](https://static-docs.nocobase.com/202503041331279.png)

Если требуется использовать значения полей из JSON-объекта, вы можете обратиться к следующим материалам:

- [Сопоставление JSON-переменных](../../../../../handbook/workflow-json-variable-mapping)
- [Запросы к JSON](../../../../../handbook/workflow-json-query)
