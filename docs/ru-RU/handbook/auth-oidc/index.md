# Аутентификация: OIDC

<PluginInfo commercial="true" name="auth-oidc"></PluginInfo>

## Введение

Плагин Auth: OIDC реализует стандарт протокола OpenID Connect (OIDC) с использованием Authorization Code Flow, позволяя пользователям входить в NocoBase через сторонние провайдеры аутентификации (IdP).

## Активация плагина

![](https://static-docs.nocobase.com/202411122358790.png)

## Добавление OIDC-аутентификации

1. Перейдите в раздел управления аутентификацией:

![](https://static-docs.nocobase.com/202411130004459.png)

2. Выберите "Добавить - OIDC":

![](https://static-docs.nocobase.com/1efbde1c0e2f4967efc1c4336be45ca2.png)

## Настройка

### Основные параметры

![](https://static-docs.nocobase.com/202411130006341.png)

| Параметр                                | Описание                                                                                     | Версия          |
|----------------------------------------|----------------------------------------------------------------------------------------------|-----------------|
| Авторегистрация новых пользователей    | Создавать нового пользователя при отсутствии совпадений                                     | -               |
| Issuer (Эмитент)                       | URL провайдера (обычно заканчивается на `/.well-known/openid-configuration`)                | -               |
| Client ID                              | Идентификатор клиента                                                                       | -               |
| Client Secret                          | Секретный ключ клиента                                                                      | -               |
| scope                                  | Области доступа (по умолчанию `openid email profile`)                                       | -               |
| Алгоритм подписи id_token              | Алгоритм подписи токена (по умолчанию RS256)                                                | -               |
| Выход по инициативе RP                 | Выход из сессии IdP при выходе из NocoBase                                                  | `v1.3.44-beta` |

### Сопоставление полей

| Параметр                         | Описание                                                                                     |
|----------------------------------|----------------------------------------------------------------------------------------------|
| Сопоставление полей             | Маппинг полей (никнейм, email, телефон)                                                     |
| Поле для привязки пользователя  | Поле для сопоставления с существующими пользователями (email или username)                   |

### Дополнительные настройки

![](https://static-docs.nocobase.com/202411130013306.png)

| Параметр                                                | Описание                                                                                     | Версия          |
|--------------------------------------------------------|----------------------------------------------------------------------------------------------|-----------------|
| HTTP-протокол                                          | Использовать HTTP для callback-URL (по умолчанию HTTPS)                                      | -               |
| Порт                                                   | Порт для callback-URL                                                                        | -               |
| State-токен                                            | Защита от CSRF-атак (рекомендуется оставить пустым)                                          | -               |
| Передача параметров при обмене кода на токен           | Для некоторых IdP требуется передача Client ID/Secret                                        | -               |
| Метод запроса user info                                | HTTP-метод для получения информации о пользователе                                           | -               |
| Способ передачи access token                           | В заголовке, теле запроса или параметрах URL                                                 | -               |
| Отключение проверки SSL                                | **Не рекомендуется для production-среды**                                                   | `v1.3.40-beta` |

## Использование

| Параметр                     | Описание                                                                                     |
|------------------------------|----------------------------------------------------------------------------------------------|
| Redirect URL                 | URL для callback в настройках IdP                                                            |
| Post logout redirect URL     | URL для перенаправления после выхода                                                         |

:::info
При локальном тестировании используйте `127.0.0.1` вместо `localhost`. Проблемы с state-параметром в cookies могут вызывать ошибки аутентификации.
:::

## Процесс входа

На странице входа нажмите кнопку для авторизации через OIDC-провайдера:

![](https://static-docs.nocobase.com/e493d156254c2ac0b6f6e1002e6a2e6b.png)
