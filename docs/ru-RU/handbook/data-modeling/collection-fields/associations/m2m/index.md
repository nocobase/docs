# Многие ко многим (Many-to-Many)

В системе записи на курсы есть две сущности: **студенты** и **курсы**. 
Один студент может записаться на несколько курсов, и каждый курс может включать множество студентов,
что образует связь типа «многие ко многим».

В реляционных базах данных для представления такой связи обычно используется промежуточная коллекция — 
например, **коллекция записей на курсы** (enrollment). Эта коллекция фиксирует, 
какие курсы выбрал каждый студент и какие студенты записались на каждый курс. 
Такая структура эффективно реализует модель «многие ко многим» между студентами и курсами.

**ER-диаграмма:**

![alt text](https://static-docs.nocobase.com/0e9921228e1ee375dc639431bb89782c.png)

**Настройка полей:**

![alt text](https://static-docs.nocobase.com/8e2739ac5d44fb46f30e2da42ca87a82.png)

## Описание параметров

### Исходная коллекция (Source Collection)

Коллекция, в которой находится текущее поле.

### Целевая коллекция (Target Collection)

Коллекция, с которой устанавливается связь.

### Промежуточная коллекция (Through Collection)

Коллекция, используемая для реализации связи «многие ко многим» между двумя сущностями. 
Содержит два внешних ключа, каждый из которых ссылается на одну из сущностей.

### Ключ исходной коллекции (Source Key)

Поле в исходной коллекции, на которое ссылается внешний ключ. Должно быть уникальным.

### Внешний ключ 1 (Foreign Key 1)

Поле в промежуточной коллекции, устанавливающее связь с исходной коллекцией.

### Внешний ключ 2 (Foreign Key 2)

Поле в промежуточной коллекции, устанавливающее связь с целевой коллекцией.

### Ключ целевой коллекции (Target Key)

Поле в целевой коллекции, на которое ссылается внешний ключ. Должно быть уникальным.

### ON DELETE

Опция **ON DELETE** определяет поведение внешнего ключа при удалении записей в родительской 
коллекции. Используется при задании ограничений целостности.

Доступны следующие режимы:

- **CASCADE**: При удалении записи в родительской коллекции все связанные записи в дочерней коллекции удаляются автоматически.
- **SET NULL**: При удалении родительской записи внешние ключи в дочерней коллекции устанавливаются в `NULL`.
- **RESTRICT**: По умолчанию. Не позволяет удалить запись в родительской коллекции, если есть связанные записи в дочерней.
- **NO ACTION**: Аналогично `RESTRICT`, запрещает удаление родительской записи при наличии связанных записей.
