### **Правила связывания блоков**

> **Примечание**: Эта функция поддерживается начиная с версии v1.7.0-beta.24.

#### **Введение**

Правила связывания блоков позволяют пользователям динамически управлять видимостью блоков, обеспечивая контроль отображения элементов на уровне блока. Поскольку блоки являются контейнерами для полей и кнопок действий, данная функция даёт возможность гибко управлять отображением всего представления с точки зрения блока.

![20250427140619](https://static-docs.nocobase.com/20250427140619.png)

![20250427144259](https://static-docs.nocobase.com/20250427144259.png)

> **Примечание**: Перед применением правил связывания блока сначала выполняется **проверка прав доступа (ACL)**. Правила связывания применяются только в том случае, если у пользователя есть соответствующие права доступа. Другими словами, правила связывания вступают в силу только после успешного прохождения проверки прав ACL на просмотр. Если правила связывания отсутствуют, блок отображается по умолчанию.

#### **Управление блоками с помощью глобальных переменных**

Правила связывания поддерживают управление отображением блоков через глобальные переменные. Например, разные роли могут иметь права на просмотр одной и той же коллекции заказов, но отображаемые данные могут быть персонализированы и различаться. Настраивая поля и действия, отображаемые в блоке, в зависимости от роли пользователя, можно гибко управлять отображением данных и правами на действия.

##### **Роль — Служба поддержки клиентов**

- **Диапазон данных**: может просматривать только заказы со статусом «Ожидает отправки»; скрываются конфиденциальные данные, такие как информация о платежах и данные клиентов со скидками.
- **Действия**:
  - Просмотр деталей заказа
  - Обработка возвратов/обменов
  - Создание запроса на возврат средств
- **Доступные поля**: НомерЗаказа, ДатаЗаказа, СтатусЗаказа, АдресДоставки (исключая конфиденциальные поля: ОбщаяСумма, Скидка, Клиенты и т.д.).

![20250427141800](https://static-docs.nocobase.com/20250427141800.png)

##### **Роль — Финансовый отдел**

- **Диапазон данных**: может просматривать только заказы со статусами «Оплачено» или «Возврат средств»; не требуется отображение деталей товаров или информации о клиентах.
- **Действия**:
  - Проверка запроса на возврат
  - Создание счёта
- **Доступные поля**: НомерЗаказа, ДатаЗаказа, СтатусЗаказа, АдресДоставки, ОбщаяСумма (исключая конфиденциальные поля: Товары, Клиенты и т.д.).

![20250427142420](https://static-docs.nocobase.com/20250427142420.png)

#### **Управление блоками с помощью контекстных переменных**

Блоками также можно управлять с помощью переменных контекста. Например, можно использовать контекстные переменные «текущая запись», «текущая форма» или «текущая запись во всплывающем окне» для динамического отображения блоков.

**Пример:** Блок «Информация о доставке» будет отображаться только тогда, когда статус заказа — «Отправлен».

![20250427143707](https://static-docs.nocobase.com/20250427143707.png)

![20250427143951](https://static-docs.nocobase.com/20250427143951.png)

#### **Markdown в блоках**

**Пример:** Настройка отображения информации о трекинге через Markdown в блоке детализации.

![20250427150236](https://static-docs.nocobase.com/20250427150236.png)

![20250427150308](https://static-docs.nocobase.com/20250427150308.png)

Информация в формате Markdown будет отображаться только при статусе заказа «Отправлен».

![20250427150341](https://static-docs.nocobase.com/20250427150341.png)

Результат:

<video width="100%" height="440" controls>
  <source src="https://static-docs.nocobase.com/20250427150738.mp4" type="video/mp4">
</video>

Более подробную информацию о правилах связывания см. в разделе [Правила связывания](/handbook/ui/linkage-rule).
