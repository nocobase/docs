# HTTP API

События после операции можно запускать не только через взаимодействие с пользовательским интерфейсом, но и с помощью HTTP API, что предоставляет гибкий способ программного запуска рабочих процессов.

:::info{title="Примечание"}
При запуске событий после операции через HTTP API важно убедиться, что рабочий процесс активен, а конфигурация таблицы данных соответствует ожидаемой. Если эти условия не выполнены, вызов может завершиться неудачей или привести к ошибкам.
:::

Для рабочих процессов, привязанных к конкретным кнопкам операций, можно использовать следующий метод вызова (в примере — кнопка создания записи в таблице `posts`):

```bash
curl -X POST -H 'Authorization: Bearer <ваш токен>' -H 'X-Role: <имя_роли>' -d \
  '{
    "title": "Привет, мир!",
    "content": "Это тестовая публикация."
  }' \
  "http://localhost:3000/api/posts:create?triggerWorkflows=workflowKey"
```

В этом примере параметр URL `triggerWorkflows` указывает ключ рабочего процесса. Если необходимо, можно указать несколько рабочих процессов, разделив их запятыми. Ключ рабочего процесса можно посмотреть, наведя курсор на название рабочего процесса в верхней части холста:

![Способ просмотра ключа рабочего процесса](https://static-docs.nocobase.com/20240426135108.png)

При успешном выполнении этот запрос запустит соответствующее событие после операции для таблицы `posts`.

:::info{title="Примечание"}
Поскольку внешние API-вызовы требуют аутентификации пользователя, в HTTP-запросах необходимо передавать те же учётные данные, что и при стандартных запросах через интерфейс. Это включает заголовок `Authorization` (или параметр `token`, полученный при входе в систему) и заголовок `X-Role`, который указывает текущую роль пользователя.
:::

Если необходимо запустить событие, связанное с отношением один-к-одному (в настоящее время отношения «многие-к-одному» не поддерживаются), можно использовать символ `!` в параметрах, чтобы указать данные триггера для поля связи:

```bash
curl -X POST -H 'Authorization: Bearer <ваш токен>' -H 'X-Role: <имя_роли>' -d \
  '{
    "title": "Привет, мир!",
    "content": "Это тестовая публикация.",
    "category": {
      "title": "Тестовая категория"
    }
  }' \
  "http://localhost:3000/api/posts:create?triggerWorkflows=workflowKey!category"
```

При успешном выполнении будет запущено соответствующее событие после операции для таблицы `categories`.

:::info{title="Примечание"}
Если событие настроено в глобальном режиме, нет необходимости указывать рабочий процесс через параметр URL `triggerWorkflows`. Достаточно просто выполнить операцию с соответствующей таблицей данных — это автоматически запустит привязанный рабочий процесс.
:::
