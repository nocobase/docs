# План выполнения (история)

После каждого запуска рабочего процесса создаётся соответствующий план выполнения, который отслеживает ход выполнения этой задачи. Каждый план выполнения имеет статус, указывающий текущее состояние выполнения, который можно посмотреть в списке и деталях истории выполнения:

![Статус плана выполнения](https://static-docs.nocobase.com/d4440d92ccafac6fac85da4415bb2a26.png)

Когда все узлы в основной ветви процесса выполняются до конца со статусом «Resolved» (успешно), весь план выполнения завершается со статусом «Resolved». Если в основной ветви процесса появляются узлы с финальным статусом, таким как «Failed» (неудача), «Error» (ошибка), «Canceled» (отменён) или «Rejected» (отклонён), план выполнения досрочно завершается с соответствующим статусом. Если узлы в основной ветви находятся в статусе «Pending» (в ожидании), весь план выполнения приостанавливается, но продолжает отображаться как «On going» (в процессе), пока ожидающий узел не будет возобновлён и выполнение не продолжится. Разные типы узлов по-разному обрабатывают статус «Pending». Например, узлы «Ручной ввод» ждут ручной обработки, а узлы «Задержка» — ждут наступления определённого времени.

Статусы плана выполнения:

| Статус      | Соответствует статусу последнего </br> выполненного узла основного процесса | Пояснение |
|-------------|----------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Queueing (В очереди)  | - | Процесс был запущен, план выполнения создан и ожидает в очереди назначения планировщиком. |
| On going (Выполняется) | Pending (В ожидании) | Узел запросил приостановку, ожидает дальнейшего ввода или обратного вызова для продолжения. |
| Resolved (Успешно) | Resolved (Успешно) | Проблем не возникло, все узлы выполнились по порядку и завершились. |
| Failed (Неудача) | Failed (Неудача) | Завершился с ошибкой из-за невыполнения логики настройки узла. |
| Error (Ошибка) | Error (Ошибка) | Узел столкнулся с необработанной программной ошибкой и завершился досрочно. |
| Canceled (Отменён) | Canceled (Отменён) | Ожидающий узел был отменён администратором и завершился досрочно. |
| Rejected (Отклонён) | Rejected (Отклонён) | В узлах, требующих ручной обработки, действие было отклонено пользователем, и последующие шаги не выполняются. |

В примерах из раздела [Быстрый старт](../quick-start.md) мы уже убедились, что просмотр деталей истории выполнения рабочего процесса позволяет проверить, были ли все узлы выполнены корректно, а также посмотреть статус и результаты каждого узла. В некоторых расширенных рабочих процессах и узлах результаты выполнения могут быть множественными, например, результаты узла «Цикл»:

![Результаты узла, выполненного несколько раз](https://static-docs.nocobase.com/bbda259fa2ddf62b0fc0f982efbedae9.png)

:::info{title=Примечание}
Рабочие процессы могут запускаться одновременно, но выполняются последовательно, в очереди. Даже если несколько процессов запускаются одновременно, они будут выполняться по очереди, а не параллельно. Поэтому, когда статус показывает «Queueing» (в очереди), это означает, что один из процессов уже выполняется, и остальным нужно ждать.

Статус «On going» (выполняется) означает только то, что план выполнения запущен, и обычно он приостановлен из-за состояния «Pending» одного из узлов. Это не означает, что процесс удерживает ресурсы выполнения в приоритетной позиции. Таким образом, даже если есть планы со статусом «On going», другие планы со статусом «Queueing» могут быть запланированы и выполнены.
:::

## Статус выполнения узла

Статус плана выполнения определяется каждым узлом. В плане выполнения после запуска каждый выполненный узел формирует свой статус, который определяет, будет ли процесс продолжаться дальше. Обычно после успешного выполнения узла следующий узел продолжает выполнение, пока не будут пройдены все узлы по порядку или не произойдёт прерывание. При встрече с узлами управления потоком, такими как «Ветвление», «Цикл», «Параллельно» и «Задержка», последовательность выполнения следующих узлов определяется настройками управляющего узла и данными контекста выполнения.

Возможные статусы после выполнения узла:

| Статус | Финальный? | Приводит к досрочному завершению? | Пояснение |
|--------|:------------------------:|:-------------------------:|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Pending (Ожидание) | Нет | Нет | Узел запрашивает приостановку, ожидает дальнейшего ввода или обратного вызова. |
| Resolved (Успешно) | Да | Нет | Проблем не возникло, узел успешно выполнен, процесс переходит к следующему узлу до завершения. |
| Failed (Неудача) | Да | Да | Неудача из-за невыполнения условий конфигурации узла. |
| Error (Ошибка) | Да | Да | Узел столкнулся с необработанной программной ошибкой и завершился досрочно. |
| Canceled (Отменён) | Да | Да | Узел в состоянии ожидания был отменён извне (администратором), процесс завершён досрочно. |
| Rejected (Отклонён) | Да | Да | В узлах, требующих ручной обработки, действие было отклонено пользователем, дальнейшее выполнение не продолжается. |

За исключением статуса «Pending», все остальные статусы являются финальными. Только при финальном статусе «Resolved» процесс продолжает выполнение; в противном случае весь процесс завершается досрочно. Если узел находится в рамках ветви («Параллельные ветви», «Условие», «Цикл» и т.д.), его финальный статус обрабатывается узлом, открывшим ветвь, и так далее — это определяет дальнейший ход всего процесса.

Например, когда мы используем узел «Условие» в режиме «Продолжить, если „да“», и при выполнении результат оказывается «ложь», весь процесс прерывается и завершается со статусом «Failed» (неудача), как показано на рисунке ниже:

![Выполнение узла завершилось с ошибкой](https://static-docs.nocobase.com/993aecfa1465894bb574444f0a44313e.png)

Примечание:

Все финальные статусы, кроме «Resolved», можно считать неудачными, но причины различаются. Анализируя результаты узлов, можно точнее определить причину сбоя.
