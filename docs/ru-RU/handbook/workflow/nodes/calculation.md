# Узел вычислений

## Обзор

Хотя узел вычислений не управляет потоком процесса, он выполняет важную функцию в рабочем процессе. Этот узел позволяет вычислять выражения, а результат сохраняется для последующего использования другими узлами. По сути, он заменяет вызов функции и присваивание значения переменной в языках программирования.

## Создание узла

В интерфейсе конфигурации workflow нажмите кнопку "+" в потоке, чтобы добавить узел "Вычисление":

![Добавление узла вычислений](https://static-docs.nocobase.com/58a455540d26945251cd143eb4b16579.png)

## Настройка узла

![Конфигурация узла вычислений](https://static-docs.nocobase.com/6a155de3f6a883d8cd1881b2d9c33874.png)

### Движок вычислений

Определяет синтаксис поддерживаемых выражений. Доступные варианты:

1. **Math.js** - математические вычисления (индексация массивов с 1)
2. **Formula.js** - формулы (индексация массивов с 0)
3. **Шаблон строки** - простая конкатенация значений

Примечание:
Math.js и Formula.js поддерживают множество встроенных функций для работы с данными. Подробности в их официальной документации.


### Выражение

Строковое представление формулы расчета, состоящее из:
- Переменных контекста workflow
- Констант
- Операторов
- Поддерживаемых функций

При ошибках в синтаксисе или несоответствии типов узел завершится с ошибкой.

## Пример использования

### Расчет общей суммы заказа

Для заказов с несколькими позициями можно вычислить общую сумму как сумму произведений цены на количество:

![Пример конфигурации](https://static-docs.nocobase.com/85966b0116afb49aa966eeaa85e78dae.png)

Здесь используется функция `SUMPRODUCT` из Formula.js для поэлементного умножения массивов цен и количеств с последующим суммированием.

