"use strict";(self.webpackChunknocobase_docs=self.webpackChunknocobase_docs||[]).push([[30483],{218247:function(l,t,a){a.r(t);var i=a(572269),u=a(793359),x=a(861788),_=a(719977),h=a(20190),d=a(24268),p=a(496057),v=a(585939),m=a(28484),g=a(635206),I=a(375553),j=a(156266),f=a(572333),b=a(841118),E=a(39297),P=a(868526),M=a(605019),s=a(614651),o=a(280936),r=a(667294),n=a(626879),e=a(785893);function c(){return(0,e.jsx)(s.dY,{children:(0,e.jsx)(r.Suspense,{fallback:(0,e.jsx)(o.Z,{}),children:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"markdown",children:[(0,e.jsxs)("h1",{id:"v012-2023-08-02",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#v012-2023-08-02",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"v0.12: 2023-08-02"]}),(0,e.jsxs)("h2",{id:"new-features",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#new-features",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"New Features"]}),(0,e.jsx)("ul",{children:(0,e.jsx)("li",{children:n.texts[0].value})}),(0,e.jsxs)("h2",{id:"application-upgrades",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#application-upgrades",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Application upgrades"]}),(0,e.jsxs)("h3",{id:"upgrade-of-docker-installation",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#upgrade-of-docker-installation",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Upgrade of Docker installation"]}),(0,e.jsxs)("p",{children:[n.texts[1].value,(0,e.jsx)(s.rU,{to:"/welcome/getting-started/upgrading/docker-compose",children:n.texts[2].value}),n.texts[3].value]}),(0,e.jsxs)("h3",{id:"upgrading-source-code-installation",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#upgrading-source-code-installation",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Upgrading source code installation"]}),(0,e.jsx)("p",{children:n.texts[4].value}),(0,e.jsx)(d.Z,{lang:"bash",children:n.texts[5].value}),(0,e.jsxs)("p",{children:[n.texts[6].value,(0,e.jsx)(s.rU,{to:"/welcome/getting-started/upgrading/git-clone",children:n.texts[7].value}),n.texts[8].value]}),(0,e.jsxs)("h3",{id:"upgrading-a-create-nocobase-app-installation",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#upgrading-a-create-nocobase-app-installation",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Upgrading a create-nocobase-app installation"]}),(0,e.jsxs)("p",{children:[n.texts[9].value,(0,e.jsx)("code",{children:n.texts[10].value}),n.texts[11].value]}),(0,e.jsxs)("h2",{id:"incompatible-changes",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#incompatible-changes",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Incompatible changes"]}),(0,e.jsxs)("h3",{id:"nocobaseapp-client-and-nocobaseapp-server-merged-into-nocobase-app",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#nocobaseapp-client-and-nocobaseapp-server-merged-into-nocobase-app",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"@nocobase/app-client and @nocobase/app-server merged into @nocobase-app"]}),(0,e.jsx)("p",{children:n.texts[12].value}),(0,e.jsxs)("h3",{id:"the-distclient-path-of-the-app-has-changed",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#the-distclient-path-of-the-app-has-changed",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"The dist/client path of the app has changed."]}),(0,e.jsx)("p",{children:n.texts[13].value}),(0,e.jsx)(d.Z,{lang:"diff",children:n.texts[14].value}),(0,e.jsxs)("h3",{id:"third-party-plugins-need-to-be-rebuilt",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#third-party-plugins-need-to-be-rebuilt",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Third party plugins need to be rebuilt"]}),(0,e.jsx)("p",{children:n.texts[15].value}),(0,e.jsxs)("h2",{id:"third-party-plugin-upgrade-guide",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#third-party-plugin-upgrade-guide",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Third-party plugin upgrade guide"]}),(0,e.jsxs)("h3",{id:"the-plugin-directory-must-have-both-srcclient-and-srcserver-directories",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#the-plugin-directory-must-have-both-srcclient-and-srcserver-directories",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"The plugin directory must have both ",(0,e.jsx)("code",{children:n.texts[16].value})," and ",(0,e.jsx)("code",{children:n.texts[17].value})," directories."]}),(0,e.jsx)(d.Z,{lang:"js",children:n.texts[18].value}),(0,e.jsx)(d.Z,{lang:"js",children:n.texts[19].value}),(0,e.jsxs)("p",{children:[n.texts[20].value,(0,e.jsx)("a",{href:"https://github.com/nocobase/nocobase/tree/main/packages/samples/hello",children:n.texts[21].value})]}),(0,e.jsxs)("h3",{id:"plugins-multilingual-placement-srclocale-directory",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#plugins-multilingual-placement-srclocale-directory",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Plugin's multilingual placement ",(0,e.jsx)("code",{children:n.texts[22].value})," directory"]}),(0,e.jsxs)("p",{children:[n.texts[23].value,(0,e.jsx)("code",{children:n.texts[24].value}),n.texts[25].value]}),(0,e.jsxs)("h3",{id:"adjustment-of-plugin-dependencies",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#adjustment-of-plugin-dependencies",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Adjustment of plugin dependencies"]}),(0,e.jsx)("p",{children:n.texts[26].value}),(0,e.jsxs)("ul",{children:[(0,e.jsxs)("li",{children:[n.texts[27].value,(0,e.jsx)("code",{children:n.texts[28].value}),n.texts[29].value,(0,e.jsx)("code",{children:n.texts[30].value}),n.texts[31].value,(0,e.jsx)("code",{children:n.texts[32].value}),n.texts[33].value]}),(0,e.jsxs)("li",{children:[n.texts[34].value,(0,e.jsx)("code",{children:n.texts[35].value}),n.texts[36].value,(0,e.jsx)("code",{children:n.texts[37].value}),n.texts[38].value]})]}),(0,e.jsx)(d.Z,{lang:"diff",children:n.texts[39].value}),(0,e.jsxs)("h3",{id:"the-output-path-of-the-plugin-has-been-changed-from-lib-to-dist",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#the-output-path-of-the-plugin-has-been-changed-from-lib-to-dist",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"The output path of the plugin has been changed from ",(0,e.jsx)("code",{children:n.texts[40].value})," to ",(0,e.jsx)("code",{children:n.texts[41].value})]}),(0,e.jsx)("p",{children:n.texts[42].value}),(0,e.jsx)(d.Z,{lang:"bash",children:n.texts[43].value}),(0,e.jsx)("p",{children:n.texts[44].value}),(0,e.jsx)("p",{children:n.texts[45].value}),(0,e.jsx)(d.Z,{lang:"diff",children:n.texts[46].value}),(0,e.jsx)("p",{children:n.texts[47].value}),(0,e.jsx)(d.Z,{lang:"ts",children:n.texts[48].value}),(0,e.jsx)("p",{children:n.texts[49].value}),(0,e.jsx)(d.Z,{lang:"js",children:n.texts[50].value}),(0,e.jsx)("p",{children:n.texts[51].value}),(0,e.jsx)(d.Z,{lang:"ts",children:n.texts[52].value}),(0,e.jsx)("p",{children:n.texts[53].value}),(0,e.jsx)(d.Z,{lang:"js",children:n.texts[54].value})]})})})})}t.default=c},626879:function(l,t,a){a.r(t),a.d(t,{texts:function(){return i}});const i=[{value:"New plugin build tool. The built plugins will be able to be used directly on the production environment without the need for a second build.",paraId:0,tocIndex:1},{value:"No change, refer to ",paraId:1,tocIndex:3},{value:"Docker Image Upgrade Guide",paraId:2,tocIndex:3},{value:" for upgrade.",paraId:1,tocIndex:3},{value:"The plugin build tool has been freshly upgraded, and the cache needs to be cleared after pulling new sources.",paraId:3,tocIndex:4},{value:`git pull # Pull the new source code.
yarn clean # Clear the cache.
`,paraId:4,tocIndex:4},{value:"For more details, see ",paraId:5,tocIndex:4},{value:"Git source upgrade guide",paraId:6,tocIndex:4},{value:".",paraId:5,tocIndex:4},{value:"Redownload the new version via ",paraId:7,tocIndex:5},{value:"yarn create",paraId:7,tocIndex:5},{value:" and update the .env configuration, see [major version upgrade guide](/welcome/getting-started/upgrading/create-nocobase-app#Major version upgrade) for more details.",paraId:7,tocIndex:5},{value:"Apps installed via create-nocobase-app no longer have a packages/app directory, and custom code in packages/app needs to be moved to the custom plugin.",paraId:8,tocIndex:7},{value:"If you are configuring nginx yourself, you will need to make a similar adjustment",paraId:9,tocIndex:8},{value:`server {
- root /app/nocobase/packages/app/client/dist;
+ root /app/nocobase/node_modules/@nocobase/app/dist/client;

  location / {
-       root /app/nocobase/packages/app/client/dist;
+       root /app/nocobase/node_modules/@nocobase/app/dist/client;
        try_files $uri $uri/ /index.html;
        add_header Last-Modified $date_gmt;
        add_header Cache-Control 'no-store, no-cache';
        if_modified_since off;
        expires off;
        etag off;
    }
}
`,paraId:10,tocIndex:8},{value:"Refer to the third-party plugin upgrade guide below",paraId:11,tocIndex:9},{value:"src/client",paraId:12},{value:"src/server",paraId:12},{value:`// src/client/index.ts
import { Plugin } from '@nocobase/client';

class MyPlugin extends Plugin {
  async load() {
    // ...
  }
}

export default MyPlugin;
`,paraId:13,tocIndex:11},{value:`// src/server/index.ts
import { Plugin } from '@nocobase/server';

class MyPlugin extends Plugin {
  async load() {
    // ...
  }
}

export default MyPlugin;
`,paraId:14,tocIndex:11},{value:"Specific demo code can be referred to: ",paraId:15,tocIndex:11},{value:"sample-hello",paraId:15,tocIndex:11},{value:"src/locale",paraId:12},{value:"Both frontend and backend, multi-language translation files are placed in the ",paraId:16,tocIndex:12},{value:"src/locale",paraId:16,tocIndex:12},{value:" directory, so the plugin doesn't need to load multi-language packages by itself.",paraId:16,tocIndex:12},{value:"The dependencies of the plugin are divided into its own dependencies and global dependencies. Global dependencies are directly used globally and will not be packaged into the plugin product, while its own dependencies will be packaged into the product. After the plug-in is built, the production environment is plug-and-play, and there is no need to install dependencies or build twice. Adjustments to plugin dependencies include:",paraId:17,tocIndex:13},{value:"Put ",paraId:18,tocIndex:13},{value:"@nocobase/*",paraId:18,tocIndex:13},{value:" related packages into ",paraId:18,tocIndex:13},{value:"peerDependencies",paraId:18,tocIndex:13},{value:" and specify the version number as ",paraId:18,tocIndex:13},{value:"0.x",paraId:18,tocIndex:13},{value:";",paraId:18,tocIndex:13},{value:"Place other dependencies in ",paraId:18,tocIndex:13},{value:"devDependencies",paraId:18,tocIndex:13},{value:", not ",paraId:18,tocIndex:13},{value:"dependencies",paraId:18,tocIndex:13},{value:", as the plugin will extract all the dependencies required by the production environment after packaging.",paraId:18,tocIndex:13},{value:`{
  "devDependencies": {
    "@formily/react": "2.x",
    "@formily/shared": "2.x",
    "ahooks": "3.x",
    "antd": "5.x",
    "dayjs": "1.x",
    "i18next": "22.x",
    "react": "18.x",
    "react-dom": "18.x",
    "react-i18next": "11.x"
  },
  "peerDependencies": {
    "@nocobase/actions": "0.x",
    "@nocobase/client": "0.x",
    "@nocobase/database": "0.x",
    "@nocobase/resourcer": "0.x",
    "@nocobase/server": "0.x",
    "@nocobase/test": "0.x",
    "@nocobase/utils": "0.x"
  }
}
`,paraId:19,tocIndex:13},{value:"lib",paraId:12},{value:"dist",paraId:12},{value:"dist directory structure",paraId:20,tocIndex:14},{value:`|- dist
  |- client       # Client-side, umd
    |- index.js
    |- index.d.ts
  |- server       # Server-side, cjs
    |- index.js
    |- index.d.ts
    |- others
  |- locale       # multilingual package
  |- node_modules # server dependencies
`,paraId:21,tocIndex:14},{value:"Other related adjustments include:",paraId:22,tocIndex:14},{value:"Adjustment of the main parameter of package.json",paraId:23,tocIndex:14},{value:`{
  - "main": "./lib/server/index.js",
  + "main": "./dist/server/index.js",
}
`,paraId:24,tocIndex:14},{value:"client.d.ts",paraId:25,tocIndex:14},{value:`export * from './dist/client';
export { default } from './dist/client';
`,paraId:26,tocIndex:14},{value:"client.js",paraId:27,tocIndex:14},{value:`module.exports = require('./dist/client/index.js');
`,paraId:28,tocIndex:14},{value:"server.d.ts",paraId:29,tocIndex:14},{value:`export * from './dist/server';
export { default } from './dist/server';
`,paraId:30,tocIndex:14},{value:"server.js",paraId:31,tocIndex:14},{value:`module.exports = require('./dist/server/index.js');
`,paraId:32,tocIndex:14}]}}]);
