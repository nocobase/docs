"use strict";(self.webpackChunknocobase_docs=self.webpackChunknocobase_docs||[]).push([[34122],{856886:function(i,a,s){s.r(a);var o=s(572269),c=s(793359),_=s(861788),x=s(719977),h=s(20190),t=s(24268),I=s(496057),p=s(585939),v=s(28484),m=s(635206),j=s(375553),E=s(156266),f=s(572333),P=s(841118),C=s(39297),A=s(868526),g=s(605019),d=s(614651),r=s(280936),l=s(667294),n=s(187993),e=s(785893);function u(){return(0,e.jsx)(d.dY,{children:(0,e.jsx)(l.Suspense,{fallback:(0,e.jsx)(r.Z,{}),children:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"markdown",children:[(0,e.jsxs)("h1",{id:"http-request",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#http-request",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"HTTP Request"]}),(0,e.jsxs)("p",{children:[n.texts[0].value,(0,e.jsx)("code",{children:n.texts[1].value}),n.texts[2].value,(0,e.jsx)(d.rU,{to:"/development/client#%E6%8F%92%E4%BB%B6%E7%9A%84%E5%A3%B0%E6%98%8E%E5%91%A8%E6%9C%9F",children:n.texts[3].value}),n.texts[4].value,(0,e.jsx)("code",{children:n.texts[5].value}),n.texts[6].value,(0,e.jsx)("code",{children:n.texts[7].value}),n.texts[8].value,(0,e.jsx)("code",{children:n.texts[9].value}),n.texts[10].value]}),(0,e.jsxs)("h2",{id:"appapiclient",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#appapiclient",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"app.apiClient"]}),(0,e.jsx)(t.Z,{lang:"ts",children:n.texts[11].value}),(0,e.jsx)("hr",{}),(0,e.jsxs)("h3",{id:"apiclientrequest",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#apiclientrequest",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"apiClient.request()"]}),(0,e.jsxs)("p",{children:[n.texts[12].value,(0,e.jsx)("a",{href:"https://axios-http.com/docs/req_config",children:n.texts[13].value}),n.texts[14].value]}),(0,e.jsx)(t.Z,{lang:"ts",children:n.texts[15].value}),(0,e.jsx)("p",{children:n.texts[16].value}),(0,e.jsx)(t.Z,{lang:"ts",children:n.texts[17].value}),(0,e.jsxs)("h3",{id:"apiclientaxios",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#apiclientaxios",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"apiClient.axios"]}),(0,e.jsxs)("p",{children:[(0,e.jsx)("code",{children:n.texts[18].value}),n.texts[19].value]}),(0,e.jsxs)("p",{children:[n.texts[20].value,(0,e.jsx)("a",{href:"https://axios-http.com/docs/config_defaults",children:n.texts[21].value}),n.texts[22].value]}),(0,e.jsx)(t.Z,{lang:"ts",children:n.texts[23].value}),(0,e.jsxs)("p",{children:[n.texts[24].value,(0,e.jsx)("a",{href:"https://axios-http.com/docs/interceptors",children:n.texts[25].value}),n.texts[26].value]}),(0,e.jsx)(t.Z,{lang:"ts",children:n.texts[27].value}),(0,e.jsxs)("h3",{id:"custom-request-headers-in-nocobase-server",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#custom-request-headers-in-nocobase-server",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Custom Request Headers in NocoBase Server"]}),(0,e.jsxs)("ul",{children:[(0,e.jsxs)("li",{children:[(0,e.jsx)("code",{children:n.texts[28].value}),n.texts[29].value]}),(0,e.jsxs)("li",{children:[(0,e.jsx)("code",{children:n.texts[30].value}),n.texts[31].value]}),(0,e.jsxs)("li",{children:[(0,e.jsx)("code",{children:n.texts[32].value}),n.texts[33].value]}),(0,e.jsxs)("li",{children:[(0,e.jsx)("code",{children:n.texts[34].value}),n.texts[35].value]}),(0,e.jsxs)("li",{children:[(0,e.jsx)("code",{children:n.texts[36].value}),n.texts[37].value]}),(0,e.jsxs)("li",{children:[(0,e.jsx)("code",{children:n.texts[38].value}),n.texts[39].value]})]}),(0,e.jsxs)("h2",{id:"useapiclient",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#useapiclient",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"useAPIClient()"]}),(0,e.jsxs)("p",{children:[n.texts[40].value,(0,e.jsx)("code",{children:n.texts[41].value}),n.texts[42].value,(0,e.jsx)("code",{children:n.texts[43].value}),n.texts[44].value]}),(0,e.jsxs)("h2",{id:"userequest",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#userequest",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"useRequest()"]}),(0,e.jsxs)("p",{children:[n.texts[45].value,(0,e.jsx)("a",{href:"https://ahooks.js.org/hooks/use-request/index",children:n.texts[46].value}),n.texts[47].value]}),(0,e.jsx)(t.Z,{lang:"ts",children:n.texts[48].value}),(0,e.jsx)("p",{children:n.texts[49].value}),(0,e.jsx)(t.Z,{lang:"ts",children:n.texts[50].value})]})})})})}a.default=u},187993:function(i,a,s){s.r(a),s.d(a,{texts:function(){return o}});const o=[{value:"NocoBase provides an ",paraId:0,tocIndex:0},{value:"APIClient",paraId:0,tocIndex:0},{value:" for making HTTP requests. Within the ",paraId:0,tocIndex:0},{value:"plugin lifecycle",paraId:1,tocIndex:0},{value:" of a client-side application, you can use ",paraId:0,tocIndex:0},{value:"app.apiClient",paraId:0,tocIndex:0},{value:" to make client-side requests. Inside components, you can use ",paraId:0,tocIndex:0},{value:"useAPIClient()",paraId:0,tocIndex:0},{value:" and ",paraId:0,tocIndex:0},{value:"useRequest()",paraId:0,tocIndex:0},{value:".",paraId:0,tocIndex:0},{value:`class PluginSampleAPIClient extends Plugin {
  async load() {
    const { data } = await this.app.apiClient.request({ url: 'test' });
  }
}
`,paraId:2,tocIndex:1},{value:"For standard requests, refer to axios's ",paraId:3,tocIndex:2},{value:"request config",paraId:3,tocIndex:2},{value:" for more details on usage.",paraId:3,tocIndex:2},{value:`class APIClient {
  // Client-side requests, supporting AxiosRequestConfig and ResourceActionOptions
  request<T = any, R = AxiosResponse<T>, D = any>(
    config: AxiosRequestConfig<D> | ResourceActionOptions,
  ): Promise<R>;
}
`,paraId:4,tocIndex:2},{value:"Example:",paraId:5,tocIndex:2},{value:`const response = await apiClient.request({ url });
`,paraId:6,tocIndex:2},{value:"AxiosInstance",paraId:7,tocIndex:3},{value:" instance",paraId:7,tocIndex:3},{value:"It can be used to modify axios's ",paraId:8,tocIndex:3},{value:"default configuration",paraId:8,tocIndex:3},{value:".",paraId:8,tocIndex:3},{value:`axios.defaults.headers.common['Authorization'] = AUTH_TOKEN;
axios.defaults.headers.post['Content-Type'] =
  'application/x-www-form-urlencoded';
`,paraId:9,tocIndex:3},{value:"It can also be used to ",paraId:10,tocIndex:3},{value:"intercept requests or responses",paraId:10,tocIndex:3},{value:".",paraId:10,tocIndex:3},{value:`// Add request interceptor: use qs to convert params
axios.interceptors.request.use((config) => {
  config.paramsSerializer = (params) => {
    return qs.stringify(params, {
      strictNullHandling: true,
      arrayFormat: 'brackets',
    });
  };
  return config;
});

// Add request interceptor: customize request headers
axios.interceptors.request.use((config) => {
  config.headers['Authorization'] = \`Bearer token123\`;
  config.headers['X-Hostname'] = \`localhost\`;
  config.headers['X-Timezone'] = \`+08:00\`;
  config.headers['X-Locale'] = 'zh-CN';
  config.headers['X-Role'] = 'admin';
  config.headers['X-Authenticator'] = 'basic';
  config.headers['X-App'] = 'sub1';
  return config;
});

// Add response interceptor
axios.interceptors.response.use(
  (response) => response,
  (error) => {
    // Notify the user about the error
    notification.error({
      message: 'Request Response Error',
    });
  },
);
`,paraId:11,tocIndex:3},{value:"X-App",paraId:12,tocIndex:4},{value:": Specify the current app when using multiple apps.",paraId:12,tocIndex:4},{value:"X-Locale",paraId:12,tocIndex:4},{value:": Current language.",paraId:12,tocIndex:4},{value:"X-Hostname",paraId:12,tocIndex:4},{value:": Client hostname.",paraId:12,tocIndex:4},{value:"X-Timezone",paraId:12,tocIndex:4},{value:": Client timezone.",paraId:12,tocIndex:4},{value:"X-Role",paraId:12,tocIndex:4},{value:": Current role.",paraId:12,tocIndex:4},{value:"X-Authenticator",paraId:12,tocIndex:4},{value:": Current user authentication method.",paraId:12,tocIndex:4},{value:"Within a component, you can use ",paraId:13,tocIndex:5},{value:"useAPIClient()",paraId:13,tocIndex:5},{value:" to get the APIClient instance of the current app, which is equivalent to ",paraId:13,tocIndex:5},{value:"app.apiClient",paraId:13,tocIndex:5},{value:".",paraId:13,tocIndex:5},{value:"Asynchronous data management, which can either be data from client requests or a custom asynchronous function. For detailed usage, refer to ahooks's ",paraId:14,tocIndex:6},{value:"useRequest()",paraId:14,tocIndex:6},{value:".",paraId:14,tocIndex:6},{value:`function useRequest<P>(
  service: AxiosRequestConfig<P> | ResourceActionOptions<P> | FunctionService,
  options?: Options<any, any>,
);
`,paraId:15,tocIndex:6},{value:"Example:",paraId:16,tocIndex:6},{value:`const { data, loading, refresh, run, params } = useRequest({ url: '/users' });

// Since useRequest accepts AxiosRequestConfig, the run function also accepts AxiosRequestConfig.
run({
  params: {
    pageSize: 20,
  },
});
`,paraId:17,tocIndex:6}]}}]);
