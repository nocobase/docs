"use strict";(self.webpackChunknocobase_docs=self.webpackChunknocobase_docs||[]).push([[22906],{259773:function(r,n,t){t.r(n);var l=t(572269),u=t(793359),h=t(861788),v=t(719977),I=t(20190),a=t(24268),s=t(496057),_=t(585939),j=t(28484),p=t(635206),m=t(375553),f=t(156266),E=t(572333),w=t(841118),g=t(39297),D=t(868526),M=t(605019),c=t(614651),x=t(280936),i=t(667294),d=t(192435),e=t(785893);function o(){return(0,e.jsx)(c.dY,{children:(0,e.jsx)(i.Suspense,{fallback:(0,e.jsx)(x.Z,{}),children:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"markdown",children:[(0,e.jsxs)("h1",{id:"middleware",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#middleware",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Middleware"]}),(0,e.jsx)("p",{children:d.texts[0].value}),(0,e.jsx)("p",{children:d.texts[1].value}),(0,e.jsxs)("h2",{id:"constructor",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#constructor",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Constructor"]}),(0,e.jsx)("p",{children:(0,e.jsx)("strong",{children:d.texts[2].value})}),(0,e.jsxs)("ul",{children:[(0,e.jsx)("li",{children:(0,e.jsx)("code",{children:d.texts[3].value})}),(0,e.jsx)("li",{children:(0,e.jsx)("code",{children:d.texts[4].value})})]}),(0,e.jsx)("p",{children:(0,e.jsx)("strong",{children:d.texts[5].value})}),(0,e.jsxs)(s.Z,{children:[(0,e.jsx)("thead",{children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{children:d.texts[6].value}),(0,e.jsx)("th",{children:d.texts[7].value}),(0,e.jsx)("th",{children:d.texts[8].value}),(0,e.jsx)("th",{children:d.texts[9].value})]})}),(0,e.jsxs)("tbody",{children:[(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[10].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[11].value})}),(0,e.jsx)("td",{children:d.texts[12].value}),(0,e.jsx)("td",{children:d.texts[13].value})]}),(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[14].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[15].value})}),(0,e.jsx)("td",{children:d.texts[16].value}),(0,e.jsx)("td",{children:d.texts[17].value})]}),(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[18].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[19].value})}),(0,e.jsx)("td",{children:d.texts[20].value}),(0,e.jsx)("td",{children:d.texts[21].value})]}),(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[22].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[23].value})}),(0,e.jsx)("td",{children:d.texts[24].value}),(0,e.jsx)("td",{children:d.texts[25].value})]}),(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[26].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[27].value})}),(0,e.jsx)("td",{children:d.texts[28].value}),(0,e.jsx)("td",{children:d.texts[29].value})]})]})]}),(0,e.jsx)("p",{children:(0,e.jsx)("strong",{children:d.texts[30].value})}),(0,e.jsx)("p",{children:d.texts[31].value}),(0,e.jsx)(a.Z,{lang:"ts",children:d.texts[32].value}),(0,e.jsx)("p",{children:d.texts[33].value}),(0,e.jsx)(a.Z,{lang:"ts",children:d.texts[34].value}),(0,e.jsxs)("h2",{id:"instance-methods",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#instance-methods",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Instance Methods"]}),(0,e.jsxs)("h3",{id:"gethandler",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#gethandler",children:(0,e.jsx)("span",{className:"icon icon-link"})}),(0,e.jsx)("code",{children:d.texts[35].value})]}),(0,e.jsx)("p",{children:d.texts[36].value}),(0,e.jsx)("p",{children:(0,e.jsx)("strong",{children:d.texts[37].value})}),(0,e.jsxs)("p",{children:[d.texts[38].value,(0,e.jsx)("code",{children:d.texts[39].value}),d.texts[40].value,(0,e.jsx)("code",{children:d.texts[41].value}),d.texts[42].value]}),(0,e.jsx)(a.Z,{lang:"ts",children:d.texts[43].value}),(0,e.jsxs)("h3",{id:"use",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#use",children:(0,e.jsx)("span",{className:"icon icon-link"})}),(0,e.jsx)("code",{children:d.texts[44].value})]}),(0,e.jsxs)("p",{children:[d.texts[45].value,(0,e.jsx)("code",{children:d.texts[46].value}),d.texts[47].value]}),(0,e.jsx)("p",{children:(0,e.jsx)("strong",{children:d.texts[48].value})}),(0,e.jsx)("ul",{children:(0,e.jsx)("li",{children:(0,e.jsx)("code",{children:d.texts[49].value})})}),(0,e.jsx)("p",{children:(0,e.jsx)("strong",{children:d.texts[50].value})}),(0,e.jsxs)(s.Z,{children:[(0,e.jsx)("thead",{children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{children:d.texts[51].value}),(0,e.jsx)("th",{children:d.texts[52].value}),(0,e.jsx)("th",{children:d.texts[53].value}),(0,e.jsx)("th",{children:d.texts[54].value})]})}),(0,e.jsx)("tbody",{children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[55].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[56].value})}),(0,e.jsx)("td",{children:d.texts[57].value}),(0,e.jsx)("td",{children:d.texts[58].value})]})})]}),(0,e.jsxs)("h3",{id:"disuse",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#disuse",children:(0,e.jsx)("span",{className:"icon icon-link"})}),(0,e.jsx)("code",{children:d.texts[59].value})]}),(0,e.jsx)("p",{children:d.texts[60].value}),(0,e.jsx)("p",{children:(0,e.jsx)("strong",{children:d.texts[61].value})}),(0,e.jsx)("ul",{children:(0,e.jsx)("li",{children:(0,e.jsx)("code",{children:d.texts[62].value})})}),(0,e.jsx)("p",{children:(0,e.jsx)("strong",{children:d.texts[63].value})}),(0,e.jsxs)(s.Z,{children:[(0,e.jsx)("thead",{children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{children:d.texts[64].value}),(0,e.jsx)("th",{children:d.texts[65].value}),(0,e.jsx)("th",{children:d.texts[66].value}),(0,e.jsx)("th",{children:d.texts[67].value})]})}),(0,e.jsx)("tbody",{children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[68].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[69].value})}),(0,e.jsx)("td",{children:d.texts[70].value}),(0,e.jsx)("td",{children:d.texts[71].value})]})})]}),(0,e.jsx)("p",{children:(0,e.jsx)("strong",{children:d.texts[72].value})}),(0,e.jsxs)("p",{children:[d.texts[73].value,(0,e.jsx)("code",{children:d.texts[74].value}),d.texts[75].value,(0,e.jsx)("code",{children:d.texts[76].value}),d.texts[77].value]}),(0,e.jsx)(a.Z,{lang:"ts",children:d.texts[78].value}),(0,e.jsxs)("h3",{id:"canaccess",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#canaccess",children:(0,e.jsx)("span",{className:"icon icon-link"})}),(0,e.jsx)("code",{children:d.texts[79].value})]}),(0,e.jsx)("p",{children:d.texts[80].value}),(0,e.jsx)("p",{children:(0,e.jsx)("strong",{children:d.texts[81].value})}),(0,e.jsx)("ul",{children:(0,e.jsx)("li",{children:(0,e.jsx)("code",{children:d.texts[82].value})})}),(0,e.jsx)("p",{children:(0,e.jsx)("strong",{children:d.texts[83].value})}),(0,e.jsxs)(s.Z,{children:[(0,e.jsx)("thead",{children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{children:d.texts[84].value}),(0,e.jsx)("th",{children:d.texts[85].value}),(0,e.jsx)("th",{children:d.texts[86].value}),(0,e.jsx)("th",{children:d.texts[87].value})]})}),(0,e.jsx)("tbody",{children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[88].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[89].value})}),(0,e.jsx)("td",{children:d.texts[90].value}),(0,e.jsx)("td",{children:d.texts[91].value})]})})]}),(0,e.jsxs)("h2",{id:"other-exports",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#other-exports",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Other Exports"]}),(0,e.jsxs)("h3",{id:"branch",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#branch",children:(0,e.jsx)("span",{className:"icon icon-link"})}),(0,e.jsx)("code",{children:d.texts[92].value})]}),(0,e.jsx)("p",{children:d.texts[93].value}),(0,e.jsx)("p",{children:(0,e.jsx)("strong",{children:d.texts[94].value})}),(0,e.jsx)("ul",{children:(0,e.jsx)("li",{children:(0,e.jsx)("code",{children:d.texts[95].value})})}),(0,e.jsx)("p",{children:(0,e.jsx)("strong",{children:d.texts[96].value})}),(0,e.jsxs)(s.Z,{children:[(0,e.jsx)("thead",{children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{children:d.texts[97].value}),(0,e.jsx)("th",{children:d.texts[98].value}),(0,e.jsx)("th",{children:d.texts[99].value}),(0,e.jsx)("th",{children:d.texts[100].value})]})}),(0,e.jsxs)("tbody",{children:[(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[101].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[102].value})}),(0,e.jsx)("td",{children:d.texts[103].value}),(0,e.jsx)("td",{children:d.texts[104].value})]}),(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[105].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[106].value})}),(0,e.jsx)("td",{children:d.texts[107].value}),(0,e.jsx)("td",{children:d.texts[108].value})]}),(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[109].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[110].value})}),(0,e.jsx)("td",{children:d.texts[111].value}),(0,e.jsx)("td",{children:d.texts[112].value})]}),(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[113].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[114].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[115].value})}),(0,e.jsx)("td",{children:d.texts[116].value})]}),(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[117].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[118].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:d.texts[119].value})}),(0,e.jsx)("td",{children:d.texts[120].value})]})]})]}),(0,e.jsx)("p",{children:(0,e.jsx)("strong",{children:d.texts[121].value})}),(0,e.jsxs)("p",{children:[d.texts[122].value,(0,e.jsx)("code",{children:d.texts[123].value}),d.texts[124].value]}),(0,e.jsx)(a.Z,{lang:"ts",children:d.texts[125].value})]})})})})}n.default=o},192435:function(r,n,t){t.r(n),t.d(n,{texts:function(){return l}});const l=[{value:"It is similar to the middleware of Koa, but with more enhanced features for easy extensions.",paraId:0,tocIndex:0},{value:"The defined middleware can be inserted for use in multiple places, such as the resourcer, and it is up to the developer for when to invoke it.",paraId:1,tocIndex:0},{value:"Signature",paraId:2,tocIndex:1},{value:"constructor(options: Function)",paraId:3,tocIndex:1},{value:"constructor(options: MiddlewareOptions)",paraId:3,tocIndex:1},{value:"Parameter",paraId:4,tocIndex:1},{value:"Name",paraId:5,tocIndex:1},{value:"Type",paraId:5,tocIndex:1},{value:"Default",paraId:5,tocIndex:1},{value:"Description",paraId:5,tocIndex:1},{value:"options",paraId:5,tocIndex:1},{value:"Function",paraId:5,tocIndex:1},{value:"-",paraId:5,tocIndex:1},{value:"Handler function of middlware",paraId:5,tocIndex:1},{value:"options",paraId:5,tocIndex:1},{value:"MiddlewareOptions ",paraId:5,tocIndex:1},{value:"-",paraId:5,tocIndex:1},{value:"Configuration items of middlware",paraId:5,tocIndex:1},{value:"options.only",paraId:5,tocIndex:1},{value:"string[]",paraId:5,tocIndex:1},{value:"-",paraId:5,tocIndex:1},{value:"Only the specified actions are allowed",paraId:5,tocIndex:1},{value:"options.except",paraId:5,tocIndex:1},{value:"string[]",paraId:5,tocIndex:1},{value:"-",paraId:5,tocIndex:1},{value:"The specified actions are excluded",paraId:5,tocIndex:1},{value:"options.handler",paraId:5,tocIndex:1},{value:"Function",paraId:5,tocIndex:1},{value:"-",paraId:5,tocIndex:1},{value:"Handler function",paraId:5,tocIndex:1},{value:"Example",paraId:6,tocIndex:1},{value:"Simple definition:",paraId:7,tocIndex:1},{value:`const middleware = new Middleware((ctx, next) => {
  await next();
});
`,paraId:8,tocIndex:1},{value:"Definition with relevant parameters:",paraId:9,tocIndex:1},{value:`const middleware = new Middleware({
  only: ['create', 'update'],
  async handler(ctx, next) {
    await next();
  },
});
`,paraId:10,tocIndex:1},{value:"getHandler()",paraId:11},{value:"Get the orchestrated handler functions.",paraId:12,tocIndex:3},{value:"Example",paraId:13,tocIndex:3},{value:"The following middleware will output ",paraId:14,tocIndex:3},{value:"1",paraId:14,tocIndex:3},{value:" and then ",paraId:14,tocIndex:3},{value:"2",paraId:14,tocIndex:3},{value:" when requested.",paraId:14,tocIndex:3},{value:`const middleware = new Middleware((ctx, next) => {
  console.log(1);
  await next();
});

middleware.use(async (ctx, next) => {
  console.log(2);
  await next();
});

app.resourcer.use(middleware.getHandler());
`,paraId:15,tocIndex:3},{value:"use()",paraId:11},{value:"Add a middleware function to the current middleware. Used to provide extension points for the middleware. See ",paraId:16,tocIndex:4},{value:"getHandler()",paraId:16,tocIndex:4},{value:" for the examples.",paraId:16,tocIndex:4},{value:"Signature",paraId:17,tocIndex:4},{value:"use(middleware: Function)",paraId:18,tocIndex:4},{value:"Parameter",paraId:19,tocIndex:4},{value:"Name",paraId:20,tocIndex:4},{value:"Type",paraId:20,tocIndex:4},{value:"Default",paraId:20,tocIndex:4},{value:"Description",paraId:20,tocIndex:4},{value:"middleware",paraId:20,tocIndex:4},{value:"Function",paraId:20,tocIndex:4},{value:"-",paraId:20,tocIndex:4},{value:"Handler function of the middleware",paraId:20,tocIndex:4},{value:"disuse()",paraId:11},{value:"Remove the middleware functions that have been added to the current middleware.",paraId:21,tocIndex:5},{value:"Signature",paraId:22,tocIndex:5},{value:"disuse(middleware: Function)",paraId:23,tocIndex:5},{value:"Parameter",paraId:24,tocIndex:5},{value:"Name",paraId:25,tocIndex:5},{value:"Type",paraId:25,tocIndex:5},{value:"Default",paraId:25,tocIndex:5},{value:"Description",paraId:25,tocIndex:5},{value:"middleware",paraId:25,tocIndex:5},{value:"Function",paraId:25,tocIndex:5},{value:"-",paraId:25,tocIndex:5},{value:"Handler function of the middleware",paraId:25,tocIndex:5},{value:"Example",paraId:26,tocIndex:5},{value:"The following example will only output ",paraId:27,tocIndex:5},{value:"1",paraId:27,tocIndex:5},{value:" when requested, the output of ",paraId:27,tocIndex:5},{value:"2",paraId:27,tocIndex:5},{value:" in fn1 will not be executed.",paraId:27,tocIndex:5},{value:`const middleware = new Middleware((ctx, next) => {
  console.log(1);
  await next();
});

async function fn1(ctx, next) {
  console.log(2);
  await next();
}

middleware.use(fn1);

app.resourcer.use(middleware.getHandler());

middleware.disuse(fn1);
`,paraId:28,tocIndex:5},{value:"canAccess()",paraId:11},{value:"Check whether the current middleware is to be invoked for a specific action, it is usually handled by the resourcer internally.",paraId:29,tocIndex:6},{value:"Signature",paraId:30,tocIndex:6},{value:"canAccess(name: string): boolean",paraId:31,tocIndex:6},{value:"Parameter",paraId:32,tocIndex:6},{value:"Name",paraId:33,tocIndex:6},{value:"Type",paraId:33,tocIndex:6},{value:"Default",paraId:33,tocIndex:6},{value:"Description",paraId:33,tocIndex:6},{value:"name",paraId:33,tocIndex:6},{value:"string",paraId:33,tocIndex:6},{value:"-",paraId:33,tocIndex:6},{value:"Name of the action",paraId:33,tocIndex:6},{value:"branch()",paraId:11},{value:"Create a branch middleware for branching in the middleware.",paraId:34,tocIndex:8},{value:"Signature",paraId:35,tocIndex:8},{value:"branch(map: { [key: string]: Function }, reducer: Function, options): Function",paraId:36,tocIndex:8},{value:"Parameter",paraId:37,tocIndex:8},{value:"Name",paraId:38,tocIndex:8},{value:"Type",paraId:38,tocIndex:8},{value:"Default",paraId:38,tocIndex:8},{value:"Description",paraId:38,tocIndex:8},{value:"map",paraId:38,tocIndex:8},{value:"{ [key: string]: Function }",paraId:38,tocIndex:8},{value:"-",paraId:38,tocIndex:8},{value:"Mapping table of the branch handler function, key names are given by subsequent calculation functions when called",paraId:38,tocIndex:8},{value:"reducer",paraId:38,tocIndex:8},{value:"(ctx) => string",paraId:38,tocIndex:8},{value:"-",paraId:38,tocIndex:8},{value:"Calculation function, it is used to calculate the key name of the branch based on the context",paraId:38,tocIndex:8},{value:"options?",paraId:38,tocIndex:8},{value:"Object",paraId:38,tocIndex:8},{value:"-",paraId:38,tocIndex:8},{value:"Configuration items of the branch",paraId:38,tocIndex:8},{value:"options.keyNotFound?",paraId:38,tocIndex:8},{value:"Function",paraId:38,tocIndex:8},{value:"ctx.throw(404)",paraId:38,tocIndex:8},{value:"Handler function when key name is not found",paraId:38,tocIndex:8},{value:"options.handlerNotSet?",paraId:38,tocIndex:8},{value:"Function",paraId:38,tocIndex:8},{value:"ctx.throw(404)",paraId:38,tocIndex:8},{value:"The function when no handler function is defined",paraId:38,tocIndex:8},{value:"Example",paraId:39,tocIndex:8},{value:"When authenticating user, determine what to do next according to the value of the ",paraId:40,tocIndex:8},{value:"authenticator",paraId:40,tocIndex:8},{value:" parameter in the query section of the request URL.",paraId:40,tocIndex:8},{value:`app.resourcer.use(
  branch(
    {
      password: async (ctx, next) => {
        // ...
      },
      sms: async (ctx, next) => {
        // ...
      },
    },
    (ctx) => {
      return ctx.action.params.authenticator ?? 'password';
    },
  ),
);
`,paraId:41,tocIndex:8}]}}]);
