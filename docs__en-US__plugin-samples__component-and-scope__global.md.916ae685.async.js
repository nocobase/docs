"use strict";(self.webpackChunknocobase_docs=self.webpackChunknocobase_docs||[]).push([[5810],{496171:function(d,s,n){n.r(s);var l=n(572269),u=n(793359),p=n(861788),x=n(719977),m=n(20190),t=n(24268),h=n(496057),_=n(585939),v=n(28484),I=n(635206),g=n(375553),j=n(156266),f=n(572333),P=n(841118),b=n(39297),C=n(868526),E=n(605019),o=n(614651),c=n(280936),i=n(667294),a=n(923766),e=n(785893);function r(){return(0,e.jsx)(o.dY,{children:(0,e.jsx)(i.Suspense,{fallback:(0,e.jsx)(c.Z,{}),children:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"markdown",children:[(0,e.jsxs)("h1",{id:"global-registration-of-component-and-scope",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#global-registration-of-component-and-scope",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Global Registration of Component and Scope"]}),(0,e.jsxs)("h2",{id:"example-explanation",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#example-explanation",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Example Explanation"]}),(0,e.jsxs)("p",{children:[a.texts[0].value,(0,e.jsx)("a",{href:"https://client.docs.nocobase.com/core/ui-schema/schema-component#schemacomponent-1",children:a.texts[1].value}),a.texts[2].value,(0,e.jsx)("code",{children:a.texts[3].value}),a.texts[4].value]}),(0,e.jsxs)("p",{children:[a.texts[5].value,(0,e.jsx)("a",{href:"https://github.com/nocobase/plugin-samples/tree/main/packages/plugins/%40nocobase-sample/plugin-component-and-scope-global",children:a.texts[6].value}),a.texts[7].value]}),(0,e.jsxs)("h2",{id:"initializing-the-plugin",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#initializing-the-plugin",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Initializing the Plugin"]}),(0,e.jsxs)("p",{children:[a.texts[8].value,(0,e.jsx)(o.rU,{to:"/development/your-first-plugin",children:a.texts[9].value}),a.texts[10].value]}),(0,e.jsx)(t.Z,{lang:"bash",children:a.texts[11].value}),(0,e.jsx)("p",{children:a.texts[12].value}),(0,e.jsx)(t.Z,{lang:"bash",children:a.texts[13].value}),(0,e.jsx)("p",{children:a.texts[14].value}),(0,e.jsx)(t.Z,{lang:"bash",children:a.texts[15].value}),(0,e.jsxs)("p",{children:[a.texts[16].value,(0,e.jsx)("a",{href:"http://localhost:13000/admin/pm/list/local/",children:a.texts[17].value}),a.texts[18].value]}),(0,e.jsxs)("h2",{id:"function-implementation",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#function-implementation",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Function Implementation"]}),(0,e.jsxs)("h3",{id:"1-creating-a-custom-page",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#1-creating-a-custom-page",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"1. Creating a Custom Page"]}),(0,e.jsxs)("p",{children:[a.texts[19].value,(0,e.jsx)("code",{children:a.texts[20].value}),a.texts[21].value]}),(0,e.jsx)(t.Z,{lang:"tsx",children:a.texts[22].value}),(0,e.jsxs)("h3",{id:"2-global-registration-of-components-and-routes",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#2-global-registration-of-components-and-routes",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"2. Global Registration of Components and Routes"]}),(0,e.jsxs)("p",{children:[a.texts[23].value,(0,e.jsx)(o.rU,{to:"/plugin-samples/router/add-page",children:a.texts[24].value}),a.texts[25].value]}),(0,e.jsxs)("p",{children:[a.texts[26].value,(0,e.jsx)("code",{children:a.texts[27].value}),a.texts[28].value]}),(0,e.jsx)(t.Z,{lang:"tsx",children:a.texts[29].value}),(0,e.jsxs)("p",{children:[a.texts[30].value,(0,e.jsx)("code",{children:a.texts[31].value}),a.texts[32].value,(0,e.jsx)("code",{children:a.texts[33].value}),a.texts[34].value,(0,e.jsx)("code",{children:a.texts[35].value}),a.texts[36].value,(0,e.jsx)("code",{children:a.texts[37].value}),a.texts[38].value]}),(0,e.jsxs)("p",{children:[a.texts[39].value,(0,e.jsx)("a",{href:"http://localhost:13000/admin/custom-page1",children:a.texts[40].value}),a.texts[41].value,(0,e.jsx)("code",{children:a.texts[42].value}),a.texts[43].value]}),(0,e.jsx)("p",{children:(0,e.jsx)("img",{src:"https://static-docs.nocobase.com/img_v3_02av_55c3115b-f4b6-4c24-8ea2-914869d498bg.jpg",alt:"img_v3_02av_55c3115b-f4b6-4c24-8ea2-914869d498bg"})}),(0,e.jsxs)("h3",{id:"3-using-schemacomponent-to-render-a-schema",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#3-using-schemacomponent-to-render-a-schema",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"3. Using ",(0,e.jsx)("code",{children:a.texts[44].value})," to Render a Schema"]}),(0,e.jsx)("p",{children:a.texts[45].value}),(0,e.jsxs)("ul",{children:[(0,e.jsx)("li",{children:(0,e.jsx)(o.rU,{to:"/development/client/ui-schema/what-is-ui-schema",children:a.texts[46].value})}),(0,e.jsx)("li",{children:(0,e.jsx)("a",{href:"https://client.docs.nocobase.com/core/ui-schema/schema-component#schemacomponent-1",children:a.texts[47].value})}),(0,e.jsx)("li",{children:(0,e.jsx)(o.rU,{to:"/development/client/ui-schema/what-is-ui-schema#x-component-props-and-x-use-component-props",children:a.texts[48].value})}),(0,e.jsx)("li",{children:(0,e.jsx)("a",{href:"https://client.docs.nocobase.com/core/ui-schema/designable#usefieldschema",children:a.texts[49].value})})]}),(0,e.jsxs)("p",{children:[a.texts[50].value,(0,e.jsx)("code",{children:a.texts[51].value}),a.texts[52].value]}),(0,e.jsx)(t.Z,{lang:"tsx",children:a.texts[53].value}),(0,e.jsxs)("ul",{children:[(0,e.jsxs)("li",{children:[a.texts[54].value,(0,e.jsx)("code",{children:a.texts[55].value}),a.texts[56].value,(0,e.jsx)("code",{children:a.texts[57].value}),a.texts[58].value]}),(0,e.jsxs)("li",{children:[a.texts[59].value,(0,e.jsx)("code",{children:a.texts[60].value}),a.texts[61].value,(0,e.jsx)("code",{children:a.texts[62].value}),a.texts[63].value,(0,e.jsx)("code",{children:a.texts[64].value}),a.texts[65].value]}),(0,e.jsxs)("li",{children:[a.texts[66].value,(0,e.jsx)("a",{href:"https://client.docs.nocobase.com/core/ui-schema/schema-component#schemacomponent-1",children:a.texts[67].value}),a.texts[68].value,(0,e.jsx)("code",{children:a.texts[69].value}),a.texts[70].value]})]}),(0,e.jsxs)("p",{children:[a.texts[71].value,(0,e.jsx)("code",{children:a.texts[72].value}),a.texts[73].value,(0,e.jsx)("code",{children:a.texts[74].value}),a.texts[75].value,(0,e.jsx)("code",{children:a.texts[76].value}),a.texts[77].value]}),(0,e.jsx)(t.Z,{lang:"diff",children:a.texts[78].value}),(0,e.jsxs)("p",{children:[a.texts[79].value,(0,e.jsx)("a",{href:"http://localhost:13000/admin/custom-page1",children:a.texts[80].value}),a.texts[81].value,(0,e.jsx)("code",{children:a.texts[82].value}),a.texts[83].value]}),(0,e.jsx)("p",{children:(0,e.jsx)("img",{src:"https://static-docs.nocobase.com/img_v3_02av_79e76ad8-d697-4e3b-aaa9-46ed90e2bb9g.jpg",alt:"img_v3_02av_79e76ad8-d697-4e3b-aaa9-46ed90e2bb9g"})}),(0,e.jsxs)("h2",{id:"packaging-and-uploading-to-production",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#packaging-and-uploading-to-production",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Packaging and Uploading to Production"]}),(0,e.jsxs)("p",{children:[a.texts[84].value,(0,e.jsx)(o.rU,{to:"/development/your-first-plugin#building-and-packaging-the-plugin",children:a.texts[85].value}),a.texts[86].value]}),(0,e.jsx)("p",{children:a.texts[87].value}),(0,e.jsx)(t.Z,{lang:"bash",children:a.texts[88].value}),(0,e.jsxs)("p",{children:[a.texts[89].value,(0,e.jsx)("code",{children:a.texts[90].value}),a.texts[91].value]}),(0,e.jsx)(t.Z,{lang:"bash",children:a.texts[92].value}),(0,e.jsxs)("p",{children:[a.texts[93].value,(0,e.jsx)("code",{children:a.texts[94].value}),a.texts[95].value,(0,e.jsx)(o.rU,{to:"/welcome/getting-started/plugin",children:a.texts[96].value}),a.texts[97].value]})]})})})})}s.default=r},923766:function(d,s,n){n.r(s),n.d(s,{texts:function(){return l}});const l=[{value:"Create a new page and use the ",paraId:0,tocIndex:1},{value:"SchemaComponent",paraId:0,tocIndex:1},{value:" to render some content. The route component and the components within the ",paraId:0,tocIndex:1},{value:"SchemaComponent",paraId:0,tocIndex:1},{value:" are globally registered.",paraId:0,tocIndex:1},{value:"You can view the complete example code for this documentation in the ",paraId:1,tocIndex:1},{value:"plugin-samples",paraId:1,tocIndex:1},{value:" repository.",paraId:1,tocIndex:1},{value:"Following the instructions from ",paraId:2,tocIndex:2},{value:"Creating Your First Plugin",paraId:3,tocIndex:2},{value:", if you don\u2019t already have a project, you can create one. If you have a project or have cloned the source code, you can skip this step.",paraId:2,tocIndex:2},{value:`yarn create nocobase-app my-nocobase-app -d postgres
cd my-nocobase-app
yarn install
yarn nocobase install
`,paraId:4,tocIndex:2},{value:"Next, initialize a plugin and add it to the system:",paraId:5,tocIndex:2},{value:`yarn pm create @nocobase-sample/plugin-component-and-scope-global
yarn pm enable @nocobase-sample/plugin-component-and-scope-global
`,paraId:6,tocIndex:2},{value:"Then, start the project:",paraId:7,tocIndex:2},{value:`yarn dev
`,paraId:8,tocIndex:2},{value:"After logging in, visit ",paraId:9,tocIndex:2},{value:"http://localhost:13000/admin/pm/list/local/",paraId:9,tocIndex:2},{value:" to check that the plugin has been installed and enabled.",paraId:9,tocIndex:2},{value:"Create the ",paraId:10,tocIndex:4},{value:"packages/plugins/@nocobase-sample/plugin-component-and-scope-global/src/client/CustomPage.tsx",paraId:10,tocIndex:4},{value:" file with the following content:",paraId:10,tocIndex:4},{value:`import React from "react"

export const SamplesCustomPage = () => {
  return <div>TODO</div>
}
`,paraId:11,tocIndex:4},{value:"For detailed instructions on creating a custom page, refer to the ",paraId:12,tocIndex:5},{value:"Add Page",paraId:13,tocIndex:5},{value:" documentation.",paraId:12,tocIndex:5},{value:"Modify the ",paraId:14,tocIndex:5},{value:"packages/plugins/@nocobase-sample/plugin-component-and-scope-global/src/index.ts",paraId:14,tocIndex:5},{value:" file as follows:",paraId:14,tocIndex:5},{value:`import { Plugin } from '@nocobase/client';
import { SamplesCustomPage } from './CustomPage'

export class PluginComponentAndScopeGlobalClient extends Plugin {
  async load() {
    this.app.router.add('admin.custom-page1', {
      path: '/admin/custom-page1',
      Component: 'SamplesCustomPage',
    })

    this.app.addComponents({ SamplesCustomPage })
  }
}

export default PluginComponentAndScopeGlobalClient;
`,paraId:15,tocIndex:5},{value:"We register the ",paraId:16,tocIndex:5},{value:"SamplesCustomPage",paraId:16,tocIndex:5},{value:" component globally using the ",paraId:16,tocIndex:5},{value:"app.addComponents()",paraId:16,tocIndex:5},{value:" method, then register a route using the ",paraId:16,tocIndex:5},{value:"app.router.add()",paraId:16,tocIndex:5},{value:" method. The ",paraId:16,tocIndex:5},{value:"Component",paraId:16,tocIndex:5},{value:" field, being a string type, will automatically search for the globally registered component.",paraId:16,tocIndex:5},{value:"Afterward, visit ",paraId:17,tocIndex:5},{value:"http://localhost:13000/admin/custom-page1",paraId:17,tocIndex:5},{value:" to see the content of the ",paraId:17,tocIndex:5},{value:"SamplesCustomPage",paraId:17,tocIndex:5},{value:" component.",paraId:17,tocIndex:5},{value:"SchemaComponent",paraId:18},{value:"We first need to understand the following concepts:",paraId:19,tocIndex:6},{value:"Schema Protocol",paraId:20,tocIndex:6},{value:"SchemaComponent",paraId:21,tocIndex:6},{value:"withDynamicSchemaProps",paraId:22,tocIndex:6},{value:"useFieldSchema()",paraId:21,tocIndex:6},{value:"Modify the ",paraId:23,tocIndex:6},{value:"packages/plugins/@nocobase-sample/plugin-component-and-scope-global/src/client/CustomPage.tsx",paraId:23,tocIndex:6},{value:" file as follows:",paraId:23,tocIndex:6},{value:`import { ISchema, SchemaComponent, withDynamicSchemaProps } from "@nocobase/client"
import { uid } from '@formily/shared'
import { useFieldSchema } from '@formily/react'
import React, { FC } from "react"

export const SamplesHello: FC<{ name: string }> = withDynamicSchemaProps(({ name }) => {
  return <div>hello {name}</div>
})

export const useSamplesHelloProps = () => {
  const schema = useFieldSchema();
  return { name: schema.name }
}

const schema: ISchema = {
  type: 'void',
  name: uid(),
  properties: {
    demo1: {
      type: 'void',
      'x-component': 'SamplesHello',
      'x-component-props': {
        name: 'demo1',
      },
    },
    demo2: {
      type: 'void',
      'x-component': 'SamplesHello',
      'x-use-component-props': 'useSamplesHelloProps',
    },
  }
}

export const SamplesCustomPage = () => {
  return <SchemaComponent schema={schema}></SchemaComponent>
}
`,paraId:24,tocIndex:6},{value:"We defined and exported the ",paraId:25,tocIndex:6},{value:"SamplesHello",paraId:25,tocIndex:6},{value:" and ",paraId:25,tocIndex:6},{value:"useSamplesHelloProps",paraId:25,tocIndex:6},{value:" components.",paraId:25,tocIndex:6},{value:"We defined a ",paraId:25,tocIndex:6},{value:"schema",paraId:25,tocIndex:6},{value:" object that contains ",paraId:25,tocIndex:6},{value:"'x-component': 'SamplesHello'",paraId:25,tocIndex:6},{value:" and ",paraId:25,tocIndex:6},{value:"'x-use-component-props': 'useSamplesHelloProps'",paraId:25,tocIndex:6},{value:", both of which are string types.",paraId:25,tocIndex:6},{value:"We used the ",paraId:25,tocIndex:6},{value:"SchemaComponent",paraId:25,tocIndex:6},{value:" component to render the ",paraId:25,tocIndex:6},{value:"schema",paraId:25,tocIndex:6},{value:" object.",paraId:25,tocIndex:6},{value:"Next, we need to register ",paraId:26,tocIndex:6},{value:"SamplesHello",paraId:26,tocIndex:6},{value:" and ",paraId:26,tocIndex:6},{value:"useSamplesHelloProps",paraId:26,tocIndex:6},{value:" globally. Modify the ",paraId:26,tocIndex:6},{value:"packages/plugins/@nocobase-sample/plugin-component-and-scope-global/src/index.ts",paraId:26,tocIndex:6},{value:" file as follows:",paraId:26,tocIndex:6},{value:`import { Plugin } from '@nocobase/client';
- import { SamplesCustomPage } from './CustomPage'
+ import { SamplesCustomPage, SamplesHello, useSamplesHelloProps } from './CustomPage'

export class PluginComponentAndScopeGlobalClient extends Plugin {
  async load() {
    this.app.router.add('admin.custom-page1', {
      path: '/admin/custom-page1',
      Component: 'SamplesCustomPage',
    })

-   this.app.addComponents({ SamplesCustomPage })
+   this.app.addComponents({ SamplesCustomPage, SamplesHello })
+   this.app.addScopes({ useSamplesHelloProps })
  }
}

export default PluginComponentAndScopeGlobalClient;
`,paraId:27,tocIndex:6},{value:"Afterward, visit ",paraId:28,tocIndex:6},{value:"http://localhost:13000/admin/custom-page1",paraId:28,tocIndex:6},{value:" to see the content of the ",paraId:28,tocIndex:6},{value:"CustomPage",paraId:28,tocIndex:6},{value:" component.",paraId:28,tocIndex:6},{value:"Following the instructions in ",paraId:29,tocIndex:7},{value:"Building and Packaging the Plugin",paraId:30,tocIndex:7},{value:", you can package the plugin and upload it to the production environment.",paraId:29,tocIndex:7},{value:"If you have cloned the source code, first perform a full build to include plugin dependencies.",paraId:31,tocIndex:7},{value:`yarn build
`,paraId:32,tocIndex:7},{value:"If the project was created using ",paraId:33,tocIndex:7},{value:"create-nocobase-app",paraId:33,tocIndex:7},{value:", simply run:",paraId:33,tocIndex:7},{value:`yarn build @nocobase-sample/plugin-component-and-scope-global --tar
`,paraId:34,tocIndex:7},{value:"After this, you\u2019ll find the ",paraId:35,tocIndex:7},{value:"storage/tar/@nocobase-sample/plugin-component-and-scope-global.tar.gz",paraId:35,tocIndex:7},{value:" file, which can be installed using the ",paraId:35,tocIndex:7},{value:"upload method",paraId:36,tocIndex:7},{value:".",paraId:35,tocIndex:7}]}}]);
