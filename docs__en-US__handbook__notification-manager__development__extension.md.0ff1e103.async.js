"use strict";(self.webpackChunknocobase_docs=self.webpackChunknocobase_docs||[]).push([[60957],{776608:function(s,o,a){a.r(o);var i=a(572269),x=a(793359),u=a(861788),m=a(719977),p=a(20190),t=a(24268),h=a(496057),_=a(585939),v=a(28484),g=a(635206),I=a(375553),f=a(156266),j=a(572333),C=a(841118),E=a(39297),P=a(868526),M=a(605019),r=a(614651),l=a(280936),d=a(667294),n=a(221346),e=a(785893);function c(){return(0,e.jsx)(r.dY,{children:(0,e.jsx)(d.Suspense,{fallback:(0,e.jsx)(l.Z,{}),children:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"markdown",children:[(0,e.jsxs)("h2",{id:"extension",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#extension",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Extension"]}),(0,e.jsx)("p",{children:n.texts[0].value}),(0,e.jsxs)("h2",{id:"client",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#client",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Client"]}),(0,e.jsxs)("h3",{id:"channel-type-registration",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#channel-type-registration",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Channel Type Registration"]}),(0,e.jsxs)("p",{children:[n.texts[1].value,(0,e.jsx)("code",{children:n.texts[2].value}),n.texts[3].value]}),(0,e.jsx)(t.Z,{lang:"ts",children:n.texts[4].value}),(0,e.jsxs)("h2",{id:"server",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#server",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Server"]}),(0,e.jsxs)("h3",{id:"extending-abstract-class",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#extending-abstract-class",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Extending Abstract Class"]}),(0,e.jsxs)("p",{children:[n.texts[5].value,(0,e.jsx)("code",{children:n.texts[6].value}),n.texts[7].value,(0,e.jsx)("code",{children:n.texts[8].value}),n.texts[9].value]}),(0,e.jsx)(t.Z,{lang:"ts",children:n.texts[10].value}),(0,e.jsxs)("h3",{id:"server-registration",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#server-registration",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Server Registration"]}),(0,e.jsxs)("p",{children:[n.texts[11].value,(0,e.jsx)("code",{children:n.texts[12].value}),n.texts[13].value]}),(0,e.jsx)(t.Z,{lang:"ts",children:n.texts[14].value}),(0,e.jsxs)("h2",{id:"full-example",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#full-example",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Full Example"]}),(0,e.jsx)("p",{children:n.texts[15].value}),(0,e.jsxs)("h3",{id:"plugin-creation",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#plugin-creation",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Plugin Creation"]}),(0,e.jsx)("ol",{children:(0,e.jsxs)("li",{children:[n.texts[16].value,(0,e.jsx)("code",{children:n.texts[17].value})]})}),(0,e.jsxs)("h3",{id:"client-development",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#client-development",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Client Development"]}),(0,e.jsxs)("p",{children:[n.texts[18].value,(0,e.jsx)("code",{children:n.texts[19].value}),n.texts[20].value,(0,e.jsx)("code",{children:n.texts[21].value}),n.texts[22].value]}),(0,e.jsxs)("h4",{id:"channelconfigform",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#channelconfigform",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"ChannelConfigForm"]}),(0,e.jsxs)("p",{children:[n.texts[23].value,(0,e.jsx)("code",{children:n.texts[24].value}),n.texts[25].value,(0,e.jsx)("code",{children:n.texts[26].value}),n.texts[27].value]}),(0,e.jsx)(t.Z,{lang:"ts",children:n.texts[28].value}),(0,e.jsxs)("h4",{id:"messageconfigform",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#messageconfigform",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"MessageConfigForm"]}),(0,e.jsxs)("p",{children:[n.texts[29].value,(0,e.jsx)("code",{children:n.texts[30].value}),n.texts[31].value,(0,e.jsx)("code",{children:n.texts[32].value}),n.texts[33].value,(0,e.jsx)("code",{children:n.texts[34].value}),n.texts[35].value,(0,e.jsx)("code",{children:n.texts[36].value}),n.texts[37].value]}),(0,e.jsx)(t.Z,{lang:"ts",children:n.texts[38].value}),(0,e.jsxs)("h4",{id:"client-component-registration",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#client-component-registration",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Client Component Registration"]}),(0,e.jsxs)("p",{children:[n.texts[39].value,(0,e.jsx)("code",{children:n.texts[40].value}),n.texts[41].value]}),(0,e.jsx)(t.Z,{lang:"ts",children:n.texts[42].value}),(0,e.jsx)("p",{children:n.texts[43].value}),(0,e.jsxs)("h3",{id:"server-development",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#server-development",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Server Development"]}),(0,e.jsxs)("p",{children:[n.texts[44].value,(0,e.jsx)("code",{children:n.texts[45].value}),n.texts[46].value,(0,e.jsx)("code",{children:n.texts[47].value}),n.texts[48].value,(0,e.jsx)("code",{children:n.texts[49].value}),n.texts[50].value,(0,e.jsx)("code",{children:n.texts[51].value}),n.texts[52].value]}),(0,e.jsx)(t.Z,{lang:"ts",children:n.texts[53].value}),(0,e.jsxs)("p",{children:[n.texts[54].value,(0,e.jsx)("code",{children:n.texts[55].value}),n.texts[56].value]}),(0,e.jsx)(t.Z,{lang:"ts",children:n.texts[57].value}),(0,e.jsxs)("h3",{id:"plugin-registration-and-launch",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#plugin-registration-and-launch",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Plugin Registration and Launch"]}),(0,e.jsxs)("ol",{children:[(0,e.jsxs)("li",{children:[n.texts[58].value,(0,e.jsx)("code",{children:n.texts[59].value})]}),(0,e.jsxs)("li",{children:[n.texts[60].value,(0,e.jsx)("code",{children:n.texts[61].value})]})]}),(0,e.jsxs)("h3",{id:"channel-configuration",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#channel-configuration",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Channel Configuration"]}),(0,e.jsxs)("p",{children:[n.texts[62].value,(0,e.jsx)("code",{children:n.texts[63].value}),n.texts[64].value,(0,e.jsx)("img",{src:"https://static-docs.nocobase.com/20241009164207-2024-10-09-16-42-08.png",alt:"20241009164207-2024-10-09-16-42-08"})]}),(0,e.jsxs)("p",{children:[n.texts[65].value,(0,e.jsx)("img",{src:"https://static-docs.nocobase.com/20250418074409-2025-04-18-07-44-09.png",alt:"20250418074409-2025-04-18-07-44-09"})]}),(0,e.jsxs)("p",{children:[n.texts[66].value,(0,e.jsx)("img",{src:"https://static-docs.nocobase.com/20250418074832-2025-04-18-07-48-32.png",alt:"20250418074832-2025-04-18-07-48-32"})]}),(0,e.jsxs)("p",{children:[n.texts[67].value,(0,e.jsx)("img",{src:"https://static-docs.nocobase.com/20250418081746-2025-04-18-08-17-48.png",alt:"20250418081746-2025-04-18-08-17-48"})]})]})})})})}o.default=c},221346:function(s,o,a){a.r(o),a.d(o,{texts:function(){return i}});const i=[{value:"NocoBase supports the expansion of notification channel types, such as SMS notifications and app push notifications,etc.",paraId:0,tocIndex:0},{value:"The client channel configuration and message configuration interface are registered through the ",paraId:1,tocIndex:2},{value:"registerChannelType",paraId:1,tocIndex:2},{value:" method provided by the notification management plugin client:",paraId:1,tocIndex:2},{value:`import PluginNotificationManagerClient from '@nocobase/plugin-notification-manager/client';

class PluginNotificationExampleClient extends Plugin {
  async afterAdd() {}

  async beforeLoad() {}

  async load() {
    const notification = this.pm.get(PluginNotificationManagerClient);
    notification.registerChannelType({
      title: 'Example SMS', // Channel type name
      type: 'example-sms',  // Channel type identifier
      components: {
        ChannelConfigForm,   // Channel configuration form
        MessageConfigForm,   // Message configuration form
      },
    });
  }
}

export default PluginNotificationExampleClient;
`,paraId:2,tocIndex:2},{value:"The core of server development involves extending the ",paraId:3,tocIndex:4},{value:"BaseNotificationChannel",paraId:3,tocIndex:4},{value:" abstract class and implementing the ",paraId:3,tocIndex:4},{value:"send",paraId:3,tocIndex:4},{value:" method, which contains the business logic for sending notifications through the extended plugin.",paraId:3,tocIndex:4},{value:`import { BaseNotificationChannel } from '@nocobase/plugin-notification-manager';

export class ExampleServer extends BaseNotificationChannel {
  async send(args): Promise<any> {
    console.log('ExampleServer send', args);
    return { status: 'success', message: args.message };
  }
}
`,paraId:4,tocIndex:4},{value:"The ",paraId:5,tocIndex:5},{value:"registerChannelType",paraId:5,tocIndex:5},{value:" method of the notification server core should be called to register the server implementation class in the core:",paraId:5,tocIndex:5},{value:`import PluginNotificationManagerServer from '@nocobase/plugin-notification-manager';
import { Plugin } from '@nocobase/server';
import { ExampleServer } from './example-server';
export class PluginNotificationExampleServer extends Plugin {
  async load() {
    const notificationServer = this.pm.get(PluginNotificationManagerServer) as PluginNotificationManagerServer;
    notificationServer.registerChannelType({ type: 'example-sms', Channel: ExampleServer });
  }
}

export default PluginNotificationExampleServer;
`,paraId:6,tocIndex:5},{value:`Here is a sample notification extension to describe in detail how to develop an extension.
Suppose we want to add SMS notification to NocoBase using a platform's SMS gateway.`,paraId:7,tocIndex:6},{value:"Run the command to create the plugin ",paraId:8,tocIndex:7},{value:"yarn pm add @nocobase/plugin-notification-example",paraId:8,tocIndex:7},{value:"For the client, develop two form components: ",paraId:9,tocIndex:8},{value:"ChannelConfigForm",paraId:9,tocIndex:8},{value:" (Channel Configuration Form) and ",paraId:9,tocIndex:8},{value:"MessageConfigForm",paraId:9,tocIndex:8},{value:" (Message Configuration Form).",paraId:9,tocIndex:8},{value:"To send SMS messages, an API key and secret are required. Create a new file named ",paraId:10,tocIndex:9},{value:"ChannelConfigForm.tsx",paraId:10,tocIndex:9},{value:" in the ",paraId:10,tocIndex:9},{value:"src/client",paraId:10,tocIndex:9},{value:" directory:",paraId:10,tocIndex:9},{value:`import React from 'react';
import { SchemaComponent } from '@nocobase/client';
import useLocalTranslation from './useLocalTranslation';

const ChannelConfigForm = () => {
  const t = useLocalTranslation();
  return (
    <SchemaComponent
      scope={{ t }}
      schema={{
        type: 'object',
        properties: {
          apiKey: {
            'x-decorator': 'FormItem',
            type: 'string',
            title: '{{t("Transport")}}',
            'x-component': 'Input',
          },
          secret: {
            'x-decorator': 'FormItem',
            type: 'string',
            title: '{{t("Transport")}}',
            'x-component': 'Input',
          },
        },
      }}
    />
  );
};

export default ChannelConfigForm;
`,paraId:11,tocIndex:9},{value:"The message configuration form mainly includes the configuration for recipients (",paraId:12,tocIndex:10},{value:"receivers",paraId:12,tocIndex:10},{value:") and message content (",paraId:12,tocIndex:10},{value:"content",paraId:12,tocIndex:10},{value:"). Create a new file named ",paraId:12,tocIndex:10},{value:"MessageConfigForm.tsx",paraId:12,tocIndex:10},{value:" in the ",paraId:12,tocIndex:10},{value:"src/client",paraId:12,tocIndex:10},{value:" directory:",paraId:12,tocIndex:10},{value:`import React from 'react';
import { SchemaComponent } from '@nocobase/client';
import useLocalTranslation from './useLocalTranslation';

const MessageConfigForm = ({ variableOptions }) => {
  const { t } = useLocalTranslation();
  return (
    <SchemaComponent
      scope={{ t }}
      schema={{
        type: 'object',
        properties: {
          to: {
            type: 'array',
            required: true,
            title: \`{{t("Receivers")}}\`,
            'x-decorator': 'FormItem',
            'x-component': 'ArrayItems',
            items: {
              type: 'void',
              'x-component': 'Space',
              properties: {
                sort: {
                  type: 'void',
                  'x-decorator': 'FormItem',
                  'x-component': 'ArrayItems.SortHandle',
                },
                input: {
                  type: 'string',
                  'x-decorator': 'FormItem',
                  'x-component': 'Variable.Input',
                  'x-component-props': {
                    scope: variableOptions,
                    useTypedConstant: ['string'],
                    placeholder: \`{{t("Phone number")}}\`,
                  },
                },
                remove: {
                  type: 'void',
                  'x-decorator': 'FormItem',
                  'x-component': 'ArrayItems.Remove',
                },
              },
            },
            properties: {
              add: {
                type: 'void',
                title: \`{{t("Add phone number")}}\`,
                'x-component': 'ArrayItems.Addition',
              },
            },
          },
          content: {
            type: 'string',
            required: true,
            title: \`{{t("Content")}}\`,
            'x-decorator': 'FormItem',
            'x-component': 'Variable.RawTextArea',
            'x-component-props': {
              scope: variableOptions,
              placeholder: 'Hi,',
              autoSize: {
                minRows: 10,
              },
            },
          },
        },
      }}
    />
  );
};

export default MessageConfigForm
`,paraId:13,tocIndex:10},{value:'After developing the form configuration components, register them in the notification management core. Assume the platform name is "Example." Edit ',paraId:14,tocIndex:11},{value:"src/client/index.tsx",paraId:14,tocIndex:11},{value:" as follows:",paraId:14,tocIndex:11},{value:`import { Plugin } from '@nocobase/client';
import PluginNotificationManagerClient from '@nocobase/plugin-notification-manager/client';
import { tval } from '@nocobase/utils/client';
import ChannelConfigForm from './ChannelConfigForm';
import MessageConfigForm from './MessageConfigForm';

class PluginNotificationExampleClient extends Plugin {
  async afterAdd() {}

  async beforeLoad() {}

  async load() {
    const notification = this.pm.get(PluginNotificationManagerClient);
    notification.registerChannelType({
      title: tval('Example SMS', { ns: '@nocobase/plugin-notification-example' }),
      type: 'example-sms',
      components: {
        ChannelConfigForm,
        MessageConfigForm,
      },
    });
  }
}

export default PluginNotificationExampleClient;
`,paraId:15,tocIndex:11},{value:"At this point, the development of the client is complete",paraId:16,tocIndex:11},{value:"The core of server development involves extending the ",paraId:17,tocIndex:12},{value:"BaseNotificationChannel",paraId:17,tocIndex:12},{value:" abstract class and implementing the ",paraId:17,tocIndex:12},{value:"send",paraId:17,tocIndex:12},{value:" method. In the ",paraId:17,tocIndex:12},{value:"src/server",paraId:17,tocIndex:12},{value:" directory, add a file named ",paraId:17,tocIndex:12},{value:"example-server.ts",paraId:17,tocIndex:12},{value:":",paraId:17,tocIndex:12},{value:`import { BaseNotificationChannel } from '@nocobase/plugin-notification-manager';

export class ExampleServer extends BaseNotificationChannel {
  async send(args): Promise<any> {
    console.log('ExampleServer send', args);
    return { status: 'success', message: args.message };
  }
}
`,paraId:18,tocIndex:12},{value:"Next, register the server extension plugin by editing ",paraId:19,tocIndex:12},{value:"src/server/plugin.ts",paraId:19,tocIndex:12},{value:":",paraId:19,tocIndex:12},{value:`import PluginNotificationManagerServer from '@nocobase/plugin-notification-manager';
import { Plugin } from '@nocobase/server';
import { ExampleServer } from './example-server';
export class PluginNotificationExampleServer extends Plugin {
  async load() {
    const notificationServer = this.pm.get(PluginNotificationManagerServer) as PluginNotificationManagerServer;
    notificationServer.registerChannelType({ type: 'example-sms', Channel: ExampleServer });
  }
}

export default PluginNotificationExampleServer;
`,paraId:20,tocIndex:12},{value:"Run the registration command: ",paraId:21,tocIndex:13},{value:"yarn pm add @nocobase/plugin-notification-example",paraId:21,tocIndex:13},{value:"Run the enable command: ",paraId:21,tocIndex:13},{value:"yarn pm enable @nocobase/plugin-notification-example",paraId:21,tocIndex:13},{value:"Upon visiting the Notification management channel page, you can see that the ",paraId:22,tocIndex:14},{value:"Example SMS",paraId:22,tocIndex:14},{value:` channel has been enabled.
`,paraId:22,tocIndex:14},{value:`Add a sample channel.
`,paraId:23,tocIndex:14},{value:`Create a new workflow and configure the notification node.
`,paraId:24,tocIndex:14},{value:`Trigger the workflow execution to view the following information output in the console.
`,paraId:25,tocIndex:14}]}}]);
