"use strict";(self.webpackChunknocobase_docs=self.webpackChunknocobase_docs||[]).push([[8570],{636257:function(i,s,n){n.r(s);var l=n(572269),u=n(793359),x=n(861788),p=n(719977),h=n(20190),o=n(24268),m=n(496057),v=n(585939),I=n(28484),g=n(635206),f=n(375553),_=n(156266),j=n(572333),b=n(841118),P=n(39297),C=n(868526),y=n(605019),a=n(614651),d=n(280936),r=n(667294),t=n(914146),e=n(785893);function c(){return(0,e.jsx)(a.dY,{children:(0,e.jsx)(r.Suspense,{fallback:(0,e.jsx)(d.Z,{}),children:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"markdown",children:[(0,e.jsxs)("h1",{id:"form-configuration-page",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#form-configuration-page",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Form Configuration Page"]}),(0,e.jsxs)("h2",{id:"scenario-description",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#scenario-description",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Scenario Description"]}),(0,e.jsx)("p",{children:t.texts[0].value}),(0,e.jsxs)("h2",{id:"example-description",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#example-description",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Example Description"]}),(0,e.jsxs)("p",{children:[t.texts[1].value,(0,e.jsx)("code",{children:t.texts[2].value}),t.texts[3].value,(0,e.jsx)("code",{children:t.texts[4].value}),t.texts[5].value]}),(0,e.jsxs)("p",{children:[t.texts[6].value,(0,e.jsx)("a",{href:"https://github.com/nocobase/plugin-samples/tree/main/packages/plugins/%40nocobase-sample/plugin-settings-form",children:t.texts[7].value}),t.texts[8].value]}),(0,e.jsxs)("h2",{id:"initialize-the-plugin",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#initialize-the-plugin",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Initialize the Plugin"]}),(0,e.jsxs)("p",{children:[t.texts[9].value,(0,e.jsx)(a.rU,{to:"/development/your-fisrt-plugin",children:t.texts[10].value}),t.texts[11].value]}),(0,e.jsx)(o.Z,{lang:"bash",children:t.texts[12].value}),(0,e.jsx)("p",{children:t.texts[13].value}),(0,e.jsx)(o.Z,{lang:"bash",children:t.texts[14].value}),(0,e.jsx)("p",{children:t.texts[15].value}),(0,e.jsx)(o.Z,{lang:"bash",children:t.texts[16].value}),(0,e.jsxs)("p",{children:[t.texts[17].value,(0,e.jsx)("a",{href:"http://localhost:13000/admin/pm/list/local/",children:t.texts[18].value}),t.texts[19].value]}),(0,e.jsxs)("h2",{id:"backend-implementation",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#backend-implementation",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Backend Implementation"]}),(0,e.jsxs)("h3",{id:"1-create-the-database-table",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#1-create-the-database-table",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"1. Create the Database Table"]}),(0,e.jsx)("p",{children:t.texts[20].value}),(0,e.jsxs)("ul",{children:[(0,e.jsx)("li",{children:(0,e.jsx)(a.rU,{to:"/development/server/collections",children:t.texts[21].value})}),(0,e.jsx)("li",{children:(0,e.jsx)(a.rU,{to:"/development/server/collections/configure#%E5%9C%A8%E6%8F%92%E4%BB%B6%E4%BB%A3%E7%A0%81%E9%87%8C%E5%AE%9A%E4%B9%89",children:t.texts[22].value})}),(0,e.jsx)("li",{children:(0,e.jsx)(a.rU,{to:"/development/server/collections/options#field-type",children:t.texts[23].value})}),(0,e.jsx)("li",{children:(0,e.jsx)(a.rU,{to:"/api/database#definecollection",children:t.texts[24].value})}),(0,e.jsx)("li",{children:(0,e.jsx)(a.rU,{to:"/api/database/collection",children:t.texts[25].value})})]}),(0,e.jsxs)("p",{children:[t.texts[26].value,(0,e.jsx)("code",{children:t.texts[27].value}),t.texts[28].value]}),(0,e.jsx)(o.Z,{lang:"ts",children:t.texts[29].value}),(0,e.jsxs)("p",{children:[t.texts[30].value,(0,e.jsx)("code",{children:t.texts[31].value}),t.texts[32].value,(0,e.jsx)("code",{children:t.texts[33].value}),t.texts[34].value,(0,e.jsx)("code",{children:t.texts[35].value}),t.texts[36].value]}),(0,e.jsxs)("h3",{id:"2-execute-the-update",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#2-execute-the-update",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"2. Execute the Update"]}),(0,e.jsx)("p",{children:t.texts[37].value}),(0,e.jsx)(o.Z,{lang:"bash",children:t.texts[38].value}),(0,e.jsx)("p",{children:(0,e.jsx)("img",{src:"https://static-docs.nocobase.com/img_v3_02av_db5e9985-eb20-4420-a0b2-8a809ff05a5g.jpg",alt:"img_v3_02av_db5e9985-eb20-4420-a0b2-8a809ff05a5g"})}),(0,e.jsxs)("h2",{id:"frontend-implementation",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#frontend-implementation",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Frontend Implementation"]}),(0,e.jsxs)("h3",{id:"1-create-the-plugin-configuration-page",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#1-create-the-plugin-configuration-page",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"1. Create the Plugin Configuration Page"]}),(0,e.jsxs)("p",{children:[t.texts[39].value,(0,e.jsx)(a.rU,{to:"/plugin-samples/router/add-setting-page-single-route",children:t.texts[40].value}),t.texts[41].value]}),(0,e.jsxs)("p",{children:[t.texts[42].value,(0,e.jsx)("code",{children:t.texts[43].value}),t.texts[44].value]}),(0,e.jsx)(o.Z,{lang:"tsx",children:t.texts[45].value}),(0,e.jsxs)("p",{children:[t.texts[46].value,(0,e.jsx)("a",{href:"http://localhost:13000/admin/settings/@nocobase-sample/plugin-settings-form",children:t.texts[47].value}),t.texts[48].value]}),(0,e.jsx)("p",{children:(0,e.jsx)("img",{src:"https://static-docs.nocobase.com/img_v3_02av_c90b5767-97dd-4fef-8dd0-c7ff9a136a9g.jpg",alt:"img_v3_02av_c90b5767-97dd-4fef-8dd0-c7ff9a136a9g"})}),(0,e.jsxs)("h3",{id:"2-define-the-data-table-structure",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#2-define-the-data-table-structure",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"2. Define the Data Table Structure"]}),(0,e.jsx)("p",{children:t.texts[49].value}),(0,e.jsxs)("ul",{children:[(0,e.jsx)("li",{children:(0,e.jsx)(a.rU,{to:"/development/server/collections#field-component",children:t.texts[50].value})}),(0,e.jsx)("li",{children:(0,e.jsx)(a.rU,{to:"/development/server/collections/options#field-type",children:t.texts[51].value})}),(0,e.jsx)("li",{children:(0,e.jsx)(a.rU,{to:"/development/server/collections/options#field-interface",children:t.texts[52].value})}),(0,e.jsx)("li",{children:(0,e.jsx)(a.rU,{to:"/development/client/ui-schema/what-is-ui-schema",children:t.texts[53].value})}),(0,e.jsx)("li",{children:(0,e.jsx)("a",{href:"https://client.docs.nocobase.com/components",children:t.texts[54].value})})]}),(0,e.jsxs)("p",{children:[t.texts[55].value,(0,e.jsx)("code",{children:t.texts[56].value}),t.texts[57].value]}),(0,e.jsx)(o.Z,{lang:"ts",children:t.texts[58].value}),(0,e.jsxs)("p",{children:[t.texts[59].value,(0,e.jsx)("code",{children:t.texts[60].value}),t.texts[61].value,(0,e.jsx)("code",{children:t.texts[62].value}),t.texts[63].value,(0,e.jsx)("code",{children:t.texts[64].value}),t.texts[65].value,(0,e.jsx)("code",{children:t.texts[66].value}),t.texts[67].value]}),(0,e.jsxs)("ul",{children:[(0,e.jsxs)("li",{children:[(0,e.jsx)("code",{children:t.texts[68].value}),t.texts[69].value,(0,e.jsx)("code",{children:t.texts[70].value}),t.texts[71].value]}),(0,e.jsxs)("li",{children:[(0,e.jsx)("code",{children:t.texts[72].value}),t.texts[73].value]}),(0,e.jsxs)("li",{children:[(0,e.jsx)("code",{children:t.texts[74].value}),t.texts[75].value,(0,e.jsx)("code",{children:t.texts[76].value}),t.texts[77].value]}),(0,e.jsxs)("li",{children:[(0,e.jsx)("code",{children:t.texts[78].value}),t.texts[79].value,(0,e.jsxs)("ul",{children:[(0,e.jsxs)("li",{children:[(0,e.jsx)("code",{children:t.texts[80].value}),t.texts[81].value]}),(0,e.jsxs)("li",{children:[(0,e.jsx)("code",{children:t.texts[82].value}),t.texts[83].value,(0,e.jsx)("code",{children:t.texts[84].value}),t.texts[85].value]}),(0,e.jsxs)("li",{children:[(0,e.jsx)("code",{children:t.texts[86].value}),t.texts[87].value,(0,e.jsx)("a",{href:"https://client.docs.nocobase.com/components/input",children:t.texts[88].value}),t.texts[89].value]})]})]})]}),(0,e.jsxs)("h3",{id:"3-create-form-schema",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#3-create-form-schema",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"3. Create Form Schema"]}),(0,e.jsx)("p",{children:t.texts[90].value}),(0,e.jsxs)("ul",{children:[(0,e.jsx)("li",{children:(0,e.jsx)("a",{href:"https://client.docs.nocobase.com/components/form-v2",children:t.texts[91].value})}),(0,e.jsx)("li",{children:(0,e.jsx)("a",{href:"https://client.docs.nocobase.com/core/data-source/collection-field",children:t.texts[92].value})}),(0,e.jsx)("li",{children:(0,e.jsx)("a",{href:"https://client.docs.nocobase.com/components/card-item",children:t.texts[93].value})}),(0,e.jsx)("li",{children:(0,e.jsx)(a.rU,{to:"/development/client/ui-schema/what-is-ui-schema",children:t.texts[94].value})}),(0,e.jsx)("li",{children:(0,e.jsx)("a",{href:"https://client.docs.nocobase.com/core/data-block/data-block-provider",children:t.texts[95].value})}),(0,e.jsx)("li",{children:(0,e.jsx)("a",{href:"https://client.docs.nocobase.com/components/action",children:t.texts[96].value})})]}),(0,e.jsxs)("p",{children:[t.texts[97].value,(0,e.jsx)("code",{children:t.texts[98].value}),t.texts[99].value]}),(0,e.jsx)(o.Z,{lang:"ts",children:t.texts[100].value}),(0,e.jsx)("ul",{children:(0,e.jsxs)("li",{children:[t.texts[101].value,(0,e.jsx)("a",{href:"https://client",children:t.texts[102].value})]})}),(0,e.jsx)("p",{children:t.texts[103].value}),(0,e.jsxs)("ul",{children:[(0,e.jsxs)("li",{children:[(0,e.jsx)("a",{href:"https://client.docs.nocobase.com/core/data-block/data-block-provider",children:t.texts[104].value}),t.texts[105].value,(0,e.jsx)("code",{children:t.texts[106].value}),t.texts[107].value,(0,e.jsx)("code",{children:t.texts[108].value}),t.texts[109].value]}),(0,e.jsxs)("li",{children:[(0,e.jsx)("a",{href:"https://client.docs.nocobase.com/components/form-v2",children:t.texts[110].value}),t.texts[111].value]}),(0,e.jsxs)("li",{children:[(0,e.jsx)("code",{children:t.texts[112].value}),t.texts[113].value,(0,e.jsx)("a",{href:"https://client.docs.nocobase.com/components/form-v2#default-values",children:t.texts[114].value}),t.texts[115].value]}),(0,e.jsxs)("li",{children:[(0,e.jsx)("a",{href:"https://client.docs.nocobase.com/core/data-source/collection-field",children:t.texts[116].value}),t.texts[117].value]}),(0,e.jsxs)("li",{children:[(0,e.jsx)("a",{href:"https://client.docs.nocobase.com/components/action",children:t.texts[118].value}),t.texts[119].value]}),(0,e.jsxs)("li",{children:[(0,e.jsx)("code",{children:t.texts[120].value}),t.texts[121].value,(0,e.jsxs)("ul",{children:[(0,e.jsxs)("li",{children:[(0,e.jsx)(a.rU,{to:"/core/data-source/collection-provider",children:t.texts[122].value}),t.texts[123].value]}),(0,e.jsxs)("li",{children:[(0,e.jsx)(a.rU,{to:"/core/data-block/data-block-resource-provider",children:t.texts[124].value}),t.texts[125].value]})]})]})]}),(0,e.jsxs)("h3",{id:"4-create-the-form-component",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#4-create-the-form-component",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"4. Create the Form Component"]}),(0,e.jsx)("p",{children:t.texts[126].value}),(0,e.jsxs)("ul",{children:[(0,e.jsxs)("li",{children:[(0,e.jsx)("a",{href:"https://client.docs.nocobase.com/core/data-source/extend-collections-provider",children:t.texts[127].value}),t.texts[128].value]}),(0,e.jsxs)("li",{children:[(0,e.jsx)("a",{href:"https://client.docs.nocobase.com/core/ui-schema/schema-component",children:t.texts[129].value}),t.texts[130].value]})]}),(0,e.jsxs)("p",{children:[t.texts[131].value,(0,e.jsx)("code",{children:t.texts[132].value}),t.texts[133].value]}),(0,e.jsx)(o.Z,{lang:"tsx",children:t.texts[134].value}),(0,e.jsxs)("h3",{id:"5-register-the-plugin-configuration-page",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#5-register-the-plugin-configuration-page",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"5. Register the Plugin Configuration Page"]}),(0,e.jsxs)("p",{children:[t.texts[135].value,(0,e.jsx)("code",{children:t.texts[136].value}),t.texts[137].value]}),(0,e.jsx)(o.Z,{lang:"diff",children:t.texts[138].value}),(0,e.jsxs)("p",{children:[t.texts[139].value,(0,e.jsx)("a",{href:"http://localhost:13000/admin/settings/@nocobase-sample/plugin-settings-form",children:t.texts[140].value}),t.texts[141].value]}),(0,e.jsxs)("video",{width:"100%",controls:!0,children:[t.texts[142].value,(0,e.jsx)("source",{src:"https://static-docs.nocobase.com/20240517-182716.mp4",type:"video/mp4"})]}),(0,e.jsxs)("h3",{id:"6-use-configuration-data-inside-the-page",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#6-use-configuration-data-inside-the-page",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"6. Use Configuration Data Inside the Page"]}),(0,e.jsx)("p",{children:t.texts[143].value}),(0,e.jsxs)("ul",{children:[(0,e.jsx)("li",{children:t.texts[144].value}),(0,e.jsx)("li",{children:t.texts[145].value})]}),(0,e.jsx)("p",{children:t.texts[146].value}),(0,e.jsxs)("p",{children:[t.texts[147].value,(0,e.jsx)("code",{children:t.texts[148].value}),t.texts[149].value]}),(0,e.jsx)(o.Z,{lang:"tsx",children:t.texts[150].value}),(0,e.jsxs)("p",{children:[t.texts[151].value,(0,e.jsx)("code",{children:t.texts[152].value}),t.texts[153].value,(0,e.jsx)("code",{children:t.texts[154].value}),t.texts[155].value]}),(0,e.jsx)(o.Z,{lang:"tsx",children:t.texts[156].value}),(0,e.jsxs)("p",{children:[t.texts[157].value,(0,e.jsx)("a",{href:"http://localhost:13000/admin/plugin-settings-form-page",children:t.texts[158].value}),t.texts[159].value]}),(0,e.jsx)("p",{children:(0,e.jsx)("img",{src:"https://static-docs.nocobase.com/img_v3_02av_70ade722-7069-4fc7-a2c3-c080f85ff30g.jpg",alt:"img_v3_02av_70ade722-7069-4fc7-a2c3-c080f85ff30g"})}),(0,e.jsxs)("h3",{id:"7-use-configuration-data-globally",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#7-use-configuration-data-globally",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"7. Use Configuration Data Globally"]}),(0,e.jsxs)("p",{children:[t.texts[160].value,(0,e.jsx)("code",{children:t.texts[161].value}),t.texts[162].value,(0,e.jsx)(a.rU,{to:"/development/client/providers",children:t.texts[163].value}),t.texts[164].value]}),(0,e.jsxs)("p",{children:[t.texts[165].value,(0,e.jsx)("code",{children:t.texts[166].value}),t.texts[167].value]}),(0,e.jsx)(o.Z,{lang:"tsx",children:t.texts[168].value}),(0,e.jsxs)("p",{children:[t.texts[169].value,(0,e.jsx)("code",{children:t.texts[170].value}),t.texts[171].value]}),(0,e.jsx)(o.Z,{lang:"ts",children:t.texts[172].value}),(0,e.jsxs)("p",{children:[t.texts[173].value,(0,e.jsx)("code",{children:t.texts[174].value}),t.texts[175].value]}),(0,e.jsx)(o.Z,{lang:"diff",children:t.texts[176].value}),(0,e.jsxs)("video",{width:"100%",controls:!0,children:[t.texts[177].value,(0,e.jsx)("source",{src:"https://static-docs.nocobase.com/20240517-182717.mp4",type:"video/mp4"})]}),(0,e.jsxs)("h2",{id:"packaging-and-uploading-to-production-environment",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#packaging-and-uploading-to-production-environment",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Packaging and Uploading to Production Environment"]}),(0,e.jsxs)("p",{children:[t.texts[178].value,(0,e.jsx)(a.rU,{to:"/development/your-fisrt-plugin#%E6%9E%84%E5%BB%BA%E5%B9%B6%E6%89%93%E5%8C%85%E6%8F%92%E4%BB%B6",children:t.texts[179].value}),t.texts[180].value]}),(0,e.jsx)("p",{children:t.texts[181].value}),(0,e.jsx)(o.Z,{lang:"bash",children:t.texts[182].value}),(0,e.jsxs)("p",{children:[t.texts[183].value,(0,e.jsx)("code",{children:t.texts[184].value}),t.texts[185].value]}),(0,e.jsx)(o.Z,{lang:"bash",children:t.texts[186].value}),(0,e.jsxs)("p",{children:[t.texts[187].value,(0,e.jsx)("code",{children:t.texts[188].value}),t.texts[189].value,(0,e.jsx)(a.rU,{to:"/welcome/getting-started/plugin",children:t.texts[190].value}),t.texts[191].value]})]})})})})}s.default=c},914146:function(i,s,n){n.r(s),n.d(s,{texts:function(){return l}});const l=[{value:"The configuration interface is composed of a form.",paraId:0,tocIndex:1},{value:"Suppose we need to connect to a third-party map service and configure the map's ",paraId:1,tocIndex:2},{value:"key",paraId:1,tocIndex:2},{value:" and ",paraId:1,tocIndex:2},{value:"secret",paraId:1,tocIndex:2},{value:". We can add a configuration page via a plugin to fill in this information.",paraId:1,tocIndex:2},{value:"The complete example code in this document can be found in ",paraId:2,tocIndex:2},{value:"plugin-samples",paraId:2,tocIndex:2},{value:".",paraId:2,tocIndex:2},{value:"Following the ",paraId:3,tocIndex:3},{value:"Writing Your First Plugin",paraId:4,tocIndex:3},{value:" document, if you don\u2019t have a project yet, you can create one first. If you already have one or have cloned the source code, you can skip this step.",paraId:3,tocIndex:3},{value:`yarn create nocobase-app my-nocobase-app -d postgres
cd my-nocobase-app
yarn install
yarn nocobase install
`,paraId:5,tocIndex:3},{value:"Then, initialize a plugin and add it to the system:",paraId:6,tocIndex:3},{value:`yarn pm create @nocobase-sample/plugin-settings-form
yarn pm enable @nocobase-sample/plugin-settings-form
`,paraId:7,tocIndex:3},{value:"Now, start the project:",paraId:8,tocIndex:3},{value:`yarn dev
`,paraId:9,tocIndex:3},{value:"After logging in, visit ",paraId:10,tocIndex:3},{value:"http://localhost:13000/admin/pm/list/local/",paraId:10,tocIndex:3},{value:" to see that the plugin has been installed and enabled.",paraId:10,tocIndex:3},{value:"The backend mainly involves creating a database table to store configuration information. For creating database tables, we need to be familiar with the following:",paraId:11,tocIndex:5},{value:"Tables and Fields",paraId:12,tocIndex:5},{value:"Creating Tables",paraId:13,tocIndex:5},{value:"Field Type",paraId:14,tocIndex:5},{value:"defineCollection() API",paraId:15,tocIndex:5},{value:"Collection API",paraId:16,tocIndex:5},{value:"In this example, we create the ",paraId:17,tocIndex:5},{value:"packages/plugins/@nocobase-sample/plugin-settings-form/src/server/collections/map-configuration.ts",paraId:17,tocIndex:5},{value:" file with the following content:",paraId:17,tocIndex:5},{value:`import { defineCollection } from '@nocobase/database';

export default defineCollection({
  name: 'SamplesMapConfiguration',
  fields: [
    {
      type: 'string',
      name: 'key',
    },
    {
      type: 'string',
      name: 'secret',
    },
  ],
});
`,paraId:18,tocIndex:5},{value:"As needed, we created a ",paraId:19,tocIndex:5},{value:"SamplesMapConfiguration",paraId:19,tocIndex:5},{value:" database table containing two fields: ",paraId:19,tocIndex:5},{value:"key",paraId:19,tocIndex:5},{value:" and ",paraId:19,tocIndex:5},{value:"secret",paraId:19,tocIndex:5},{value:", both of string type.",paraId:19,tocIndex:5},{value:"We need to update the database with the defined table, which can be done with the following command:",paraId:20,tocIndex:6},{value:`yarn nocobase upgrade
`,paraId:21,tocIndex:6},{value:"We've already introduced the detailed steps for ",paraId:22,tocIndex:8},{value:"Adding a Plugin Configuration Page (Single Route)",paraId:23,tocIndex:8},{value:", so we won\u2019t repeat them here.",paraId:22,tocIndex:8},{value:"We modify the ",paraId:24,tocIndex:8},{value:"packages/plugins/@nocobase-sample/plugin-settings-form/src/client/index.tsx",paraId:24,tocIndex:8},{value:" file as follows:",paraId:24,tocIndex:8},{value:`import { Plugin } from '@nocobase/client';
// @ts-ignore
import { name } from '../../package.json';

export class PluginSettingsFormClient extends Plugin {
  async load() {
    this.app.pluginSettingsManager.add(name, {
      title: 'Plugin Settings Form',
      icon: 'FormOutlined',
      Component: () => 'TODO',
    });
  }
}

export default PluginSettingsFormClient;
`,paraId:25,tocIndex:8},{value:"Then, visit ",paraId:26,tocIndex:8},{value:"http://localhost:13000/admin/settings/@nocobase-sample/plugin-settings-form",paraId:26,tocIndex:8},{value:" to see the configuration page.",paraId:26,tocIndex:8},{value:"Based on the Schema definition method, we first need to define the structure of the data table. To define the data table structure on the frontend, we need to understand the following concepts:",paraId:27,tocIndex:9},{value:"Tables and Fields",paraId:28,tocIndex:9},{value:"Field Type",paraId:29,tocIndex:9},{value:"Field Interface",paraId:30,tocIndex:9},{value:"UI Schema Protocol",paraId:31,tocIndex:9},{value:"Field Components",paraId:32,tocIndex:9},{value:"We then create the ",paraId:33,tocIndex:9},{value:"packages/plugins/@nocobase-sample/plugin-settings-form/src/client/PluginSettingsForm.tsx",paraId:33,tocIndex:9},{value:" file with the following content:",paraId:33,tocIndex:9},{value:`const mapConfigurationCollection = {
  name: 'SamplesMapConfiguration',
  filterTargetKey: 'id',
  fields: [
    {
      type: 'string',
      name: 'key',
      interface: 'input',
      uiSchema: {
        title: 'Title',
        required: true,
        'x-component': 'Input',
      },
    },
    {
      type: 'string',
      name: 'secret',
      interface: 'input',
      uiSchema: {
        title: 'Secret',
        required: true,
        'x-component': 'Input',
      },
    },
  ],
};
`,paraId:34,tocIndex:9},{value:"We've defined a ",paraId:35,tocIndex:9},{value:"SamplesMapConfiguration",paraId:35,tocIndex:9},{value:" data table with two fields: ",paraId:35,tocIndex:9},{value:"key",paraId:35,tocIndex:9},{value:" and ",paraId:35,tocIndex:9},{value:"secret",paraId:35,tocIndex:9},{value:". The ",paraId:35,tocIndex:9},{value:"fields",paraId:35,tocIndex:9},{value:" are explained as follows:",paraId:35,tocIndex:9},{value:"type",paraId:36,tocIndex:9},{value:": Since the values are strings, it is set to ",paraId:36,tocIndex:9},{value:"string",paraId:36,tocIndex:9},{value:" and must match the backend field type.",paraId:36,tocIndex:9},{value:"name",paraId:36,tocIndex:9},{value:": The field's name, which must match the backend field name.",paraId:36,tocIndex:9},{value:"interface",paraId:36,tocIndex:9},{value:": Corresponding to the string value, it is set to ",paraId:36,tocIndex:9},{value:"input",paraId:36,tocIndex:9},{value:".",paraId:36,tocIndex:9},{value:"uiSchema",paraId:36,tocIndex:9},{value:`: Refers to the rendering of the frontend form components.
`,paraId:36,tocIndex:9},{value:"title",paraId:37,tocIndex:9},{value:": The title of the form field.",paraId:37,tocIndex:9},{value:"required",paraId:37,tocIndex:9},{value:": As it is mandatory, it is set to ",paraId:37,tocIndex:9},{value:"true",paraId:37,tocIndex:9},{value:".",paraId:37,tocIndex:9},{value:"x-component",paraId:37,tocIndex:9},{value:": The ",paraId:37,tocIndex:9},{value:"Input component",paraId:37,tocIndex:9},{value:" is chosen for single-line text input.",paraId:37,tocIndex:9},{value:"For writing form schemas, the following concepts are important:",paraId:38,tocIndex:10},{value:"Form Component",paraId:39,tocIndex:10},{value:"CollectionField Component",paraId:39,tocIndex:10},{value:"CardItem Component",paraId:39,tocIndex:10},{value:"Schema Protocol",paraId:40,tocIndex:10},{value:"DataBlockProvider Component",paraId:39,tocIndex:10},{value:"Action Component",paraId:39,tocIndex:10},{value:"We continue to write the following in ",paraId:41,tocIndex:10},{value:"packages/plugins/@nocobase-sample/plugin-settings-form/src/client/PluginSettingsForm.tsx",paraId:41,tocIndex:10},{value:":",paraId:41,tocIndex:10},{value:`import { useMemo } from 'react';
import { App as AntdApp } from 'antd';
import { createForm } from '@formily/core';
import { useForm } from '@formily/react';
import { uid } from '@formily/shared';
import { ActionProps, ISchema, useCollection, useCollectionRecordData, useDataBlockResource } from '@nocobase/client';

const schema: ISchema = {
  type: 'void',
  name: uid(),
  'x-component': 'CardItem',
  'x-decorator': 'DataBlockProvider',
  'x-decorator-props': {
    collection: mapConfigurationCollection.name,
    action: 'get',
  },
  properties: {
    form: {
      type: 'void',
      'x-component': 'FormV2',
      'x-use-component-props': 'useFormBlockProps',
      properties: {
        key: {
          title: 'Key',
          'x-decorator': 'FormItem',
          'x-component': 'CollectionField',
        },
        secret: {
          title: 'Secret',
          'x-decorator': 'FormItem',
          'x-component': 'CollectionField',
        },
        footer: {
          type: 'void',
          'x-component': 'Action',
          title: 'Submit',
          'x-use-component-props': 'useSubmitActionProps',
        },
      },
    },
  },
};

const useFormBlockProps = () => {
  const recordData = useCollectionRecordData();
  const form = useMemo(
    () => createForm({
      initialValues: recordData,
    }),
    [recordData],
  );
  return {
    form,
  };
};

const useSubmitActionProps = (): ActionProps => {
  const form = useForm();
  const { message } = AntdApp.useApp();
  const collection = useCollection();
  const resource = useDataBlockResource();
  return {
    type: 'primary',
    htmlType: 'submit',
    async onClick() {
      await form.submit();
      const values = form.values;
      await resource.updateOrCreate({
        values,
        filterKeys: [collection.filterTargetKey],
      });
      message.success('Saved successfully!');
    },
  };
};
`,paraId:42,tocIndex:10},{value:"[CardItem](",paraId:43,tocIndex:10},{value:"https://client",paraId:43,tocIndex:10},{value:".docs.nocobase.com/components/card-item): A card component that provides card-style layouts.",paraId:44,tocIndex:10},{value:"DataBlockProvider",paraId:45,tocIndex:10},{value:": A component that provides data to child nodes, with the ",paraId:45,tocIndex:10},{value:"collection",paraId:45,tocIndex:10},{value:" and ",paraId:45,tocIndex:10},{value:"action",paraId:45,tocIndex:10},{value:" attributes since the form fetches single-row data.",paraId:45,tocIndex:10},{value:"FormV2",paraId:45,tocIndex:10},{value:": A form component used to render the form.",paraId:45,tocIndex:10},{value:"useFormBlockProps",paraId:45,tocIndex:10},{value:": Used to get the data block's attributes and pass them to the FormV2 component. For detailed examples, see FormV2 ",paraId:45,tocIndex:10},{value:"Default values",paraId:45,tocIndex:10},{value:".",paraId:45,tocIndex:10},{value:"CollectionField",paraId:45,tocIndex:10},{value:": A data table field component used to read the UI Schema of the Collection and render it.",paraId:45,tocIndex:10},{value:"Action",paraId:45,tocIndex:10},{value:": An action button component used to submit the form.",paraId:45,tocIndex:10},{value:"useSubmitActionProps",paraId:45,tocIndex:10},{value:`: Used to get the attributes of the submit button.
`,paraId:45,tocIndex:10},{value:"useCollection",paraId:46,tocIndex:10},{value:": Used to get information about the data table.",paraId:47,tocIndex:10},{value:"useDataBlockResource",paraId:48,tocIndex:10},{value:": A hook provided by DataBlockProvider to access the data block's resources for CRUD operations.",paraId:47,tocIndex:10},{value:"To render the schema into a component, we need to understand the following concepts:",paraId:49,tocIndex:11},{value:"ExtendCollectionsProvider",paraId:50,tocIndex:11},{value:" component to extend data tables.",paraId:50,tocIndex:11},{value:"SchemaComponent",paraId:50,tocIndex:11},{value:" component to render forms.",paraId:50,tocIndex:11},{value:"We continue writing in ",paraId:51,tocIndex:11},{value:"packages/plugins/@nocobase-sample/plugin-settings-form/src/client/PluginSettingsForm.tsx",paraId:51,tocIndex:11},{value:":",paraId:51,tocIndex:11},{value:`import React from 'react';
import { ExtendCollectionsProvider, SchemaComponent } from '@nocobase/client';
export const PluginSettingsForm = () => {
  return (
    <ExtendCollectionsProvider collections={[mapConfigurationCollection]}>
      <SchemaComponent schema={schema} scope={{ useFormBlockProps, useSubmitActionProps }} />
    </ExtendCollectionsProvider>
  );
};
`,paraId:52,tocIndex:11},{value:"We modify the ",paraId:53,tocIndex:12},{value:"packages/plugins/@nocobase-sample/plugin-settings-form/src/client/index.tsx",paraId:53,tocIndex:12},{value:" file as follows:",paraId:53,tocIndex:12},{value:`import { Plugin } from '@nocobase/client';
// @ts-ignore
import { name } from '../../package.json';
+ import { PluginSettingsForm } from './PluginSettingsForm'

export class PluginSettingFormClient extends Plugin {
  async load() {
    this.app.pluginSettingsManager.add(name, {
      title: 'Plugin Settings Form',
      icon: 'FormOutlined',
-     Component: () => 'TODO',
+     Component: PluginSettingsForm,
    });
  }
}

export default PluginSettingFormClient;
`,paraId:54,tocIndex:12},{value:"Now, visit ",paraId:55,tocIndex:12},{value:"http://localhost:13000/admin/settings/@nocobase-sample/plugin-settings-form",paraId:55,tocIndex:12},{value:" to see the configuration page.",paraId:55,tocIndex:12},{value:`
  `,paraId:56},{value:"When using form data, there are two scenarios: using the data inside the page and using it globally. The difference is:",paraId:57,tocIndex:13},{value:"Global usage: After updating the form data, it needs to be synchronized to the global state for real-time updates.",paraId:58,tocIndex:13},{value:"Page-specific usage: Since the page will be automatically destroyed and created upon switching, there\u2019s no need to synchronize the data.",paraId:58,tocIndex:13},{value:"In this step, we'll demonstrate using form data inside a page.",paraId:59,tocIndex:13},{value:"We create the ",paraId:60,tocIndex:13},{value:"packages/plugins/@nocobase-sample/plugin-settings-form/src/client/PluginSettingsFormPage.tsx",paraId:60,tocIndex:13},{value:" file with the following content:",paraId:60,tocIndex:13},{value:`import { useRequest } from '@nocobase/client';
import React from 'react';

export const PluginSettingsFormPage = () => {
  const { data, loading } = useRequest<{ data?: { key: string; secret: string } }>({
    url: 'SamplesMapConfiguration:get',
  });

  if (loading) return null;

  return <pre>{JSON.stringify(data?.data, null, 2)}</pre>
}
`,paraId:61,tocIndex:13},{value:"Then we introduce the ",paraId:62,tocIndex:13},{value:"PluginSettingsFormPage",paraId:62,tocIndex:13},{value:" component in the ",paraId:62,tocIndex:13},{value:"PluginSettingsForm",paraId:62,tocIndex:13},{value:" component:",paraId:62,tocIndex:13},{value:`import { PluginSettingsFormPage } from './PluginSettingsFormPage'
// ...

export class PluginSettingFormClient extends Plugin {
  async load() {
    // ...

    this.app.router.add(\`admin.\${name}-page\`, {
      path: '/admin/plugin-settings-form-page',
      Component: PluginSettingsFormPage,
    })
  }
}
`,paraId:63,tocIndex:13},{value:"Now, visit ",paraId:64,tocIndex:13},{value:"http://localhost:13000/admin/plugin-settings-form-page",paraId:64,tocIndex:13},{value:" to see the form data.",paraId:64,tocIndex:13},{value:"To use the data globally and ensure real-time updates, we need to use ",paraId:65,tocIndex:14},{value:"Context",paraId:65,tocIndex:14},{value:" and NocoBase's ",paraId:65,tocIndex:14},{value:"Provider",paraId:66,tocIndex:14},{value:" capabilities.",paraId:65,tocIndex:14},{value:"We create the ",paraId:67,tocIndex:14},{value:"packages/plugins/@nocobase-sample/plugin-settings-form/src/client/PluginSettingsFormProvider.tsx",paraId:67,tocIndex:14},{value:" file with the following content:",paraId:67,tocIndex:14},{value:`import React, { createContext, FC } from 'react';
import { useRequest, UseRequestResult } from '@nocobase/client';

const PluginSettingsFormContext = createContext<UseRequestResult<{ data?: { key: string; secret: string } }>>(null as any);

export const PluginSettingsFormProvider: FC<{ children: React.ReactNode }> = ({children}) => {
  const request = useRequest<{ data?: { key: string; secret: string } }>({
    url: 'SamplesMapConfiguration:get',
  });

  console.log('PluginSettingsFormProvider', request.data?.data);

  return <PluginSettingsFormContext.Provider value={request}>{children}</PluginSettingsFormContext.Provider>;
}

export const usePluginSettingsFormRequest = () => {
  return React.useContext(PluginSettingsFormContext);
};
`,paraId:68,tocIndex:14},{value:"Then we modify the ",paraId:69,tocIndex:14},{value:"packages/plugins/@nocobase-sample/plugin-settings-form/src/client/index.tsx",paraId:69,tocIndex:14},{value:" file to register it globally:",paraId:69,tocIndex:14},{value:`import { PluginSettingsFormProvider } from './PluginSettingsFormProvider'
// ...

export class PluginSettingFormClient extends Plugin {
  async load() {
    // ...
    this.app.addProvider(PluginSettingsFormProvider)
  }
}
`,paraId:70,tocIndex:14},{value:"After updating the form, we need to re-fetch the global data. We modify the ",paraId:71,tocIndex:14},{value:"packages/plugins/@nocobase-sample/plugin-settings-form/src/client/PluginSettingsForm.tsx",paraId:71,tocIndex:14},{value:" file:",paraId:71,tocIndex:14},{value:`+ import { usePluginSettingsFormRequest } from './PluginSettingsFormProvider';

const useSubmitActionProps = (): ActionProps => {
  const form = useForm();
  const { message } = AntdApp.useApp();
  const collection = useCollection();
  const resource = useDataBlockResource();
+ const globalSettingsFormRequest = usePluginSettingsFormRequest();
  return {
    type: 'primary',
    htmlType: 'submit',
    async onClick() {
      await form.submit();
      const values = form.values;
      await resource.updateOrCreate({
        values,
        filterKeys: [collection.filterTargetKey],
      });
+     await globalSettingsFormRequest.runAsync();
      message.success('Saved successfully!');
    },
  };
};
`,paraId:72,tocIndex:14},{value:`
  `,paraId:56},{value:"Following the ",paraId:73,tocIndex:15},{value:"Build and Package Plugin",paraId:74,tocIndex:15},{value:" document, we can package the plugin and upload it to the production environment.",paraId:73,tocIndex:15},{value:"If you've cloned the source code, you need to perform a full build first to package the plugin's dependencies.",paraId:75,tocIndex:15},{value:`yarn build
`,paraId:76,tocIndex:15},{value:"If you used the ",paraId:77,tocIndex:15},{value:"create-nocobase-app",paraId:77,tocIndex:15},{value:" to create the project, you can directly execute:",paraId:77,tocIndex:15},{value:`yarn build @nocobase-sample/plugin-settings-form --tar
`,paraId:78,tocIndex:15},{value:"Then you\u2019ll see the ",paraId:79,tocIndex:15},{value:"storage/tar/@nocobase-sample/plugin-settings-form.tar.gz",paraId:79,tocIndex:15},{value:" file, which can be installed by following the ",paraId:79,tocIndex:15},{value:"uploading instructions",paraId:80,tocIndex:15},{value:".",paraId:79,tocIndex:15}]}}]);
