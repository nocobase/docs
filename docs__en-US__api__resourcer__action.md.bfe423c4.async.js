"use strict";(self.webpackChunknocobase_docs=self.webpackChunknocobase_docs||[]).push([[6893],{338517:function(c,d,t){t.r(d);var l=t(572269),u=t(793359),h=t(861788),v=t(719977),I=t(20190),r=t(24268),s=t(496057),_=t(585939),j=t(28484),p=t(635206),m=t(375553),g=t(156266),f=t(572333),M=t(841118),E=t(39297),P=t(868526),y=t(605019),n=t(614651),i=t(280936),x=t(667294),a=t(627419),e=t(785893);function o(){return(0,e.jsx)(n.dY,{children:(0,e.jsx)(x.Suspense,{fallback:(0,e.jsx)(i.Z,{}),children:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"markdown",children:[(0,e.jsxs)("h1",{id:"ctxaction",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#ctxaction",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"ctx.action"]}),(0,e.jsxs)("h2",{id:"overview",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#overview",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Overview"]}),(0,e.jsxs)("p",{children:[a.texts[0].value,(0,e.jsx)(n.rU,{to:"/api/resourcer/resource-manager#middleware",children:(0,e.jsx)("code",{children:a.texts[1].value})}),a.texts[2].value,(0,e.jsx)("code",{children:a.texts[3].value}),a.texts[4].value]}),(0,e.jsxs)("h2",{id:"api",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#api",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"API"]}),(0,e.jsxs)("h3",{id:"resourcename",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#resourcename",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"resourceName"]}),(0,e.jsx)("p",{children:(0,e.jsx)("code",{children:a.texts[5].value})}),(0,e.jsx)("p",{children:a.texts[6].value}),(0,e.jsxs)("ul",{children:[(0,e.jsxs)("li",{children:[(0,e.jsx)("code",{children:a.texts[7].value}),a.texts[8].value,(0,e.jsx)("code",{children:a.texts[9].value}),a.texts[10].value]}),(0,e.jsxs)("li",{children:[(0,e.jsx)("code",{children:a.texts[11].value}),a.texts[12].value,(0,e.jsx)("code",{children:a.texts[13].value}),a.texts[14].value,(0,e.jsx)("code",{children:a.texts[15].value}),a.texts[16].value]})]}),(0,e.jsxs)("h3",{id:"actionname",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#actionname",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"actionName"]}),(0,e.jsx)("p",{children:(0,e.jsx)("code",{children:a.texts[17].value})}),(0,e.jsx)("p",{children:a.texts[18].value}),(0,e.jsxs)("h3",{id:"sourceid",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#sourceid",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"sourceId"]}),(0,e.jsx)("p",{children:(0,e.jsx)("code",{children:a.texts[19].value})}),(0,e.jsxs)("p",{children:[a.texts[20].value,(0,e.jsx)("code",{children:a.texts[21].value}),a.texts[22].value,(0,e.jsx)("code",{children:a.texts[23].value}),a.texts[24].value,(0,e.jsx)("code",{children:a.texts[25].value}),a.texts[26].value,(0,e.jsx)("code",{children:a.texts[27].value}),a.texts[28].value]}),(0,e.jsxs)("h3",{id:"params",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#params",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"params"]}),(0,e.jsx)("p",{children:a.texts[29].value}),(0,e.jsx)("ul",{children:(0,e.jsxs)("li",{children:[a.texts[30].value,(0,e.jsx)("code",{children:a.texts[31].value}),a.texts[32].value]})}),(0,e.jsx)(r.Z,{lang:"ts",children:a.texts[33].value}),(0,e.jsx)("ul",{children:(0,e.jsxs)("li",{children:[a.texts[34].value,(0,e.jsx)("code",{children:a.texts[35].value}),a.texts[36].value]})}),(0,e.jsxs)("h3",{id:"mergeparams",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#mergeparams",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"mergeParams()"]}),(0,e.jsx)("p",{children:a.texts[37].value}),(0,e.jsx)(r.Z,{lang:"ts",children:a.texts[38].value}),(0,e.jsxs)("h4",{id:"signature",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#signature",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Signature"]}),(0,e.jsx)("ul",{children:(0,e.jsx)("li",{children:(0,e.jsx)("code",{children:a.texts[39].value})})}),(0,e.jsxs)("h4",{id:"type",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#type",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Type"]}),(0,e.jsx)(r.Z,{lang:"ts",children:a.texts[40].value}),(0,e.jsxs)("h4",{id:"details",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#details",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Details"]}),(0,e.jsxs)(s.Z,{children:[(0,e.jsx)("thead",{children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{children:a.texts[41].value}),(0,e.jsx)("th",{children:a.texts[42].value}),(0,e.jsx)("th",{children:a.texts[43].value})]})}),(0,e.jsxs)("tbody",{children:[(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[44].value})}),(0,e.jsx)("td",{children:(0,e.jsx)(n.rU,{to:"#actionparams",children:(0,e.jsx)("code",{children:a.texts[45].value})})}),(0,e.jsx)("td",{children:a.texts[46].value})]}),(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[47].value})}),(0,e.jsx)("td",{children:(0,e.jsx)(n.rU,{to:"#mergestrategies",children:(0,e.jsx)("code",{children:a.texts[48].value})})}),(0,e.jsx)("td",{children:a.texts[49].value})]})]})]}),(0,e.jsxs)("p",{children:[a.texts[50].value,(0,e.jsx)("code",{children:a.texts[51].value}),a.texts[52].value]}),(0,e.jsx)(r.Z,{lang:"ts",children:a.texts[53].value}),(0,e.jsxs)("h5",{id:"actionparams",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#actionparams",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"ActionParams"]}),(0,e.jsxs)(s.Z,{children:[(0,e.jsx)("thead",{children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{children:a.texts[54].value}),(0,e.jsx)("th",{children:a.texts[55].value}),(0,e.jsx)("th",{children:a.texts[56].value})]})}),(0,e.jsxs)("tbody",{children:[(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[57].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[58].value})}),(0,e.jsx)("td",{children:a.texts[59].value})]}),(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[60].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[61].value})}),(0,e.jsxs)("td",{children:[a.texts[62].value,(0,e.jsx)(n.rU,{to:"/api/resourcer/database/operators",children:a.texts[63].value})]})]}),(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[64].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[65].value})}),(0,e.jsx)("td",{children:a.texts[66].value})]}),(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[67].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[68].value})}),(0,e.jsx)("td",{children:a.texts[69].value})]}),(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[70].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[71].value})}),(0,e.jsx)("td",{children:a.texts[72].value})]}),(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[73].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[74].value})}),(0,e.jsx)("td",{children:a.texts[75].value})]}),(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[76].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[77].value})}),(0,e.jsx)("td",{children:a.texts[78].value})]}),(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[79].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[80].value})}),(0,e.jsx)("td",{children:a.texts[81].value})]}),(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[82].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[83].value})}),(0,e.jsx)("td",{children:a.texts[84].value})]}),(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[85].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[86].value})}),(0,e.jsx)("td",{children:a.texts[87].value})]}),(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[88].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[89].value})}),(0,e.jsx)("td",{children:a.texts[90].value})]}),(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[91].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[92].value})}),(0,e.jsx)("td",{children:a.texts[93].value})]})]})]}),(0,e.jsxs)("h5",{id:"mergestrategies",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#mergestrategies",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"MergeStrategies"]}),(0,e.jsx)("p",{children:a.texts[94].value}),(0,e.jsx)("p",{children:a.texts[95].value}),(0,e.jsxs)(s.Z,{children:[(0,e.jsx)("thead",{children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{children:a.texts[96].value}),(0,e.jsx)("th",{children:a.texts[97].value})]})}),(0,e.jsxs)("tbody",{children:[(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[98].value})}),(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[99].value})})]}),(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[100].value})}),(0,e.jsx)("td",{children:a.texts[101].value})]}),(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[102].value})}),(0,e.jsx)("td",{children:a.texts[103].value})]}),(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[104].value})}),(0,e.jsxs)("td",{children:[a.texts[105].value,(0,e.jsx)("code",{children:a.texts[106].value}),a.texts[107].value]})]}),(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[108].value})}),(0,e.jsxs)("td",{children:[a.texts[109].value,(0,e.jsx)("code",{children:a.texts[110].value}),a.texts[111].value]})]}),(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[112].value})}),(0,e.jsx)("td",{children:a.texts[113].value})]}),(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)("code",{children:a.texts[114].value})}),(0,e.jsx)("td",{children:a.texts[115].value})]})]})]})]})})})})}d.default=o},627419:function(c,d,t){t.r(d),t.d(d,{texts:function(){return l}});const l=[{value:"After the resource operation request is parsed by ",paraId:0,tocIndex:1},{value:"resourceManager.middleware()",paraId:1,tocIndex:1},{value:", some important request parameters are stored in ",paraId:0,tocIndex:1},{value:"ctx.action",paraId:0,tocIndex:1},{value:" for use by subsequent middleware.",paraId:0,tocIndex:1},{value:"ctx.action.resourceName",paraId:2,tocIndex:3},{value:"The name of the resource. It can take two forms:",paraId:3,tocIndex:3},{value:"a",paraId:4,tocIndex:3},{value:" - Operates on resource ",paraId:4,tocIndex:3},{value:"a",paraId:4,tocIndex:3},{value:".",paraId:4,tocIndex:3},{value:"a.b",paraId:4,tocIndex:3},{value:" - Operates on associated object ",paraId:4,tocIndex:3},{value:"b",paraId:4,tocIndex:3},{value:" of resource ",paraId:4,tocIndex:3},{value:"a",paraId:4,tocIndex:3},{value:".",paraId:4,tocIndex:3},{value:"ctx.action.actionName",paraId:5,tocIndex:4},{value:"The name of the action.",paraId:6,tocIndex:4},{value:"ctx.action.sourceId",paraId:7,tocIndex:5},{value:"When the operation object is an associated object of the resource, it represents the primary key value of the corresponding resource. For example: when ",paraId:8,tocIndex:5},{value:"resourceName",paraId:8,tocIndex:5},{value:" is ",paraId:8,tocIndex:5},{value:"a.b",paraId:8,tocIndex:5},{value:", ",paraId:8,tocIndex:5},{value:"sourceId",paraId:8,tocIndex:5},{value:" represents the primary key value of ",paraId:8,tocIndex:5},{value:"a",paraId:8,tocIndex:5},{value:".",paraId:8,tocIndex:5},{value:"Request parameters.",paraId:9,tocIndex:6},{value:"URL parameters can be directly obtained from ",paraId:10,tocIndex:6},{value:"ctx.action.params",paraId:10,tocIndex:6},{value:".",paraId:10,tocIndex:6},{value:`const { filterByTk } = ctx.action.params;
`,paraId:11,tocIndex:6},{value:"Request body parameters can be obtained using ",paraId:12,tocIndex:6},{value:"ctx.action.params.values",paraId:12,tocIndex:6},{value:".",paraId:12,tocIndex:6},{value:"Combines parameter content with request parameters.",paraId:13,tocIndex:7},{value:`ctx.action.mergeParams(
  {
    filter: {
      name: 'foo',
    },
    fields: ['id', 'name'],
    except: ['name'],
    sort: ['id'],
    page: 1,
    pageSize: 10,
    values: {
      name: 'foo',
    },
  },
  {
    filter: 'and',
    fields: 'union',
    except: 'union',
    sort: 'overwrite',
    page: 'overwrite',
    pageSize: 'overwrite',
    values: 'deepMerge',
  },
);

ctx.action.mergeParams(
  {
    filter: {},
  },
  {
    filter: (x, y) => {
      // ...
    },
  },
);
`,paraId:14,tocIndex:7},{value:"mergeParams(params: ActionParams, strategies: MergeStrategies = {})",paraId:15,tocIndex:8},{value:`export interface ActionParams {
  filterByTk?: any;
  fields?: string[];
  appends?: string[];
  except?: string[];
  whitelist?: string[];
  blacklist?: string[];
  filter?: FilterOptions;
  sort?: string[];
  page?: number;
  pageSize?: number;
  values?: any;
  [key: string]: any;
}

type MergeStrategyType =
  | 'merge'
  | 'deepMerge'
  | 'overwrite'
  | 'andMerge'
  | 'orMerge'
  | 'intersect'
  | 'union';
type MergeStrategyFunc = (x: any, y: any) => any;
export type MergeStrategy = MergeStrategyType | MergeStrategyFunc;
export interface MergeStrategies {
  [key: string]: MergeStrategy;
}
`,paraId:16,tocIndex:9},{value:"Property",paraId:17,tocIndex:10},{value:"Type",paraId:17,tocIndex:10},{value:"Description",paraId:17,tocIndex:10},{value:"params",paraId:17,tocIndex:10},{value:"ActionParams",paraId:18,tocIndex:10},{value:"Request parameters",paraId:17,tocIndex:10},{value:"strategies",paraId:17,tocIndex:10},{value:"{ [key: string]: MergeStrategies }",paraId:19,tocIndex:10},{value:"Merge strategies for various fields in the request parameters",paraId:17,tocIndex:10},{value:"Default ",paraId:20,tocIndex:10},{value:"strategies",paraId:20,tocIndex:10},{value:":",paraId:20,tocIndex:10},{value:`{
  filter: 'andMerge',
  fields: 'intersect',
  appends: 'union',
  except: 'union',
  whitelist: 'intersect',
  blacklist: 'intersect',
  sort: 'overwrite',
};
`,paraId:21,tocIndex:10},{value:"Property",paraId:22,tocIndex:11},{value:"Type",paraId:22,tocIndex:11},{value:"Description",paraId:22,tocIndex:11},{value:"filterByTk",paraId:22,tocIndex:11},{value:"any",paraId:22,tocIndex:11},{value:"The primary key value of the operated resource",paraId:22,tocIndex:11},{value:"filter",paraId:22,tocIndex:11},{value:"Filter",paraId:22,tocIndex:11},{value:"Filtering parameters, refer to ",paraId:22,tocIndex:11},{value:"Filter Operators",paraId:23,tocIndex:11},{value:"fields",paraId:22,tocIndex:11},{value:"string[]",paraId:22,tocIndex:11},{value:"Fields to retrieve",paraId:22,tocIndex:11},{value:"except",paraId:22,tocIndex:11},{value:"string[]",paraId:22,tocIndex:11},{value:"Fields to exclude",paraId:22,tocIndex:11},{value:"appends",paraId:22,tocIndex:11},{value:"string[]",paraId:22,tocIndex:11},{value:"Related fields to append",paraId:22,tocIndex:11},{value:"whitelist",paraId:22,tocIndex:11},{value:"string[]",paraId:22,tocIndex:11},{value:"Field whitelist",paraId:22,tocIndex:11},{value:"blacklist",paraId:22,tocIndex:11},{value:"string[]",paraId:22,tocIndex:11},{value:"Field blacklist",paraId:22,tocIndex:11},{value:"sort",paraId:22,tocIndex:11},{value:"string[]",paraId:22,tocIndex:11},{value:"Sorting parameters",paraId:22,tocIndex:11},{value:"page",paraId:22,tocIndex:11},{value:"number",paraId:22,tocIndex:11},{value:"Current page",paraId:22,tocIndex:11},{value:"pageSize",paraId:22,tocIndex:11},{value:"number",paraId:22,tocIndex:11},{value:"Number of data items per page",paraId:22,tocIndex:11},{value:"values",paraId:22,tocIndex:11},{value:"any",paraId:22,tocIndex:11},{value:"Request body",paraId:22,tocIndex:11},{value:"[key: string]",paraId:22,tocIndex:11},{value:"any",paraId:22,tocIndex:11},{value:"Other extended configurations",paraId:22,tocIndex:11},{value:"Predefined merge strategies or custom merge functions.",paraId:24,tocIndex:12},{value:"Predefined merge strategies:",paraId:25,tocIndex:12},{value:"Strategy Name",paraId:26,tocIndex:12},{value:"Description",paraId:26,tocIndex:12},{value:"merge",paraId:26,tocIndex:12},{value:"Object.assign",paraId:26,tocIndex:12},{value:"deepMerge",paraId:26,tocIndex:12},{value:"Deep traversal merge",paraId:26,tocIndex:12},{value:"overwrite",paraId:26,tocIndex:12},{value:"Overwrite",paraId:26,tocIndex:12},{value:"andMerge",paraId:26,tocIndex:12},{value:"Merge filter parameters using the ",paraId:26,tocIndex:12},{value:"$and",paraId:26,tocIndex:12},{value:" operator",paraId:26,tocIndex:12},{value:"orMerge",paraId:26,tocIndex:12},{value:"Merge filter parameters using the ",paraId:26,tocIndex:12},{value:"$or",paraId:26,tocIndex:12},{value:" operator",paraId:26,tocIndex:12},{value:"intersect",paraId:26,tocIndex:12},{value:"Intersection",paraId:26,tocIndex:12},{value:"union",paraId:26,tocIndex:12},{value:"Union",paraId:26,tocIndex:12}]}}]);
