"use strict";(self.webpackChunknocobase_docs=self.webpackChunknocobase_docs||[]).push([[50425],{339737:function(l,o,a){a.r(o);var s=a(572269),c=a(793359),x=a(861788),h=a(719977),p=a(20190),n=a(24268),v=a(496057),I=a(585939),_=a(28484),m=a(635206),g=a(375553),j=a(156266),f=a(572333),y=a(841118),b=a(39297),P=a(868526),E=a(605019),d=a(614651),i=a(280936),r=a(667294),t=a(848292),e=a(785893);function u(){return(0,e.jsx)(d.dY,{children:(0,e.jsx)(r.Suspense,{fallback:(0,e.jsx)(i.Z,{}),children:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"markdown",children:[(0,e.jsxs)("h1",{id:"replace-page",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#replace-page",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Replace Page"]}),(0,e.jsxs)("h2",{id:"description",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#description",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Description"]}),(0,e.jsx)("p",{children:t.texts[0].value}),(0,e.jsxs)("h2",{id:"example-description",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#example-description",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Example Description"]}),(0,e.jsx)("p",{children:t.texts[1].value}),(0,e.jsxs)("p",{children:[t.texts[2].value,(0,e.jsx)("a",{href:"https://github.com/nocobase/plugin-samples/tree/main/packages/plugins/%40nocobase-sample/plugin-replace-page",children:t.texts[3].value}),t.texts[4].value]}),(0,e.jsx)("p",{children:(0,e.jsx)("img",{src:"https://static-docs.nocobase.com/20240512200917.png",alt:"20240512200917"})}),(0,e.jsxs)("h2",{id:"initialize-the-plugin",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#initialize-the-plugin",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Initialize the Plugin"]}),(0,e.jsxs)("p",{children:[t.texts[5].value,(0,e.jsx)(d.rU,{to:"/development/your-fisrt-plugin",children:t.texts[6].value}),t.texts[7].value]}),(0,e.jsx)(n.Z,{lang:"bash",children:t.texts[8].value}),(0,e.jsx)("p",{children:t.texts[9].value}),(0,e.jsx)(n.Z,{lang:"bash",children:t.texts[10].value}),(0,e.jsx)("p",{children:t.texts[11].value}),(0,e.jsx)(n.Z,{lang:"bash",children:t.texts[12].value}),(0,e.jsxs)("p",{children:[t.texts[13].value,(0,e.jsx)("a",{href:"http://localhost:13000/admin/pm/list/local/",children:t.texts[14].value}),t.texts[15].value]}),(0,e.jsxs)("h2",{id:"function-implementation",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#function-implementation",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Function Implementation"]}),(0,e.jsxs)("h3",{id:"1-analyzing-requirements-and-source-code",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#1-analyzing-requirements-and-source-code",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"1. Analyzing Requirements and Source Code"]}),(0,e.jsxs)("p",{children:[t.texts[16].value,(0,e.jsx)(d.rU,{to:"/handbook/auth/dev/api#route",children:t.texts[17].value}),t.texts[18].value]}),(0,e.jsxs)("ul",{children:[(0,e.jsxs)("li",{children:[(0,e.jsx)("p",{children:t.texts[19].value}),(0,e.jsxs)("ul",{children:[(0,e.jsxs)("li",{children:[t.texts[20].value,(0,e.jsx)("code",{children:t.texts[21].value})]}),(0,e.jsxs)("li",{children:[t.texts[22].value,(0,e.jsx)("code",{children:t.texts[23].value})]}),(0,e.jsxs)("li",{children:[t.texts[24].value,(0,e.jsx)("code",{children:t.texts[25].value})]})]})]}),(0,e.jsxs)("li",{children:[(0,e.jsx)("p",{children:t.texts[26].value}),(0,e.jsxs)("ul",{children:[(0,e.jsxs)("li",{children:[t.texts[27].value,(0,e.jsx)("code",{children:t.texts[28].value})]}),(0,e.jsxs)("li",{children:[t.texts[29].value,(0,e.jsx)("code",{children:t.texts[30].value})]}),(0,e.jsxs)("li",{children:[t.texts[31].value,(0,e.jsx)("code",{children:t.texts[32].value})]})]})]}),(0,e.jsxs)("li",{children:[(0,e.jsx)("p",{children:t.texts[33].value}),(0,e.jsxs)("ul",{children:[(0,e.jsxs)("li",{children:[t.texts[34].value,(0,e.jsx)("code",{children:t.texts[35].value})]}),(0,e.jsxs)("li",{children:[t.texts[36].value,(0,e.jsx)("code",{children:t.texts[37].value})]}),(0,e.jsxs)("li",{children:[t.texts[38].value,(0,e.jsx)("code",{children:t.texts[39].value})]})]})]})]}),(0,e.jsxs)("p",{children:[t.texts[40].value,(0,e.jsx)("code",{children:t.texts[41].value}),t.texts[42].value,(0,e.jsx)("code",{children:t.texts[43].value}),t.texts[44].value]}),(0,e.jsxs)("p",{children:[t.texts[45].value,(0,e.jsx)("a",{href:"https://github.com/nocobase/nocobase/blob/main/packages/plugins/%40nocobase/plugin-auth/src/client/pages/AuthLayout.tsx",children:t.texts[46].value}),t.texts[47].value]}),(0,e.jsx)(n.Z,{lang:"tsx",children:t.texts[48].value}),(0,e.jsxs)("p",{children:[t.texts[49].value,(0,e.jsx)("code",{children:t.texts[50].value}),t.texts[51].value,(0,e.jsx)("code",{children:t.texts[52].value}),t.texts[53].value]}),(0,e.jsxs)("h3",{id:"2-implementing-custom-authlayout-component",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#2-implementing-custom-authlayout-component",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"2. Implementing Custom AuthLayout Component"]}),(0,e.jsxs)("p",{children:[t.texts[54].value,(0,e.jsx)("code",{children:t.texts[55].value}),t.texts[56].value]}),(0,e.jsx)(n.Z,{lang:"tsx",children:t.texts[57].value}),(0,e.jsxs)("p",{children:[t.texts[58].value,(0,e.jsx)("a",{href:"https://github.com/nocobase/plugin-samples/tree/main/packages/plugins/%40nocobase-sample/plugin-replace-page/src/client/auth-image.jpg",children:t.texts[59].value}),t.texts[60].value,(0,e.jsx)("code",{children:t.texts[61].value}),t.texts[62].value]}),(0,e.jsx)("p",{children:t.texts[63].value}),(0,e.jsxs)("h3",{id:"3-replacing-authlayout-with-customauthlayout",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#3-replacing-authlayout-with-customauthlayout",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"3. Replacing ",(0,e.jsx)("code",{children:t.texts[64].value})," with ",(0,e.jsx)("code",{children:t.texts[65].value})]}),(0,e.jsxs)("p",{children:[t.texts[66].value,(0,e.jsx)("code",{children:t.texts[67].value}),t.texts[68].value,(0,e.jsx)("code",{children:t.texts[69].value}),t.texts[70].value]}),(0,e.jsxs)("p",{children:[t.texts[71].value,(0,e.jsx)("code",{children:t.texts[72].value}),t.texts[73].value]}),(0,e.jsxs)("h4",{id:"route-override",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#route-override",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Route Override"]}),(0,e.jsxs)("p",{children:[t.texts[74].value,(0,e.jsx)("code",{children:t.texts[75].value}),t.texts[76].value,(0,e.jsx)("code",{children:t.texts[77].value}),t.texts[78].value]}),(0,e.jsx)(n.Z,{lang:"ts",children:t.texts[79].value}),(0,e.jsxs)("p",{children:[t.texts[80].value,(0,e.jsx)("code",{children:t.texts[81].value}),t.texts[82].value]}),(0,e.jsxs)("h4",{id:"component-override-method",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#component-override-method",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Component Override Method"]}),(0,e.jsx)(n.Z,{lang:"ts",children:t.texts[83].value}),(0,e.jsxs)("p",{children:[t.texts[84].value,(0,e.jsx)("em",{children:t.texts[85].value}),t.texts[86].value,(0,e.jsx)("a",{href:"https://github.com/nocobase/nocobase/blob/cff530acac45cc615291c344b4a26c7bc7f410dc/packages/plugins/%40nocobase/plugin-auth/src/client/index.tsx#L47",children:t.texts[87].value}),t.texts[88].value]}),(0,e.jsx)(n.Z,{lang:"ts",children:t.texts[89].value}),(0,e.jsxs)("p",{children:[t.texts[90].value,(0,e.jsx)("code",{children:t.texts[91].value}),t.texts[92].value]}),(0,e.jsx)(n.Z,{lang:"ts",children:t.texts[93].value}),(0,e.jsxs)("p",{children:[t.texts[94].value,(0,e.jsx)("a",{href:"http://localhost:13000/signin",children:t.texts[95].value}),t.texts[96].value]}),(0,e.jsx)("p",{children:(0,e.jsx)("img",{src:"https://static-docs.nocobase.com/20240512200917.png",alt:"20240512200917"})}),(0,e.jsxs)("h2",{id:"packaging-and-uploading-to-production-environment",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#packaging-and-uploading-to-production-environment",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Packaging and Uploading to Production Environment"]}),(0,e.jsxs)("p",{children:[t.texts[97].value,(0,e.jsx)(d.rU,{to:"/development/your-fisrt-plugin#building-and-packaging-plugins",children:t.texts[98].value}),t.texts[99].value]}),(0,e.jsx)("p",{children:t.texts[100].value}),(0,e.jsx)(n.Z,{lang:"bash",children:t.texts[101].value}),(0,e.jsxs)("p",{children:[t.texts[102].value,(0,e.jsx)("code",{children:t.texts[103].value}),t.texts[104].value]}),(0,e.jsx)(n.Z,{lang:"bash",children:t.texts[105].value}),(0,e.jsxs)("p",{children:[t.texts[106].value,(0,e.jsx)("code",{children:t.texts[107].value}),t.texts[108].value,(0,e.jsx)(d.rU,{to:"/welcome/getting-started/plugin",children:t.texts[109].value}),t.texts[110].value]})]})})})})}o.default=u},848292:function(l,o,a){a.r(o),a.d(o,{texts:function(){return s}});const s=[{value:"Scene where the layout of an existing page needs to be changed or the entire content of the page needs to be replaced.",paraId:0,tocIndex:1},{value:"We need to customize the layout of the login and registration pages. Currently, there is only a form, but we want to change it to a left-right layout, with an image on the left and the form on the right.",paraId:1,tocIndex:2},{value:"You can find the complete example code for this documentation in the ",paraId:2,tocIndex:2},{value:"plugin-samples",paraId:2,tocIndex:2},{value:" repository.",paraId:2,tocIndex:2},{value:"Following the instructions in the ",paraId:3,tocIndex:3},{value:"Writing Your First Plugin",paraId:4,tocIndex:3},{value:" documentation, if you don't have a project yet, you can create one. If you already have one or have cloned the source code, you can skip this step.",paraId:3,tocIndex:3},{value:`yarn create nocobase-app my-nocobase-app -d postgres
cd my-nocobase-app
yarn install
yarn nocobase install
`,paraId:5,tocIndex:3},{value:"Then initialize a plugin and add it to the application:",paraId:6,tocIndex:3},{value:`yarn pm create @nocobase-sample/plugin-replace-page
yarn pm enable @nocobase-sample/plugin-replace-page
`,paraId:7,tocIndex:3},{value:"Then start the project:",paraId:8,tocIndex:3},{value:`yarn dev
`,paraId:9,tocIndex:3},{value:"Then, after logging in, visit ",paraId:10,tocIndex:3},{value:"http://localhost:13000/admin/pm/list/local/",paraId:10,tocIndex:3},{value:" to see that the plugin has been installed and enabled.",paraId:10,tocIndex:3},{value:"The login and registration pages are registered by the ",paraId:11,tocIndex:5},{value:"Auth plugin",paraId:12,tocIndex:5},{value:", which registers the following routes:",paraId:11,tocIndex:5},{value:"Auth layout",paraId:13,tocIndex:5},{value:"name: ",paraId:14,tocIndex:5},{value:"auth",paraId:14,tocIndex:5},{value:"path: ",paraId:14,tocIndex:5},{value:"-",paraId:14,tocIndex:5},{value:"component: ",paraId:14,tocIndex:5},{value:"AuthLayout",paraId:14,tocIndex:5},{value:"Sign-in page",paraId:15,tocIndex:5},{value:"name: ",paraId:16,tocIndex:5},{value:"auth.signin",paraId:16,tocIndex:5},{value:"path: ",paraId:16,tocIndex:5},{value:"/signin",paraId:16,tocIndex:5},{value:"component: ",paraId:16,tocIndex:5},{value:"SignInPage",paraId:16,tocIndex:5},{value:"Sign-up page",paraId:17,tocIndex:5},{value:"name: ",paraId:18,tocIndex:5},{value:"auth.signup",paraId:18,tocIndex:5},{value:"path: ",paraId:18,tocIndex:5},{value:"/signup",paraId:18,tocIndex:5},{value:"component: ",paraId:18,tocIndex:5},{value:"SignUpPage",paraId:18,tocIndex:5},{value:"The ",paraId:19,tocIndex:5},{value:"AuthLayout",paraId:19,tocIndex:5},{value:" is the layout for the entire login and registration pages. We can achieve custom layout by replacing the ",paraId:19,tocIndex:5},{value:"AuthLayout",paraId:19,tocIndex:5},{value:".",paraId:19,tocIndex:5},{value:"To understand how to implement this, we need to refer to the source code of the original ",paraId:20,tocIndex:5},{value:"AuthLayout",paraId:20,tocIndex:5},{value:".",paraId:20,tocIndex:5},{value:`export function AuthLayout() {
  const { data } = useSystemSettings();

  return (
    <div
      style={{
        maxWidth: 320,
        margin: '0 auto',
        paddingTop: '20vh',
      }}
    >
      <h1>{data?.data?.title}</h1>
      <AuthenticatorsContextProvider>
        <Outlet />
      </AuthenticatorsContextProvider>
      <div
        className={css\`
          position: absolute;
          bottom: 24px;
          width: 100%;
          left: 0;
          text-align: center;
        \`}
      >
        <PoweredBy />
      </div>
    </div>
  );
}
`,paraId:21,tocIndex:5},{value:"The overall source code is relatively simple. What we need to implement is a layout with a left and right side. The left side will contain an image, and the right side will contain the login and registration forms. We can either copy the existing ",paraId:22,tocIndex:5},{value:"AuthLayout",paraId:22,tocIndex:5},{value:" and place it on the right side, or directly import the original ",paraId:22,tocIndex:5},{value:"AuthLayout",paraId:22,tocIndex:5},{value:" and place an image on the left side.",paraId:22,tocIndex:5},{value:"We create ",paraId:23,tocIndex:6},{value:"packages/plugins/@nocobase-sample/plugin-replace-page/src/client/AuthLayout.tsx",paraId:23,tocIndex:6},{value:" with the following content:",paraId:23,tocIndex:6},{value:`import React from 'react';
import { Col, Row } from 'antd';
import { Outlet } from 'react-router-dom';
import { PoweredBy, css, useSystemSettings } from '@nocobase/client';
import { AuthenticatorsContextProvider } from '@nocobase/plugin-auth/client'

import authImg from './auth-image.jpg'

export function CustomAuthLayout() {
  const { data } = useSystemSettings();

  return <Row style={{ height: '100%' }}>
    <Col xs={{ span: 0 }} md={{ span: 12 }}>
      <img src={authImg} style={{
        objectFit: 'cover',
        objectPosition: 'center',
        width: '100%',
        height: '100%',
        maxWidth: '100%',
        display: 'block',
        verticalAlign: 'middle'
      }} />
    </Col>
    <Col xs={{ span: 24 }} md={{ span: 12 }}>
      <div
        style={{
          maxWidth: 320,
          margin: '0 auto',
          paddingTop: '20vh',
        }}
      >
        <h1>{data?.data?.title}</h1>
        <AuthenticatorsContextProvider>
          <Outlet />
        </AuthenticatorsContextProvider>
        <div
          className={css\`
          position: absolute;
          bottom: 24px;
          width: 100%;
          left: 0;
          text-align: center;
        \`}
        >
          <PoweredBy />
        </div>
      </div>
    </Col>
  </Row>
}
`,paraId:24,tocIndex:6},{value:"Then place the left background image ",paraId:25,tocIndex:6},{value:"auth-image.jpg",paraId:25,tocIndex:6},{value:" in the ",paraId:25,tocIndex:6},{value:"packages/plugins/@nocobase-sample/plugin-replace-page/src/client",paraId:25,tocIndex:6},{value:" directory.",paraId:25,tocIndex:6},{value:"This completes the implementation of a login page with a left and right layout.",paraId:26,tocIndex:6},{value:"AuthLayout",paraId:27},{value:"CustomAuthLayout",paraId:27},{value:"Next, we need to import and use ",paraId:28,tocIndex:7},{value:"CustomAuthLayout",paraId:28,tocIndex:7},{value:" in ",paraId:28,tocIndex:7},{value:"packages/plugins/@nocobase-sample/plugin-replace-page/src/client/index.tsx",paraId:28,tocIndex:7},{value:".",paraId:28,tocIndex:7},{value:"There are two ways to replace ",paraId:29,tocIndex:7},{value:"AuthLayout",paraId:29,tocIndex:7},{value:": through route override and component override.",paraId:29,tocIndex:7},{value:"As mentioned earlier, the route name for ",paraId:30,tocIndex:8},{value:"AuthLayout",paraId:30,tocIndex:8},{value:" is ",paraId:30,tocIndex:8},{value:"auth",paraId:30,tocIndex:8},{value:". We can override it using routes:",paraId:30,tocIndex:8},{value:`import { Plugin } from '@nocobase/client';
import { CustomAuthLayout } from './AuthLayout';

export class PluginReplacePageClient extends Plugin {
  async load() {
    this.app.router.add('auth', {
      Component: CustomAuthLayout,
    })
  }
}

export default PluginReplacePageClient;
`,paraId:31,tocIndex:8},{value:"The first parameter of the ",paraId:32,tocIndex:8},{value:"router.add()",paraId:32,tocIndex:8},{value:" method is the name of the route. If it is added repeatedly, it will override the existing route.",paraId:32,tocIndex:8},{value:`import { Plugin } from '@nocobase/client';
import { CustomAuthLayout } from './AuthLayout';

export class PluginChangePageClient extends Plugin {
  async load() {
   this.app.addComponents({ AuthLayout: CustomAuthLayout })
  }
}
`,paraId:33,tocIndex:9},{value:"It should be noted that this method of overriding must be done using ",paraId:34,tocIndex:9},{value:"string Component",paraId:34,tocIndex:9},{value:" to register the route. For example, the source code of the ",paraId:34,tocIndex:9},{value:"auth plugin",paraId:34,tocIndex:9},{value:" is as follows:",paraId:34,tocIndex:9},{value:`this.app.router.add('auth', {
  Component: 'AuthLayout',
})

this.app.addComponents({ AuthLayout })
`,paraId:35,tocIndex:9},{value:"If the source code of the ",paraId:36,tocIndex:9},{value:"auth",paraId:36,tocIndex:9},{value:" plugin is registered in the following way, it cannot be overridden:",paraId:36,tocIndex:9},{value:`this.app.router.add('auth', {
  Component: AuthLayout,
})
`,paraId:37,tocIndex:9},{value:"Then we log out and visit ",paraId:38,tocIndex:9},{value:"http://localhost:13000/signin",paraId:38,tocIndex:9},{value:" to see that the layout of the login page has been changed.",paraId:38,tocIndex:9},{value:"According to the documentation on ",paraId:39,tocIndex:10},{value:"Building and Packaging Plugins",paraId:40,tocIndex:10},{value:", we can package the plugin and upload it to the production environment.",paraId:39,tocIndex:10},{value:"If you have cloned the source code, you need to perform a full build first to build the dependencies of the plugin as well.",paraId:41,tocIndex:10},{value:`yarn build
`,paraId:42,tocIndex:10},{value:"If you are using ",paraId:43,tocIndex:10},{value:"create-nocobase-app",paraId:43,tocIndex:10},{value:" to create your project, you can directly execute:",paraId:43,tocIndex:10},{value:`yarn build @nocobase-sample/plugin-replace-page --tar
`,paraId:44,tocIndex:10},{value:"This way, you can see the ",paraId:45,tocIndex:10},{value:"storage/tar/@nocobase-sample/plugin-replace-page.tar.gz",paraId:45,tocIndex:10},{value:" file, and then install it using the ",paraId:45,tocIndex:10},{value:"upload method",paraId:46,tocIndex:10},{value:".",paraId:45,tocIndex:10}]}}]);
