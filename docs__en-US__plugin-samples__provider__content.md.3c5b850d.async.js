"use strict";(self.webpackChunknocobase_docs=self.webpackChunknocobase_docs||[]).push([[74816],{174810:function(l,o,t){t.r(o);var s=t(572269),u=t(793359),_=t(861788),x=t(719977),p=t(20190),a=t(24268),h=t(496057),m=t(585939),v=t(28484),I=t(635206),g=t(375553),j=t(156266),f=t(572333),E=t(841118),P=t(39297),b=t(868526),y=t(605019),d=t(614651),i=t(280936),r=t(667294),n=t(739176),e=t(785893);function c(){return(0,e.jsx)(d.dY,{children:(0,e.jsx)(r.Suspense,{fallback:(0,e.jsx)(i.Z,{}),children:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"markdown",children:[(0,e.jsxs)("h1",{id:"global-content-display",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#global-content-display",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Global Content Display"]}),(0,e.jsxs)("p",{children:[n.texts[0].value,(0,e.jsx)("code",{children:n.texts[1].value}),n.texts[2].value]}),(0,e.jsxs)("h2",{id:"example-description",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#example-description",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Example Description"]}),(0,e.jsx)("p",{children:n.texts[3].value}),(0,e.jsxs)("p",{children:[n.texts[4].value,(0,e.jsx)("a",{href:"https://github.com/nocobase/plugin-samples/tree/main/packages/plugins/%40nocobase-sample/plugin-provider-content",children:n.texts[5].value}),n.texts[6].value]}),(0,e.jsx)("p",{children:(0,e.jsx)("img",{src:"https://static-docs.nocobase.com/img_v3_02av_cd3c7f37-0c5b-4c9c-b10e-e413af409ccg.jpg",alt:"img_v3_02av_cd3c7f37-0c5b-4c9c-b10e-e413af409ccg"})}),(0,e.jsxs)("h2",{id:"initializing-the-plugin",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#initializing-the-plugin",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Initializing the Plugin"]}),(0,e.jsxs)("p",{children:[n.texts[7].value,(0,e.jsx)(d.rU,{to:"/development/your-fisrt-plugin",children:n.texts[8].value}),n.texts[9].value]}),(0,e.jsx)(a.Z,{lang:"bash",children:n.texts[10].value}),(0,e.jsx)("p",{children:n.texts[11].value}),(0,e.jsx)(a.Z,{lang:"bash",children:n.texts[12].value}),(0,e.jsx)("p",{children:n.texts[13].value}),(0,e.jsx)(a.Z,{lang:"bash",children:n.texts[14].value}),(0,e.jsxs)("p",{children:[n.texts[15].value,(0,e.jsx)("a",{href:"http://localhost:13000/admin/pm/list/local/",children:n.texts[16].value}),n.texts[17].value]}),(0,e.jsxs)("h2",{id:"feature-implementation",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#feature-implementation",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Feature Implementation"]}),(0,e.jsxs)("h3",{id:"1-adding-the-provider-component",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#1-adding-the-provider-component",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"1. Adding the ",(0,e.jsx)("code",{children:n.texts[18].value})," Component"]}),(0,e.jsxs)("p",{children:[n.texts[19].value,(0,e.jsx)("code",{children:n.texts[20].value}),n.texts[21].value,(0,e.jsx)("code",{children:n.texts[22].value}),n.texts[23].value]}),(0,e.jsxs)("p",{children:[n.texts[24].value,(0,e.jsx)("code",{children:n.texts[25].value}),n.texts[26].value]}),(0,e.jsx)(a.Z,{lang:"tsx",children:n.texts[27].value}),(0,e.jsxs)("p",{children:[n.texts[28].value,(0,e.jsx)(d.rU,{to:"/plugin-samples/plugin-settings/form",children:n.texts[29].value}),n.texts[30].value]}),(0,e.jsxs)("p",{children:[n.texts[31].value,(0,e.jsx)("code",{children:n.texts[32].value}),n.texts[33].value]}),(0,e.jsxs)("h3",{id:"2-registering-it-in-the-system",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#2-registering-it-in-the-system",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"2. Registering It in the System"]}),(0,e.jsxs)("p",{children:[n.texts[34].value,(0,e.jsx)("code",{children:n.texts[35].value}),n.texts[36].value,(0,e.jsx)("code",{children:n.texts[37].value}),n.texts[38].value]}),(0,e.jsx)(a.Z,{lang:"tsx",children:n.texts[39].value}),(0,e.jsxs)("p",{children:[n.texts[40].value,(0,e.jsx)("a",{href:"http://localhost:13000",children:n.texts[41].value}),n.texts[42].value]}),(0,e.jsx)("p",{children:(0,e.jsx)("img",{src:"https://static-docs.nocobase.com/img_v3_02av_cd3c7f37-0c5b-4c9c-b10e-e413af409ccg.jpg",alt:"img_v3_02av_cd3c7f37-0c5b-4c9c-b10e-e413af409ccg"})}),(0,e.jsxs)("h2",{id:"packaging-and-deploying-to-production",children:[(0,e.jsx)("a",{"aria-hidden":"true",tabIndex:"-1",href:"#packaging-and-deploying-to-production",children:(0,e.jsx)("span",{className:"icon icon-link"})}),"Packaging and Deploying to Production"]}),(0,e.jsxs)("p",{children:[n.texts[43].value,(0,e.jsx)(d.rU,{to:"/development/your-fisrt-plugin#%E6%9E%84%E5%BB%BA%E5%B9%B6%E6%89%93%E5%8C%85%E6%8F%92%E4%BB%B6",children:n.texts[44].value}),n.texts[45].value]}),(0,e.jsx)("p",{children:n.texts[46].value}),(0,e.jsx)(a.Z,{lang:"bash",children:n.texts[47].value}),(0,e.jsxs)("p",{children:[n.texts[48].value,(0,e.jsx)("code",{children:n.texts[49].value}),n.texts[50].value]}),(0,e.jsx)(a.Z,{lang:"bash",children:n.texts[51].value}),(0,e.jsxs)("p",{children:[n.texts[52].value,(0,e.jsx)("code",{children:n.texts[53].value}),n.texts[54].value,(0,e.jsx)(d.rU,{to:"/welcome/getting-started/plugin",children:n.texts[55].value}),n.texts[56].value]})]})})})})}o.default=c},739176:function(l,o,t){t.r(o),t.d(o,{texts:function(){return s}});const s=[{value:"We can display global content using the ",paraId:0,tocIndex:0},{value:"Provider",paraId:0,tocIndex:0},{value:" component.",paraId:0,tocIndex:0},{value:"We want to implement an announcement feature. If the backend returns announcement information, it will be displayed at the top of the page.",paraId:1,tocIndex:1},{value:"You can view the complete example code in the ",paraId:2,tocIndex:1},{value:"plugin-samples",paraId:2,tocIndex:1},{value:" repository.",paraId:2,tocIndex:1},{value:"Follow the instructions in the ",paraId:3,tocIndex:2},{value:"Writing Your First Plugin",paraId:4,tocIndex:2},{value:" guide. If you don't already have a project, you can create one. If you already have a project or have cloned the source code, you can skip this step.",paraId:3,tocIndex:2},{value:`yarn create nocobase-app my-nocobase-app -d postgres
cd my-nocobase-app
yarn install
yarn nocobase install
`,paraId:5,tocIndex:2},{value:"Next, initialize a plugin and add it to the system:",paraId:6,tocIndex:2},{value:`yarn pm create @nocobase-sample/plugin-provider-content
yarn pm enable @nocobase-sample/plugin-provider-content
`,paraId:7,tocIndex:2},{value:"Now, start the project:",paraId:8,tocIndex:2},{value:`yarn dev
`,paraId:9,tocIndex:2},{value:"After logging in, visit ",paraId:10,tocIndex:2},{value:"http://localhost:13000/admin/pm/list/local/",paraId:10,tocIndex:2},{value:" to verify that the plugin has been installed and enabled.",paraId:10,tocIndex:2},{value:"Provider",paraId:11},{value:"The ",paraId:12,tocIndex:4},{value:"Provider",paraId:12,tocIndex:4},{value:" component is a regular React component, but it is important to remember to render the ",paraId:12,tocIndex:4},{value:"children",paraId:12,tocIndex:4},{value:" as part of it.",paraId:12,tocIndex:4},{value:"Create a new file at ",paraId:13,tocIndex:4},{value:"packages/plugins/@nocobase-sample/plugin-provider-content/src/client/TopAnnouncement.tsx",paraId:13,tocIndex:4},{value:":",paraId:13,tocIndex:4},{value:`import React, { FC, ReactNode } from 'react';
import { Alert, Affix, AlertProps } from 'antd';
import { useRequest } from '@nocobase/client';

const mockRequest = () => new Promise((resolve) => {
  Math.random() > 0.5 ?
    resolve({ data: { message: 'This is an important message.', type: 'info' } }) :
    resolve({ data: undefined })
})

export const TopAnnouncement: FC<{ children: ReactNode }> = ({ children }) => {
  const { data, loading } = useRequest<{ data: { message: string; type: AlertProps['type'] } }>(mockRequest)

  const onClose = () => {
    console.log('onClose')
  }

  return (
    <>
      {
        !loading && !!data.data && <Affix offsetTop={0} style={{ zIndex: 1010 }}>
          <Alert
            message={data.data.message}
            type={data.data.type}
            style={{ borderRadius: 0, borderLeft: 'none', borderRight: 'none' }}
            closable
            onClose={onClose}
          />
        </Affix>
      }
      {children}
    </>
  );
};
`,paraId:14,tocIndex:4},{value:"For the announcement configuration and data, you can refer to the ",paraId:15,tocIndex:4},{value:"Plugin Form Configuration Page",paraId:16,tocIndex:4},{value:". In this example, mock data is used.",paraId:15,tocIndex:4},{value:"Remember to render ",paraId:17,tocIndex:4},{value:"children",paraId:17,tocIndex:4},{value:" within the component.",paraId:17,tocIndex:4},{value:"Modify the ",paraId:18,tocIndex:5},{value:"packages/plugins/@nocobase-sample/plugin-provider-content/src/index.ts",paraId:18,tocIndex:5},{value:" file to register the ",paraId:18,tocIndex:5},{value:"TopAnnouncement",paraId:18,tocIndex:5},{value:" component within the system.",paraId:18,tocIndex:5},{value:`import { Plugin } from '@nocobase/client';
import { TopAnnouncement } from './TopAnnouncement';

export class PluginProviderContentClient extends Plugin {
  async load() {
    this.app.addProvider(TopAnnouncement)
  }
}

export default PluginProviderContentClient;
`,paraId:19,tocIndex:5},{value:"Now, visit ",paraId:20,tocIndex:5},{value:"http://localhost:13000",paraId:20,tocIndex:5},{value:", and you will see the announcement displayed at the top of the page.",paraId:20,tocIndex:5},{value:"Follow the instructions in the ",paraId:21,tocIndex:6},{value:"Build and Package Plugin",paraId:22,tocIndex:6},{value:" document to package the plugin and upload it to the production environment.",paraId:21,tocIndex:6},{value:"If you cloned the source code, run a full build first to package the plugin\u2019s dependencies as well:",paraId:23,tocIndex:6},{value:`yarn build
`,paraId:24,tocIndex:6},{value:"If you used ",paraId:25,tocIndex:6},{value:"create-nocobase-app",paraId:25,tocIndex:6},{value:" to create the project, you can directly run:",paraId:25,tocIndex:6},{value:`yarn build @nocobase-sample/plugin-provider-content --tar
`,paraId:26,tocIndex:6},{value:"You will now see the ",paraId:27,tocIndex:6},{value:"storage/tar/@nocobase-sample/plugin-provider-content.tar.gz",paraId:27,tocIndex:6},{value:" file. You can then install it by ",paraId:27,tocIndex:6},{value:"uploading it",paraId:28,tocIndex:6},{value:`.
]()`,paraId:27,tocIndex:6}]}}]);
